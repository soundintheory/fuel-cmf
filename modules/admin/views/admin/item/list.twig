{% extends "admin/shared/interface.twig" %}

{% block html_title %}{{ plural }} List : {{ admin_title }}{% endblock %}

{% block main_pane %}
    
    {% include 'admin/shared/alert.twig' %}
    
    <div class="inner">
        
        <h2 class="main-heading"><i class="icon-{{ icon }}"></i> {{ plural }} ({{ rows|length }})</h2>
        <div class="actions-top-right">
            {% if can_manage %}
            <a href="/admin/{{ table_name }}/permissions" class="btn btn-medium btn-inverse btn-permissions" title="Edit {{ singular|lower }} permissions"><i class="icon icon-lock"></i></a>
            {% endif %}
        </div>
        <div class="clear"></div>

    	<div class="item-list">

            <div class="row-fluid">
        
                <table class="table table-striped table-bordered selectable fixed-head table-hover{{ sortable ? ' sortable' : '' }}">
                    
                    <thead>
                        <tr>
                            {% for column in columns %}
                            {% if column.type == 'handle' %}
                            <th class="handle"></th>
                            {% else %}
                            <th class="col-type-{{ column.type }}">{{ column.heading|default('-') }}</th>
                            {% endif %}
                            {% endfor %}
                            <th class="actions"></th>
                        </tr>
                    </thead>
                    
                    <tbody>
                        {% for row in rows if row.id not in excluded_ids %}
                        <tr data-id="{{ row.id }}"{% if sortable %} data-sort-group="{{ row.sortGroupId() }}"{% endif %}>
                            {% set editable = can_edit and (item_permissions[row.id]|length == 0 or 'edit' in item_permissions[row.id]) %}
                            {% set deletable = can_delete and (item_permissions[row.id]|length == 0 or 'delete' in item_permissions[row.id]) %}
                            {% set edit_link = "/admin/"~table_name~"/"~row.get('id')~"/edit" %}
                            {% for column in columns %}
                                {% if column.type == 'handle' %}
                                <td class="handle"><i class="icon-move"></i></td>
                                {% elseif column.type == 'method' %}
                                <td class="col-type-{{ column.type }}"><a href="{{ editable ? edit_link : '' }}">{{ row.get(column.name) }}</a></td>
                                {% else %}
                                <td class="col-type-{{ column.type }}">{{ field_list_value(row.get(column.name), editable ? edit_link : false, fields[column.name], row)|default('(empty)') }}</td>
                                {% endif %}
                            {% endfor %}
                            <td class="actions"><span>
                                {% if editable %}<a class="btn btn-small" href="{{ edit_link }}" rel="tooltip" title="Edit"><i class="icon-pencil"></i></a>{% endif %} 
                                {% if deletable %}<a class="btn btn-small btn-danger btn-remove" href="/admin/{{ table_name }}/{{ row.get('id') }}/delete" rel="tooltip" title="Delete" data-singular="{{ singular }}"><i class="icon-remove icon-white"></i></a>{% endif %}
                            </span></td>
                            
                        </tr>
                        {% else %}
                        <tr>
                            <td class="no-items" colspan="{{ columns|length + 1 }}">
                                
                                <p>There are no {{ plural|lower }} added yet.</p>
                                {% if can_create %}
                                <a href="/admin/{{ table_name }}/create" class="btn btn-medium"><i class="icon-plus icon-white"></i> Add {{ singular }}...</a>
                                {% endif %}
                            
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
        
            </div> <!-- .row-fluid -->
        
        </div> <!-- .item-list -->
        
    </div> <!-- .inner -->
    
{% endblock %}

{% block bottom %}
    
    <div id="controls-fixed-bot"><div class="inner">
        
        <div class="status pull-left">
            <!-- span>Page rendered in {exec_time}s using {mem_usage}mb of memory.</span -->
        </div>
        

        <!-- div class="pagination pull-left">
            <ul>
                <li class="disabled"><a href="#">&laquo;</a></li>
                <li class="active"><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">&raquo;</a></li>
            </ul>
            <ul>
                <li><a href="#"><i class="icon-list"></i> View all</a></li>
            </ul>
            <div class="clear"></div>
        </div -->
        
        {% if user.super_user %}
            <a href="/admin/{{ table_name }}/saveall" class="btn btn-large btn-info">Save All</a>
        {% endif %}
        
        {% if can_create %}
        <div class="actions pull-right">
            <a href="/admin/{{ table_name }}/create" class="btn btn-large btn-primary"><i class="icon-plus icon-white"></i> Add New {{ singular }}...</a>
        </div>
        {% endif %}
        
        <div class="clear"></div>

    </div></div>
    
{% endblock %}

{% block breadcrumb %}

<li><a href="/admin">Dashboard</a> <span class="divider">/</span></li>
<li class="active">{{ plural }}</li>

{% endblock %}
