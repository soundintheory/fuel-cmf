(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{this.CodeMirror=a()}}})(function(){var ce=/gecko\/\d/i.test(navigator.userAgent);var eo=/MSIE \d/.test(navigator.userAgent);var b1=eo&&(document.documentMode==null||document.documentMode<8);var bY=eo&&(document.documentMode==null||document.documentMode<9);var bX=eo&&(document.documentMode==null||document.documentMode<10);var by=/Trident\/([7-9]|\d{2,})\./.test(navigator.userAgent);var dn=eo||by;var cJ=/WebKit\//.test(navigator.userAgent);var dr=cJ&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var cV=/Chrome\//.test(navigator.userAgent);var dF=/Opera\//.test(navigator.userAgent);var ay=/Apple Computer/.test(navigator.vendor);var a1=/KHTML\//.test(navigator.userAgent);var cP=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var e5=/PhantomJS/.test(navigator.userAgent);var eD=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var dS=eD||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var bU=eD||/Mac/.test(navigator.platform);var aG=/win/i.test(navigator.platform);var aO=dF&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(aO){aO=Number(aO[1])}if(aO&&aO>=15){dF=false;cJ=true}var bF=bU&&(dr||dF&&(aO==null||aO<12.11));var fF=ce||(dn&&!bY);var fI=false,aX=false;function I(fP,fQ){if(!(this instanceof I)){return new I(fP,fQ)}this.options=fQ=fQ||{};aE(eF,fQ,false);b4(fQ);var fS=fQ.value;if(typeof fS=="string"){fS=new ao(fS,fQ.mode)}this.doc=fS;var fR=this.display=new em(fP,fS);fR.wrapper.CodeMirror=this;dO(this);cB(this);if(fQ.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(fQ.autofocus&&!dS){ed(this)}this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,draggingText:false,highlight:new fN()};if(eo){setTimeout(cl(eZ,this,true),20)}fq(this);a8();var fO=this;cz(this,function(){fO.curOp.forceUpdate=true;dN(fO,fS);if((fQ.autofocus&&!dS)||ds()==fR.input){setTimeout(cl(cq,fO),20)}else{aL(fO)}for(var fU in a4){if(a4.hasOwnProperty(fU)){a4[fU](fO,fQ[fU],b2)}}for(var fT=0;fT<aY.length;++fT){aY[fT](fO)}})}function em(fO,fQ){var fR=this;var fP=fR.input=fx("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");if(cJ){fP.style.width="1000px"}else{fP.setAttribute("wrap","off")}if(eD){fP.style.border="1px solid black"}fP.setAttribute("autocorrect","off");fP.setAttribute("autocapitalize","off");fP.setAttribute("spellcheck","false");fR.inputDiv=fx("div",[fP],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");fR.scrollbarH=fx("div",[fx("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");fR.scrollbarV=fx("div",[fx("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");fR.scrollbarFiller=fx("div",null,"CodeMirror-scrollbar-filler");fR.gutterFiller=fx("div",null,"CodeMirror-gutter-filler");fR.lineDiv=fx("div",null,"CodeMirror-code");fR.selectionDiv=fx("div",null,null,"position: relative; z-index: 1");fR.cursorDiv=fx("div",null,"CodeMirror-cursors");fR.measure=fx("div",null,"CodeMirror-measure");fR.lineMeasure=fx("div",null,"CodeMirror-measure");fR.lineSpace=fx("div",[fR.measure,fR.lineMeasure,fR.selectionDiv,fR.cursorDiv,fR.lineDiv],null,"position: relative; outline: none");fR.mover=fx("div",[fx("div",[fR.lineSpace],"CodeMirror-lines")],null,"position: relative");fR.sizer=fx("div",[fR.mover],"CodeMirror-sizer");fR.heightForcer=fx("div",null,null,"position: absolute; height: "+ba+"px; width: 1px;");fR.gutters=fx("div",null,"CodeMirror-gutters");fR.lineGutter=null;fR.scroller=fx("div",[fR.sizer,fR.heightForcer,fR.gutters],"CodeMirror-scroll");fR.scroller.setAttribute("tabIndex","-1");fR.wrapper=fx("div",[fR.inputDiv,fR.scrollbarH,fR.scrollbarV,fR.scrollbarFiller,fR.gutterFiller,fR.scroller],"CodeMirror");if(b1){fR.gutters.style.zIndex=-1;fR.scroller.style.paddingRight=0}if(eD){fP.style.width="0px"}if(!cJ){fR.scroller.draggable=true}if(a1){fR.inputDiv.style.height="1px";fR.inputDiv.style.position="absolute"}if(b1){fR.scrollbarH.style.minHeight=fR.scrollbarV.style.minWidth="18px"}if(fO.appendChild){fO.appendChild(fR.wrapper)}else{fO(fR.wrapper)}fR.viewFrom=fR.viewTo=fQ.first;fR.view=[];fR.externalMeasured=null;fR.viewOffset=0;fR.lastSizeC=0;fR.updateLineNumbers=null;fR.lineNumWidth=fR.lineNumInnerWidth=fR.lineNumChars=null;fR.prevInput="";fR.alignWidgets=false;fR.pollingFast=false;fR.poll=new fN();fR.cachedCharWidth=fR.cachedTextHeight=fR.cachedPaddingH=null;fR.inaccurateSelection=false;fR.maxLine=null;fR.maxLineLength=0;fR.maxLineChanged=false;fR.wheelDX=fR.wheelDY=fR.wheelStartX=fR.wheelStartY=null;fR.shift=false;fR.selForContextMenu=null}function bh(fO){fO.doc.mode=I.getMode(fO.options,fO.doc.modeOption);dX(fO)}function dX(fO){fO.doc.iter(function(fP){if(fP.stateAfter){fP.stateAfter=null}if(fP.styles){fP.styles=null}});fO.doc.frontier=fO.doc.first;dR(fO,100);fO.state.modeGen++;if(fO.curOp){af(fO)}}function ek(fO){if(fO.options.lineWrapping){fb(fO.display.wrapper,"CodeMirror-wrap");fO.display.sizer.style.minWidth=""}else{g(fO.display.wrapper,"CodeMirror-wrap");h(fO)}X(fO);af(fO);ai(fO);setTimeout(function(){eB(fO)},100)}function a3(fO){var fQ=aN(fO.display),fP=fO.options.lineWrapping;var fR=fP&&Math.max(5,fO.display.scroller.clientWidth/di(fO.display)-3);return function(fT){if(e7(fO.doc,fT)){return 0}var fS=0;if(fT.widgets){for(var fU=0;fU<fT.widgets.length;fU++){if(fT.widgets[fU].height){fS+=fT.widgets[fU].height}}}if(fP){return fS+(Math.ceil(fT.text.length/fR)||1)*fQ}else{return fS+fQ}}}function X(fO){var fQ=fO.doc,fP=a3(fO);fQ.iter(function(fR){var fS=fP(fR);if(fS!=fR.height){fB(fR,fS)}})}function fL(fO){var fQ=eK[fO.options.keyMap],fP=fQ.style;fO.display.wrapper.className=fO.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(fP?" cm-keymap-"+fP:"")}function cB(fO){fO.display.wrapper.className=fO.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+fO.options.theme.replace(/(^|\s)\s*/g," cm-s-");ai(fO)}function db(fO){dO(fO);af(fO);setTimeout(function(){ei(fO)},20)}function dO(fO){var fP=fO.display.gutters,fT=fO.options.gutters;dE(fP);for(var fQ=0;fQ<fT.length;++fQ){var fR=fT[fQ];var fS=fP.appendChild(fx("div",null,"CodeMirror-gutter "+fR));if(fR=="CodeMirror-linenumbers"){fO.display.lineGutter=fS;fS.style.width=(fO.display.lineNumWidth||1)+"px"}}fP.style.display=fQ?"":"none";cN(fO)}function cN(fO){var fP=fO.display.gutters.offsetWidth;fO.display.sizer.style.marginLeft=fP+"px";fO.display.scrollbarH.style.left=fO.options.fixedGutter?fP+"px":0}function dY(fQ){if(fQ.height==0){return 0}var fP=fQ.text.length,fO,fS=fQ;while(fO=er(fS)){var fR=fO.find(0,true);fS=fR.from.line;fP+=fR.from.ch-fR.to.ch}fS=fQ;while(fO=d7(fS)){var fR=fO.find(0,true);fP-=fS.text.length-fR.from.ch;fS=fR.to.line;fP+=fS.text.length-fR.to.ch}return fP}function h(fO){var fQ=fO.display,fP=fO.doc;fQ.maxLine=eP(fP,fP.first);fQ.maxLineLength=dY(fQ.maxLine);fQ.maxLineChanged=true;fP.iter(function(fS){var fR=dY(fS);if(fR>fQ.maxLineLength){fQ.maxLineLength=fR;fQ.maxLine=fS}})}function b4(fO){var fP=c1(fO.gutters,"CodeMirror-linenumbers");if(fP==-1&&fO.lineNumbers){fO.gutters=fO.gutters.concat(["CodeMirror-linenumbers"])}else{if(fP>-1&&!fO.lineNumbers){fO.gutters=fO.gutters.slice(0);fO.gutters.splice(fP,1)}}}function df(fP){var fO=fP.display.scroller;return{clientHeight:fO.clientHeight,barHeight:fP.display.scrollbarV.clientHeight,scrollWidth:fO.scrollWidth,clientWidth:fO.clientWidth,barWidth:fP.display.scrollbarH.clientWidth,docHeight:Math.round(fP.doc.height+bx(fP.display))}}function eB(fO,fT){if(!fT){fT=df(fO)}var fV=fO.display;var fS=fT.docHeight+ba;var fU=fT.scrollWidth>fT.clientWidth;var fQ=fS>fT.clientHeight;if(fQ){fV.scrollbarV.style.display="block";fV.scrollbarV.style.bottom=fU?l(fV.measure)+"px":"0";fV.scrollbarV.firstChild.style.height=Math.max(0,fS-fT.clientHeight+(fT.barHeight||fV.scrollbarV.clientHeight))+"px"}else{fV.scrollbarV.style.display="";fV.scrollbarV.firstChild.style.height="0"}if(fU){fV.scrollbarH.style.display="block";fV.scrollbarH.style.right=fQ?l(fV.measure)+"px":"0";fV.scrollbarH.firstChild.style.width=(fT.scrollWidth-fT.clientWidth+(fT.barWidth||fV.scrollbarH.clientWidth))+"px"}else{fV.scrollbarH.style.display="";fV.scrollbarH.firstChild.style.width="0"}if(fU&&fQ){fV.scrollbarFiller.style.display="block";fV.scrollbarFiller.style.height=fV.scrollbarFiller.style.width=l(fV.measure)+"px"}else{fV.scrollbarFiller.style.display=""}if(fU&&fO.options.coverGutterNextToScrollbar&&fO.options.fixedGutter){fV.gutterFiller.style.display="block";fV.gutterFiller.style.height=l(fV.measure)+"px";fV.gutterFiller.style.width=fV.gutters.offsetWidth+"px"}else{fV.gutterFiller.style.display=""}if(!fO.state.checkedOverlayScrollbar&&fT.clientHeight>0){if(l(fV.measure)===0){var fP=bU&&!cP?"12px":"18px";fV.scrollbarV.style.minWidth=fV.scrollbarH.style.minHeight=fP;var fR=function(fW){if(L(fW)!=fV.scrollbarV&&L(fW)!=fV.scrollbarH){cL(fO,d5)(fW)}};bM(fV.scrollbarV,"mousedown",fR);bM(fV.scrollbarH,"mousedown",fR)}fO.state.checkedOverlayScrollbar=true}}function bT(fQ,fU,fW){var fR=fW&&fW.top!=null?Math.max(0,fW.top):fQ.scroller.scrollTop;fR=Math.floor(fR-eI(fQ));var fO=fW&&fW.bottom!=null?fW.bottom:fR+fQ.wrapper.clientHeight;var fS=bv(fU,fR),fT=bv(fU,fO);if(fW&&fW.ensure){var fP=fW.ensure.from.line,fV=fW.ensure.to.line;if(fP<fS){return{from:fP,to:bv(fU,bB(eP(fU,fP))+fQ.wrapper.clientHeight)}}if(Math.min(fV,fU.lastLine())>=fT){return{from:bv(fU,bB(eP(fU,fV))-fQ.wrapper.clientHeight),to:fV}}}return{from:fS,to:Math.max(fT,fS+1)}}function ei(fW){var fU=fW.display,fV=fU.view;if(!fU.alignWidgets&&(!fU.gutters.firstChild||!fW.options.fixedGutter)){return}var fS=dA(fU)-fU.scroller.scrollLeft+fW.doc.scrollLeft;var fO=fU.gutters.offsetWidth,fP=fS+"px";for(var fR=0;fR<fV.length;fR++){if(!fV[fR].hidden){if(fW.options.fixedGutter&&fV[fR].gutter){fV[fR].gutter.style.left=fP}var fT=fV[fR].alignable;if(fT){for(var fQ=0;fQ<fT.length;fQ++){fT[fQ].style.left=fP}}}}if(fW.options.fixedGutter){fU.gutters.style.left=(fS+fO)+"px"}}function dI(fO){if(!fO.options.lineNumbers){return false}var fT=fO.doc,fP=d4(fO.options,fT.first+fT.size-1),fS=fO.display;if(fP.length!=fS.lineNumChars){var fU=fS.measure.appendChild(fx("div",[fx("div",fP)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var fQ=fU.firstChild.offsetWidth,fR=fU.offsetWidth-fQ;fS.lineGutter.style.width="";fS.lineNumInnerWidth=Math.max(fQ,fS.lineGutter.offsetWidth-fR);fS.lineNumWidth=fS.lineNumInnerWidth+fR;fS.lineNumChars=fS.lineNumInnerWidth?fP.length:-1;fS.lineGutter.style.width=fS.lineNumWidth+"px";cN(fO);return true}return false}function d4(fO,fP){return String(fO.lineNumberFormatter(fP+fO.firstLineNumber))}function dA(fO){return fO.scroller.getBoundingClientRect().left-fO.sizer.getBoundingClientRect().left}function dp(fT,fW,fX){var fV=fT.display.viewFrom,fU=fT.display.viewTo,fR;var fO=bT(fT.display,fT.doc,fW);for(var fQ=true;;fQ=false){var fP=fT.display.scroller.clientWidth;if(!cZ(fT,fO,fX)){break}fR=true;if(fT.display.maxLineChanged&&!fT.options.lineWrapping){b(fT)}var fS=df(fT);br(fT);de(fT,fS);eB(fT,fS);if(cJ&&fT.options.lineWrapping){fA(fT,fS)}if(fQ&&fT.options.lineWrapping&&fP!=fT.display.scroller.clientWidth){fX=true;continue}fX=false;if(fW&&fW.top!=null){fW={top:Math.min(fS.docHeight-ba-fS.clientHeight,fW.top)}}fO=bT(fT.display,fT.doc,fW);if(fO.from>=fT.display.viewFrom&&fO.to<=fT.display.viewTo){break}}fT.display.updateLineNumbers=null;if(fR){ac(fT,"update",fT);if(fT.display.viewFrom!=fV||fT.display.viewTo!=fU){ac(fT,"viewportChange",fT,fT.display.viewFrom,fT.display.viewTo)}}return fR}function cZ(fY,fQ,fZ){var fS=fY.display,fX=fY.doc;if(!fS.wrapper.offsetWidth){d9(fY);return}if(!fZ&&fQ.from>=fS.viewFrom&&fQ.to<=fS.viewTo&&cU(fY)==0){return}if(dI(fY)){d9(fY)}var fW=eM(fY);var fR=fX.first+fX.size;var fV=Math.max(fQ.from-fY.options.viewportMargin,fX.first);var fU=Math.min(fR,fQ.to+fY.options.viewportMargin);if(fS.viewFrom<fV&&fV-fS.viewFrom<20){fV=Math.max(fX.first,fS.viewFrom)}if(fS.viewTo>fU&&fS.viewTo-fU<20){fU=Math.min(fR,fS.viewTo)}if(aX){fV=aM(fY.doc,fV);fU=dG(fY.doc,fU)}var fP=fV!=fS.viewFrom||fU!=fS.viewTo||fS.lastSizeC!=fS.wrapper.clientHeight;cD(fY,fV,fU);fS.viewOffset=bB(eP(fY.doc,fS.viewFrom));fY.display.mover.style.top=fS.viewOffset+"px";var fO=cU(fY);if(!fP&&fO==0&&!fZ){return}var fT=ds();if(fO>4){fS.lineDiv.style.display="none"}cc(fY,fS.updateLineNumbers,fW);if(fO>4){fS.lineDiv.style.display=""}if(fT&&ds()!=fT&&fT.offsetHeight){fT.focus()}dE(fS.cursorDiv);dE(fS.selectionDiv);if(fP){fS.lastSizeC=fS.wrapper.clientHeight;dR(fY,400)}aZ(fY);return true}function b(fO){var fS=fO.display;var fQ=dT(fO,fS.maxLine,fS.maxLine.text.length).left;fS.maxLineChanged=false;var fP=Math.max(0,fQ+3);var fR=Math.max(0,fS.sizer.offsetLeft+fP+ba-fS.scroller.clientWidth);fS.sizer.style.minWidth=fP+"px";if(fR<fO.doc.scrollLeft){bt(fO,Math.min(fS.scroller.scrollLeft,fR),true)}}function de(fO,fP){fO.display.sizer.style.minHeight=fO.display.heightForcer.style.top=fP.docHeight+"px";fO.display.gutters.style.height=Math.max(fP.docHeight,fP.clientHeight-ba)+"px"}function fA(fO,fP){if(fO.display.sizer.offsetWidth+fO.display.gutters.offsetWidth<fO.display.scroller.clientWidth-1){fO.display.sizer.style.minHeight=fO.display.heightForcer.style.top="0px";fO.display.gutters.style.height=fP.docHeight+"px"}}function aZ(fV){var fT=fV.display;var fP=fT.lineDiv.offsetTop;for(var fQ=0;fQ<fT.view.length;fQ++){var fW=fT.view[fQ],fX;if(fW.hidden){continue}if(b1){var fS=fW.node.offsetTop+fW.node.offsetHeight;fX=fS-fP;fP=fS}else{var fR=fW.node.getBoundingClientRect();fX=fR.bottom-fR.top}var fU=fW.line.height-fX;if(fX<2){fX=aN(fT)}if(fU>0.001||fU<-0.001){fB(fW.line,fX);b0(fW.line);if(fW.rest){for(var fO=0;fO<fW.rest.length;fO++){b0(fW.rest[fO])}}}}}function b0(fO){if(fO.widgets){for(var fP=0;fP<fO.widgets.length;++fP){fO.widgets[fP].height=fO.widgets[fP].node.offsetHeight}}}function eM(fO){var fS=fO.display,fR={},fQ={};for(var fT=fS.gutters.firstChild,fP=0;fT;fT=fT.nextSibling,++fP){fR[fO.options.gutters[fP]]=fT.offsetLeft;fQ[fO.options.gutters[fP]]=fT.offsetWidth}return{fixedPos:dA(fS),gutterTotalWidth:fS.gutters.offsetWidth,gutterLeft:fR,gutterWidth:fQ,wrapperWidth:fS.wrapper.clientWidth}}function cc(fZ,fQ,fY){var fV=fZ.display,f1=fZ.options.lineNumbers;var fO=fV.lineDiv,f0=fO.firstChild;function fU(f3){var f2=f3.nextSibling;if(cJ&&bU&&fZ.display.currentWheelTarget==f3){f3.style.display="none"}else{f3.parentNode.removeChild(f3)}return f2}var fW=fV.view,fT=fV.viewFrom;for(var fR=0;fR<fW.length;fR++){var fS=fW[fR];if(fS.hidden){}else{if(!fS.node){var fP=aA(fZ,fS,fT,fY);fO.insertBefore(fP,f0)}else{while(f0!=fS.node){f0=fU(f0)}var fX=f1&&fQ!=null&&fQ<=fT&&fS.lineNumber;if(fS.changes){if(c1(fS.changes,"gutter")>-1){fX=false}Z(fZ,fS,fT,fY)}if(fX){dE(fS.lineNumber);fS.lineNumber.appendChild(document.createTextNode(d4(fZ.options,fT)))}f0=fS.node.nextSibling}}fT+=fS.size}while(f0){f0=fU(f0)}}function Z(fO,fQ,fS,fT){for(var fP=0;fP<fQ.changes.length;fP++){var fR=fQ.changes[fP];if(fR=="text"){eV(fO,fQ)}else{if(fR=="gutter"){cY(fO,fQ,fS,fT)}else{if(fR=="class"){dl(fQ)}else{if(fR=="widget"){al(fQ,fT)}}}}}fQ.changes=null}function fj(fO){if(fO.node==fO.text){fO.node=fx("div",null,null,"position: relative");if(fO.text.parentNode){fO.text.parentNode.replaceChild(fO.node,fO.text)}fO.node.appendChild(fO.text);if(b1){fO.node.style.zIndex=2}}return fO.node}function d6(fP){var fO=fP.bgClass?fP.bgClass+" "+(fP.line.bgClass||""):fP.line.bgClass;if(fO){fO+=" CodeMirror-linebackground"}if(fP.background){if(fO){fP.background.className=fO}else{fP.background.parentNode.removeChild(fP.background);fP.background=null}}else{if(fO){var fQ=fj(fP);fP.background=fQ.insertBefore(fx("div",null,fO),fQ.firstChild)}}}function dy(fO,fP){var fQ=fO.display.externalMeasured;if(fQ&&fQ.line==fP.line){fO.display.externalMeasured=null;fP.measure=fQ.measure;return fQ.built}return ev(fO,fP)}function eV(fO,fR){var fP=fR.text.className;var fQ=dy(fO,fR);if(fR.text==fR.node){fR.node=fQ.pre}fR.text.parentNode.replaceChild(fQ.pre,fR.text);fR.text=fQ.pre;if(fQ.bgClass!=fR.bgClass||fQ.textClass!=fR.textClass){fR.bgClass=fQ.bgClass;fR.textClass=fQ.textClass;dl(fR)}else{if(fP){fR.text.className=fP}}}function dl(fP){d6(fP);if(fP.line.wrapClass){fj(fP).className=fP.line.wrapClass}else{if(fP.node!=fP.text){fP.node.className=""}}var fO=fP.textClass?fP.textClass+" "+(fP.line.textClass||""):fP.line.textClass;fP.text.className=fO||""}function cY(fW,fU,fT,fV){if(fU.gutter){fU.node.removeChild(fU.gutter);fU.gutter=null}var fR=fU.line.gutterMarkers;if(fW.options.lineNumbers||fR){var fP=fj(fU);var fS=fU.gutter=fP.insertBefore(fx("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(fW.options.fixedGutter?fV.fixedPos:-fV.gutterTotalWidth)+"px"),fU.text);if(fW.options.lineNumbers&&(!fR||!fR["CodeMirror-linenumbers"])){fU.lineNumber=fS.appendChild(fx("div",d4(fW.options,fT),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+fV.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+fW.display.lineNumInnerWidth+"px"))}if(fR){for(var fQ=0;fQ<fW.options.gutters.length;++fQ){var fO=fW.options.gutters[fQ],fX=fR.hasOwnProperty(fO)&&fR[fO];if(fX){fS.appendChild(fx("div",[fX],"CodeMirror-gutter-elt","left: "+fV.gutterLeft[fO]+"px; width: "+fV.gutterWidth[fO]+"px"))}}}}}function al(fO,fR){if(fO.alignable){fO.alignable=null}for(var fQ=fO.node.firstChild,fP;fQ;fQ=fP){var fP=fQ.nextSibling;if(fQ.className=="CodeMirror-linewidget"){fO.node.removeChild(fQ)}}e4(fO,fR)}function aA(fO,fQ,fR,fS){var fP=dy(fO,fQ);fQ.text=fQ.node=fP.pre;if(fP.bgClass){fQ.bgClass=fP.bgClass}if(fP.textClass){fQ.textClass=fP.textClass}dl(fQ);cY(fO,fQ,fR,fS);e4(fQ,fS);return fQ.node}function e4(fP,fQ){fC(fP.line,fP,fQ,true);if(fP.rest){for(var fO=0;fO<fP.rest.length;fO++){fC(fP.rest[fO],fP,fQ,false)}}}function fC(fW,fT,fV,fR){if(!fW.widgets){return}var fO=fj(fT);for(var fQ=0,fU=fW.widgets;fQ<fU.length;++fQ){var fS=fU[fQ],fP=fx("div",[fS.node],"CodeMirror-linewidget");if(!fS.handleMouseEvents){fP.ignoreEvents=true}bu(fS,fP,fT,fV);if(fR&&fS.above){fO.insertBefore(fP,fT.gutter||fT.text)}else{fO.appendChild(fP)}ac(fS,"redraw")}}function bu(fR,fQ,fO,fS){if(fR.noHScroll){(fO.alignable||(fO.alignable=[])).push(fQ);var fP=fS.wrapperWidth;fQ.style.left=fS.fixedPos+"px";if(!fR.coverGutter){fP-=fS.gutterTotalWidth;fQ.style.paddingLeft=fS.gutterTotalWidth+"px"}fQ.style.width=fP+"px"}if(fR.coverGutter){fQ.style.zIndex=5;fQ.style.position="relative";if(!fR.noHScroll){fQ.style.marginLeft=-fS.gutterTotalWidth+"px"}}}var W=I.Pos=function(fO,fP){if(!(this instanceof W)){return new W(fO,fP)}this.line=fO;this.ch=fP};var b5=I.cmpPos=function(fP,fO){return fP.line-fO.line||fP.ch-fO.ch};function b9(fO){return W(fO.line,fO.ch)}function bn(fP,fO){return b5(fP,fO)<0?fO:fP}function am(fP,fO){return b5(fP,fO)<0?fP:fO}function fy(fO,fP){this.ranges=fO;this.primIndex=fP}fy.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(fO){if(fO==this){return true}if(fO.primIndex!=this.primIndex||fO.ranges.length!=this.ranges.length){return false}for(var fQ=0;fQ<this.ranges.length;fQ++){var fP=this.ranges[fQ],fR=fO.ranges[fQ];if(b5(fP.anchor,fR.anchor)!=0||b5(fP.head,fR.head)!=0){return false}}return true},deepCopy:function(){for(var fO=[],fP=0;fP<this.ranges.length;fP++){fO[fP]=new dB(b9(this.ranges[fP].anchor),b9(this.ranges[fP].head))}return new fy(fO,this.primIndex)},somethingSelected:function(){for(var fO=0;fO<this.ranges.length;fO++){if(!this.ranges[fO].empty()){return true}}return false},contains:function(fR,fO){if(!fO){fO=fR}for(var fQ=0;fQ<this.ranges.length;fQ++){var fP=this.ranges[fQ];if(b5(fO,fP.from())>=0&&b5(fR,fP.to())<=0){return fQ}}return -1}};function dB(fO,fP){this.anchor=fO;this.head=fP}dB.prototype={from:function(){return am(this.anchor,this.head)},to:function(){return bn(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cm(fO,fV){var fQ=fO[fV];fO.sort(function(fY,fX){return b5(fY.from(),fX.from())});fV=c1(fO,fQ);for(var fS=1;fS<fO.length;fS++){var fW=fO[fS],fP=fO[fS-1];if(b5(fP.to(),fW.from())>=0){var fT=am(fP.from(),fW.from()),fU=bn(fP.to(),fW.to());var fR=fP.empty()?fW.from()==fW.head:fP.from()==fP.head;if(fS<=fV){--fV}fO.splice(--fS,2,new dB(fR?fU:fT,fR?fT:fU))}}return new fy(fO,fV)}function eu(fO,fP){return new fy([new dB(fO,fP||fO)],0)}function cO(fO,fP){return Math.max(fO.first,Math.min(fP,fO.first+fO.size-1))}function fk(fP,fQ){if(fQ.line<fP.first){return W(fP.first,0)}var fO=fP.first+fP.size-1;if(fQ.line>fO){return W(fO,eP(fP,fO).text.length)}return e3(fQ,eP(fP,fQ.line).text.length)}function e3(fQ,fP){var fO=fQ.ch;if(fO==null||fO>fP){return W(fQ.line,fP)}else{if(fO<0){return W(fQ.line,0)}else{return fQ}}}function bW(fP,fO){return fO>=fP.first&&fO<fP.first+fP.size}function dC(fQ,fR){for(var fO=[],fP=0;fP<fR.length;fP++){fO[fP]=fk(fQ,fR[fP])}return fO}function e6(fT,fP,fS,fO){if(fT.cm&&fT.cm.display.shift||fT.extend){var fR=fP.anchor;if(fO){var fQ=b5(fS,fR)<0;if(fQ!=(b5(fO,fR)<0)){fR=fS;fS=fO}else{if(fQ!=(b5(fS,fO)<0)){fS=fO}}}return new dB(fR,fS)}else{return new dB(fO||fS,fS)}}function fu(fR,fQ,fO,fP){bJ(fR,new fy([e6(fR,fR.sel.primary(),fQ,fO)],0),fP)}function at(fT,fS,fQ){for(var fP=[],fR=0;fR<fT.sel.ranges.length;fR++){fP[fR]=e6(fT,fT.sel.ranges[fR],fS[fR],null)}var fO=cm(fP,fT.sel.primIndex);bJ(fT,fO,fQ)}function f(fS,fR,fP,fQ){var fO=fS.sel.ranges.slice(0);fO[fR]=fP;bJ(fS,cm(fO,fS.sel.primIndex),fQ)}function G(fR,fP,fQ,fO){bJ(fR,eu(fP,fQ),fO)}function d(fQ,fO){var fP={ranges:fO.ranges,update:function(fR){this.ranges=[];for(var fS=0;fS<fR.length;fS++){this.ranges[fS]=new dB(fk(fQ,fR[fS].anchor),fk(fQ,fR[fS].head))}}};az(fQ,"beforeSelectionChange",fQ,fP);if(fQ.cm){az(fQ.cm,"beforeSelectionChange",fQ.cm,fP)}if(fP.ranges!=fO.ranges){return cm(fP.ranges,fP.ranges.length-1)}else{return fO}}function eH(fS,fR,fP){var fO=fS.history.done,fQ=fi(fO);if(fQ&&fQ.ranges){fO[fO.length-1]=fR;d1(fS,fR,fP)}else{bJ(fS,fR,fP)}}function bJ(fQ,fP,fO){d1(fQ,fP,fO);fH(fQ,fQ.sel,fQ.cm?fQ.cm.curOp.id:NaN,fO)}function d1(fR,fQ,fP){if(eS(fR,"beforeSelectionChange")||fR.cm&&eS(fR.cm,"beforeSelectionChange")){fQ=d(fR,fQ)}var fO=fP&&fP.bias||(b5(fQ.primary().head,fR.sel.primary().head)<0?-1:1);cS(fR,o(fR,fQ,fO,true));if(!(fP&&fP.scroll===false)&&fR.cm){fh(fR.cm)}}function cS(fP,fO){if(fO.equals(fP.sel)){return}fP.sel=fO;if(fP.cm){fP.cm.curOp.updateInput=fP.cm.curOp.selectionChanged=true;V(fP.cm)}ac(fP,"cursorActivity",fP)}function ea(fO){cS(fO,o(fO,fO.sel,null,false),Y)}function o(fW,fO,fT,fU){var fQ;for(var fR=0;fR<fO.ranges.length;fR++){var fS=fO.ranges[fR];var fV=bK(fW,fS.anchor,fT,fU);var fP=bK(fW,fS.head,fT,fU);if(fQ||fV!=fS.anchor||fP!=fS.head){if(!fQ){fQ=fO.ranges.slice(0,fR)}fQ[fR]=new dB(fV,fP)}}return fQ?cm(fQ,fO.primIndex):fO}function bK(fX,fW,fT,fU){var fY=false,fQ=fW;var fR=fT||1;fX.cantEdit=false;search:for(;;){var fZ=eP(fX,fQ.line);if(fZ.markedSpans){for(var fS=0;fS<fZ.markedSpans.length;++fS){var fO=fZ.markedSpans[fS],fP=fO.marker;if((fO.from==null||(fP.inclusiveLeft?fO.from<=fQ.ch:fO.from<fQ.ch))&&(fO.to==null||(fP.inclusiveRight?fO.to>=fQ.ch:fO.to>fQ.ch))){if(fU){az(fP,"beforeCursorEnter");if(fP.explicitlyCleared){if(!fZ.markedSpans){break}else{--fS;continue}}}if(!fP.atomic){continue}var fV=fP.find(fR<0?-1:1);if(b5(fV,fQ)==0){fV.ch+=fR;if(fV.ch<0){if(fV.line>fX.first){fV=fk(fX,W(fV.line-1))}else{fV=null}}else{if(fV.ch>fZ.text.length){if(fV.line<fX.first+fX.size-1){fV=W(fV.line+1,0)}else{fV=null}}}if(!fV){if(fY){if(!fU){return bK(fX,fW,fT,true)}fX.cantEdit=true;return W(fX.first,0)}fY=true;fV=fW;fR=-fR}}fQ=fV;continue search}}}return fQ}}function br(f0){var fV=f0.display,fZ=f0.doc;var fX=document.createDocumentFragment();var fR=document.createDocumentFragment();for(var fT=0;fT<fZ.sel.ranges.length;fT++){var fU=fZ.sel.ranges[fT];var fS=fU.empty();if(fS||f0.options.showCursorWhenSelecting){B(f0,fU,fX)}if(!fS){bs(f0,fU,fR)}}if(f0.options.moveInputWithCursor){var fW=dx(f0,fZ.sel.primary().head,"div");var fO=fV.wrapper.getBoundingClientRect(),fQ=fV.lineDiv.getBoundingClientRect();var fY=Math.max(0,Math.min(fV.wrapper.clientHeight-10,fW.top+fQ.top-fO.top));var fP=Math.max(0,Math.min(fV.wrapper.clientWidth-10,fW.left+fQ.left-fO.left));fV.inputDiv.style.top=fY+"px";fV.inputDiv.style.left=fP+"px"}bG(fV.cursorDiv,fX);bG(fV.selectionDiv,fR)}function B(fO,fR,fQ){var fT=dx(fO,fR.head,"div");var fS=fQ.appendChild(fx("div","\u00a0","CodeMirror-cursor"));fS.style.left=fT.left+"px";fS.style.top=fT.top+"px";fS.style.height=Math.max(0,fT.bottom-fT.top)*fO.options.cursorHeight+"px";if(fT.other){var fP=fQ.appendChild(fx("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));fP.style.display="";fP.style.left=fT.other.left+"px";fP.style.top=fT.other.top+"px";fP.style.height=(fT.other.bottom-fT.other.top)*0.85+"px"}}function bs(fS,fY,fT){var f1=fS.display,f5=fS.doc;var fO=document.createDocumentFragment();var fX=eG(fS.display),fR=fX.left,f2=f1.lineSpace.offsetWidth-fX.right;function fZ(f9,f8,f7,f6){if(f8<0){f8=0}f8=Math.round(f8);f6=Math.round(f6);fO.appendChild(fx("div",null,"CodeMirror-selected","position: absolute; left: "+f9+"px; top: "+f8+"px; width: "+(f7==null?f2-f9:f7)+"px; height: "+(f6-f8)+"px"))}function fP(f7,f9,gc){var f8=eP(f5,f7);var ga=f8.text.length;var gd,f6;function gb(gf,ge){return cx(fS,W(f7,gf),"div",f8,ge)}dH(a(f8),f9||0,gc==null?ga:gc,function(gl,gk,ge){var gh=gb(gl,"left"),gi,gj,gg;if(gl==gk){gi=gh;gj=gg=gh.left}else{gi=gb(gk-1,"right");if(ge=="rtl"){var gf=gh;gh=gi;gi=gf}gj=gh.left;gg=gi.right}if(f9==null&&gl==0){gj=fR}if(gi.top-gh.top>3){fZ(gj,gh.top,null,gh.bottom);gj=fR;if(gh.bottom<gi.top){fZ(gj,gh.bottom,null,gi.top)}}if(gc==null&&gk==ga){gg=f2}if(!gd||gh.top<gd.top||gh.top==gd.top&&gh.left<gd.left){gd=gh}if(!f6||gi.bottom>f6.bottom||gi.bottom==f6.bottom&&gi.right>f6.right){f6=gi}if(gj<fR+1){gj=fR}fZ(gj,gi.top,gg-gj,gi.bottom)});return{start:gd,end:f6}}var f4=fY.from(),f3=fY.to();if(f4.line==f3.line){fP(f4.line,f4.ch,f3.ch)}else{var fQ=eP(f5,f4.line),fV=eP(f5,f3.line);var fU=z(fQ)==z(fV);var fW=fP(f4.line,f4.ch,fU?fQ.text.length+1:null).end;var f0=fP(f3.line,fU?0:null,f3.ch).start;if(fU){if(fW.top<f0.top-2){fZ(fW.right,fW.top,null,fW.bottom);fZ(fR,f0.top,f0.left,f0.bottom)}else{fZ(fW.right,fW.top,f0.left-fW.right,fW.bottom)}}if(fW.bottom<f0.top){fZ(fR,fW.bottom,null,f0.top)}}fT.appendChild(fO)}function p(fO){if(!fO.state.focused){return}var fQ=fO.display;clearInterval(fQ.blinker);var fP=true;fQ.cursorDiv.style.visibility="";if(fO.options.cursorBlinkRate>0){fQ.blinker=setInterval(function(){fQ.cursorDiv.style.visibility=(fP=!fP)?"":"hidden"},fO.options.cursorBlinkRate)}}function dR(fO,fP){if(fO.doc.mode.startState&&fO.doc.frontier<fO.display.viewTo){fO.state.highlight.set(fP,cl(cC,fO))}}function cC(fO){var fR=fO.doc;if(fR.frontier<fR.first){fR.frontier=fR.first}if(fR.frontier>=fO.display.viewTo){return}var fP=+new Date+fO.options.workTime;var fQ=bR(fR.mode,dg(fO,fR.frontier));cz(fO,function(){fR.iter(fR.frontier,Math.min(fR.first+fR.size,fO.display.viewTo+500),function(fS){if(fR.frontier>=fO.display.viewFrom){var fU=fS.styles;var fV=fa(fO,fS,fQ,true);fS.styles=fV.styles;if(fV.classes){fS.styleClasses=fV.classes}else{if(fS.styleClasses){fS.styleClasses=null}}var fW=!fU||fU.length!=fS.styles.length;for(var fT=0;!fW&&fT<fU.length;++fT){fW=fU[fT]!=fS.styles[fT]}if(fW){R(fO,fR.frontier,"text")}fS.stateAfter=bR(fR.mode,fQ)}else{dc(fO,fS.text,fQ);fS.stateAfter=fR.frontier%5==0?bR(fR.mode,fQ):null}++fR.frontier;if(+new Date>fP){dR(fO,fO.options.workDelay);return true}})})}function co(fU,fO,fR){var fP,fS,fT=fU.doc;var fQ=fR?-1:fO-(fU.doc.mode.innerMode?1000:100);for(var fX=fO;fX>fQ;--fX){if(fX<=fT.first){return fT.first}var fW=eP(fT,fX-1);if(fW.stateAfter&&(!fR||fX<=fT.frontier)){return fX}var fV=bI(fW.text,null,fU.options.tabSize);if(fS==null||fP>fV){fS=fX-1;fP=fV}}return fS}function dg(fO,fU,fP){var fS=fO.doc,fR=fO.display;if(!fS.mode.startState){return true}var fT=co(fO,fU,fP),fQ=fT>fS.first&&eP(fS,fT-1).stateAfter;if(!fQ){fQ=bP(fS.mode)}else{fQ=bR(fS.mode,fQ)}fS.iter(fT,fU,function(fV){dc(fO,fV.text,fQ);var fW=fT==fU-1||fT%5==0||fT>=fR.viewFrom&&fT<fR.viewTo;fV.stateAfter=fW?bR(fS.mode,fQ):null;++fT});if(fP){fS.frontier=fT}return fQ}function eI(fO){return fO.lineSpace.offsetTop}function bx(fO){return fO.mover.offsetHeight-fO.lineSpace.offsetHeight}function eG(fR){if(fR.cachedPaddingH){return fR.cachedPaddingH}var fQ=bG(fR.measure,fx("pre","x"));var fO=window.getComputedStyle?window.getComputedStyle(fQ):fQ.currentStyle;var fP={left:parseInt(fO.paddingLeft),right:parseInt(fO.paddingRight)};if(!isNaN(fP.left)&&!isNaN(fP.right)){fR.cachedPaddingH=fP}return fP}function b8(fV,fR,fU){var fQ=fV.options.lineWrapping;var fS=fQ&&fV.display.scroller.clientWidth;if(!fR.measure.heights||fQ&&fR.measure.width!=fS){var fT=fR.measure.heights=[];if(fQ){fR.measure.width=fS;var fX=fR.text.firstChild.getClientRects();for(var fO=0;fO<fX.length-1;fO++){var fW=fX[fO],fP=fX[fO+1];if(Math.abs(fW.bottom-fP.bottom)>2){fT.push((fW.bottom+fP.top)/2-fU.top)}}}fT.push(fU.bottom-fU.top)}}function cj(fQ,fO,fR){if(fQ.line==fO){return{map:fQ.measure.map,cache:fQ.measure.cache}}for(var fP=0;fP<fQ.rest.length;fP++){if(fQ.rest[fP]==fO){return{map:fQ.measure.maps[fP],cache:fQ.measure.caches[fP]}}}for(var fP=0;fP<fQ.rest.length;fP++){if(bC(fQ.rest[fP])>fR){return{map:fQ.measure.maps[fP],cache:fQ.measure.caches[fP],before:true}}}}function cK(fO,fQ){fQ=z(fQ);var fS=bC(fQ);var fP=fO.display.externalMeasured=new bl(fO.doc,fQ,fS);fP.lineN=fS;var fR=fP.built=ev(fO,fP);fP.text=fR.pre;bG(fO.display.lineMeasure,fR.pre);return fP}function dT(fO,fP,fR,fQ){return D(fO,aU(fO,fP),fR,fQ)}function eL(fO,fQ){if(fQ>=fO.display.viewFrom&&fQ<fO.display.viewTo){return fO.display.view[c7(fO,fQ)]}var fP=fO.display.externalMeasured;if(fP&&fQ>=fP.lineN&&fQ<fP.lineN+fP.size){return fP}}function aU(fO,fQ){var fR=bC(fQ);var fP=eL(fO,fR);if(fP&&!fP.text){fP=null}else{if(fP&&fP.changes){Z(fO,fP,fR,eM(fO))}}if(!fP){fP=cK(fO,fQ)}var fS=cj(fP,fQ,fR);return{line:fQ,view:fP,rect:null,map:fS.map,cache:fS.cache,before:fS.before,hasHeights:false}}function D(fO,fT,fR,fP){if(fT.before){fR=-1}var fQ=fR+(fP||""),fS;if(fT.cache.hasOwnProperty(fQ)){fS=fT.cache[fQ]}else{if(!fT.rect){fT.rect=fT.view.text.getBoundingClientRect()}if(!fT.hasHeights){b8(fO,fT.view,fT.rect);fT.hasHeights=true}fS=k(fO,fT,fR,fP);if(!fS.bogus){fT.cache[fQ]=fS}}return{left:fS.left,right:fS.right,top:fS.top,bottom:fS.bottom}}var ee={left:0,right:0,top:0,bottom:0};function k(fV,f3,fX,fT){var f6=f3.map;var f0,fS,fR,fO;for(var f2=0;f2<f6.length;f2+=3){var f5=f6[f2],f1=f6[f2+1];if(fX<f5){fS=0;fR=1;fO="left"}else{if(fX<f1){fS=fX-f5;fR=fS+1}else{if(f2==f6.length-3||fX==f1&&f6[f2+3]>fX){fR=f1-f5;fS=fR-1;if(fX>=f1){fO="right"}}}}if(fS!=null){f0=f6[f2+2];if(f5==f1&&fT==(f0.insertLeft?"left":"right")){fO=fT}if(fT=="left"&&fS==0){while(f2&&f6[f2-2]==f6[f2-3]&&f6[f2-1].insertLeft){f0=f6[(f2-=3)+2];fO="left"}}if(fT=="right"&&fS==f1-f5){while(f2<f6.length-3&&f6[f2+3]==f6[f2+4]&&!f6[f2+5].insertLeft){f0=f6[(f2+=3)+2];fO="right"}}break}}var fP;if(f0.nodeType==3){while(fS&&e0(f3.line.text.charAt(f5+fS))){--fS}while(f5+fR<f1&&e0(f3.line.text.charAt(f5+fR))){++fR}if(bY&&fS==0&&fR==f1-f5){fP=f0.parentNode.getBoundingClientRect()}else{if(dn&&fV.options.lineWrapping){var fQ=cb(f0,fS,fR).getClientRects();if(fQ.length){fP=fQ[fT=="right"?fQ.length-1:0]}else{fP=ee}}else{fP=cb(f0,fS,fR).getBoundingClientRect()||ee}}}else{if(fS>0){fO=fT="right"}var fQ;if(fV.options.lineWrapping&&(fQ=f0.getClientRects()).length>1){fP=fQ[fT=="right"?fQ.length-1:0]}else{fP=f0.getBoundingClientRect()}}if(bY&&!fS&&(!fP||!fP.left&&!fP.right)){var fU=f0.parentNode.getClientRects()[0];if(fU){fP={left:fU.left,right:fU.left+di(fV.display),top:fU.top,bottom:fU.bottom}}else{fP=ee}}var fZ,fY=(fP.bottom+fP.top)/2-f3.rect.top;var f4=f3.view.measure.heights;for(var f2=0;f2<f4.length-1;f2++){if(fY<f4[f2]){break}}fZ=f2?f4[f2-1]:0;fY=f4[f2];var fW={left:(fO=="right"?fP.right:fP.left)-f3.rect.left,right:(fO=="left"?fP.left:fP.right)-f3.rect.left,top:fZ,bottom:fY};if(!fP.left&&!fP.right){fW.bogus=true}return fW}function ap(fP){if(fP.measure){fP.measure.cache={};fP.measure.heights=null;if(fP.rest){for(var fO=0;fO<fP.rest.length;fO++){fP.measure.caches[fO]={}}}}}function aF(fO){fO.display.externalMeasure=null;dE(fO.display.lineMeasure);for(var fP=0;fP<fO.display.view.length;fP++){ap(fO.display.view[fP])}}function ai(fO){aF(fO);fO.display.cachedCharWidth=fO.display.cachedTextHeight=fO.display.cachedPaddingH=null;if(!fO.options.lineWrapping){fO.display.maxLineChanged=true}fO.display.lineNumChars=null}function ck(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ci(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function et(fU,fR,fT,fP){if(fR.widgets){for(var fQ=0;fQ<fR.widgets.length;++fQ){if(fR.widgets[fQ].above){var fW=cH(fR.widgets[fQ]);fT.top+=fW;fT.bottom+=fW}}}if(fP=="line"){return fT}if(!fP){fP="local"}var fS=bB(fR);if(fP=="local"){fS+=eI(fU.display)}else{fS-=fU.display.viewOffset}if(fP=="page"||fP=="window"){var fO=fU.display.lineSpace.getBoundingClientRect();fS+=fO.top+(fP=="window"?0:ci());var fV=fO.left+(fP=="window"?0:ck());fT.left+=fV;fT.right+=fV}fT.top+=fS;fT.bottom+=fS;return fT}function fK(fP,fS,fQ){if(fQ=="div"){return fS}var fU=fS.left,fT=fS.top;if(fQ=="page"){fU-=ck();fT-=ci()}else{if(fQ=="local"||!fQ){var fR=fP.display.sizer.getBoundingClientRect();fU+=fR.left;fT+=fR.top}}var fO=fP.display.lineSpace.getBoundingClientRect();return{left:fU-fO.left,top:fT-fO.top}}function cx(fO,fS,fR,fQ,fP){if(!fQ){fQ=eP(fO.doc,fS.line)}return et(fO,fQ,dT(fO,fQ,fS.ch,fP),fR)}function dx(fW,fV,fQ,fU,fY){fU=fU||eP(fW.doc,fV.line);if(!fY){fY=aU(fW,fU)}function fS(f1,f0){var fZ=D(fW,fY,f1,f0?"right":"left");if(f0){fZ.left=fZ.right}else{fZ.right=fZ.left}return et(fW,fU,fZ,fQ)}function fX(f2,fZ){var f0=fT[fZ],f1=f0.level%2;if(f2==dd(f0)&&fZ&&f0.level<fT[fZ-1].level){f0=fT[--fZ];f2=fJ(f0)-(f0.level%2?0:1);f1=true}else{if(f2==fJ(f0)&&fZ<fT.length-1&&f0.level<fT[fZ+1].level){f0=fT[++fZ];f2=dd(f0)-f0.level%2;f1=false}}if(f1&&f2==f0.to&&f2>f0.from){return fS(f2-1)}return fS(f2,f1)}var fT=a(fU),fO=fV.ch;if(!fT){return fS(fO)}var fP=aB(fT,fO);var fR=fX(fO,fP);if(eE!=null){fR.other=fX(fO,eE)}return fR}function dm(fO,fS){var fR=0,fS=fk(fO.doc,fS);if(!fO.options.lineWrapping){fR=di(fO.display)*fS.ch}var fP=eP(fO.doc,fS.line);var fQ=bB(fP)+eI(fO.display);return{left:fR,right:fR,top:fQ,bottom:fQ+fP.height}}function fw(fO,fP,fQ,fS){var fR=W(fO,fP);fR.xRel=fS;if(fQ){fR.outside=true}return fR}function fp(fV,fS,fR){var fU=fV.doc;fR+=fV.display.viewOffset;if(fR<0){return fw(fU.first,0,true,-1)}var fQ=bv(fU,fR),fW=fU.first+fU.size-1;if(fQ>fW){return fw(fU.first+fU.size-1,eP(fU,fW).text.length,true,1)}if(fS<0){fS=0}var fP=eP(fU,fQ);for(;;){var fX=cI(fV,fP,fQ,fS,fR);var fT=d7(fP);var fO=fT&&fT.find(0,true);if(fT&&(fX.ch>fO.from.ch||fX.ch==fO.from.ch&&fX.xRel>0)){fQ=bC(fP=fO.to.line)}else{return fX}}}function cI(fY,fQ,f1,f0,fZ){var fX=fZ-bB(fQ);var fU=false,f7=2*fY.display.wrapper.clientWidth;var f4=aU(fY,fQ);function gb(gd){var ge=dx(fY,W(f1,gd),"line",fQ,f4);fU=true;if(fX>ge.bottom){return ge.left-f7}else{if(fX<ge.top){return ge.left+f7}else{fU=false}}return ge.left}var f3=a(fQ),f6=fQ.text.length;var f8=ct(fQ),fR=cE(fQ);var f5=gb(f8),fO=fU,fP=gb(fR),fT=fU;if(f0>fP){return fw(f1,fR,fT,1)}for(;;){if(f3?fR==f8||fR==v(fQ,f8,1):fR-f8<=1){var f2=f0<f5||f0-f5<=fP-f0?f8:fR;var ga=f0-(f2==f8?f5:fP);while(e0(fQ.text.charAt(f2))){++f2}var fW=fw(f1,f2,f2==f8?fO:fT,ga<-1?-1:ga>1?1:0);return fW}var fV=Math.ceil(f6/2),gc=f8+fV;if(f3){gc=f8;for(var f9=0;f9<fV;++f9){gc=v(fQ,gc,1)}}var fS=gb(gc);if(fS>f0){fR=gc;fP=fS;if(fT=fU){fP+=1000}f6=fV}else{f8=gc;f5=fS;fO=fU;f6-=fV}}}var aC;function aN(fQ){if(fQ.cachedTextHeight!=null){return fQ.cachedTextHeight}if(aC==null){aC=fx("pre");for(var fP=0;fP<49;++fP){aC.appendChild(document.createTextNode("x"));aC.appendChild(fx("br"))}aC.appendChild(document.createTextNode("x"))}bG(fQ.measure,aC);var fO=aC.offsetHeight/50;if(fO>3){fQ.cachedTextHeight=fO}dE(fQ.measure);return fO||1}function di(fS){if(fS.cachedCharWidth!=null){return fS.cachedCharWidth}var fO=fx("span","xxxxxxxxxx");var fR=fx("pre",[fO]);bG(fS.measure,fR);var fQ=fO.getBoundingClientRect(),fP=(fQ.right-fQ.left)/10;if(fP>2){fS.cachedCharWidth=fP}return fP||10}var dL=0;function cw(fO){fO.curOp={viewChanged:false,startHeight:fO.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++dL};if(!ch++){be=[]}}function aj(fZ){var fU=fZ.curOp,fY=fZ.doc,fV=fZ.display;fZ.curOp=null;if(fU.updateMaxLine){h(fZ)}if(fU.viewChanged||fU.forceUpdate||fU.scrollTop!=null||fU.scrollToPos&&(fU.scrollToPos.from.line<fV.viewFrom||fU.scrollToPos.to.line>=fV.viewTo)||fV.maxLineChanged&&fZ.options.lineWrapping){var fS=dp(fZ,{top:fU.scrollTop,ensure:fU.scrollToPos},fU.forceUpdate);if(fZ.display.scroller.offsetHeight){fZ.doc.scrollTop=fZ.display.scroller.scrollTop}}if(!fS&&fU.selectionChanged){br(fZ)}if(!fS&&fU.startHeight!=fZ.doc.height){eB(fZ)}if(fV.wheelStartX!=null&&(fU.scrollTop!=null||fU.scrollLeft!=null||fU.scrollToPos)){fV.wheelStartX=fV.wheelStartY=null}if(fU.scrollTop!=null&&fV.scroller.scrollTop!=fU.scrollTop){var fW=Math.max(0,Math.min(fV.scroller.scrollHeight-fV.scroller.clientHeight,fU.scrollTop));fV.scroller.scrollTop=fV.scrollbarV.scrollTop=fY.scrollTop=fW}if(fU.scrollLeft!=null&&fV.scroller.scrollLeft!=fU.scrollLeft){var fP=Math.max(0,Math.min(fV.scroller.scrollWidth-fV.scroller.clientWidth,fU.scrollLeft));fV.scroller.scrollLeft=fV.scrollbarH.scrollLeft=fY.scrollLeft=fP;ei(fZ)}if(fU.scrollToPos){var fX=E(fZ,fk(fZ.doc,fU.scrollToPos.from),fk(fZ.doc,fU.scrollToPos.to),fU.scrollToPos.margin);if(fU.scrollToPos.isCursor&&fZ.state.focused){dJ(fZ,fX)}}if(fU.selectionChanged){p(fZ)}if(fZ.state.focused&&fU.updateInput){eZ(fZ,fU.typing)}var fT=fU.maybeHiddenMarkers,fO=fU.maybeUnhiddenMarkers;if(fT){for(var fR=0;fR<fT.length;++fR){if(!fT[fR].lines.length){az(fT[fR],"hide")}}}if(fO){for(var fR=0;fR<fO.length;++fR){if(fO[fR].lines.length){az(fO[fR],"unhide")}}}var fQ;if(!--ch){fQ=be;be=null}if(fU.changeObjs){az(fZ,"changes",fZ,fU.changeObjs)}if(fQ){for(var fR=0;fR<fQ.length;++fR){fQ[fR]()}}if(fU.cursorActivityHandlers){for(var fR=0;fR<fU.cursorActivityHandlers.length;fR++){fU.cursorActivityHandlers[fR](fZ)}}}function cz(fO,fP){if(fO.curOp){return fP()}cw(fO);try{return fP()}finally{aj(fO)}}function cL(fO,fP){return function(){if(fO.curOp){return fP.apply(fO,arguments)}cw(fO);try{return fP.apply(fO,arguments)}finally{aj(fO)}}}function cR(fO){return function(){if(this.curOp){return fO.apply(this,arguments)}cw(this);try{return fO.apply(this,arguments)}finally{aj(this)}}}function cs(fO){return function(){var fP=this.cm;if(!fP||fP.curOp){return fO.apply(this,arguments)}cw(fP);try{return fO.apply(this,arguments)}finally{aj(fP)}}}function bl(fQ,fO,fP){this.line=fO;this.rest=i(fO);this.size=this.rest?bC(fi(this.rest))-fP+1:1;this.node=this.text=null;this.hidden=e7(fQ,fO)}function ey(fO,fU,fT){var fS=[],fQ;for(var fR=fU;fR<fT;fR=fQ){var fP=new bl(fO.doc,eP(fO.doc,fR),fR);fQ=fR+fP.size;fS.push(fP)}return fS}function af(fV,fT,fU,fW){if(fT==null){fT=fV.doc.first}if(fU==null){fU=fV.doc.first+fV.doc.size}if(!fW){fW=0}var fQ=fV.display;if(fW&&fU<fQ.viewTo&&(fQ.updateLineNumbers==null||fQ.updateLineNumbers>fT)){fQ.updateLineNumbers=fT}fV.curOp.viewChanged=true;if(fT>=fQ.viewTo){if(aX&&aM(fV.doc,fT)<fQ.viewTo){d9(fV)}}else{if(fU<=fQ.viewFrom){if(aX&&dG(fV.doc,fU+fW)>fQ.viewFrom){d9(fV)}else{fQ.viewFrom+=fW;fQ.viewTo+=fW}}else{if(fT<=fQ.viewFrom&&fU>=fQ.viewTo){d9(fV)}else{if(fT<=fQ.viewFrom){var fS=cX(fV,fU,fU+fW,1);if(fS){fQ.view=fQ.view.slice(fS.index);fQ.viewFrom=fS.lineN;fQ.viewTo+=fW}else{d9(fV)}}else{if(fU>=fQ.viewTo){var fS=cX(fV,fT,fT,-1);if(fS){fQ.view=fQ.view.slice(0,fS.index);fQ.viewTo=fS.lineN}else{d9(fV)}}else{var fR=cX(fV,fT,fT,-1);var fP=cX(fV,fU,fU+fW,1);if(fR&&fP){fQ.view=fQ.view.slice(0,fR.index).concat(ey(fV,fR.lineN,fP.lineN)).concat(fQ.view.slice(fP.index));fQ.viewTo+=fW}else{d9(fV)}}}}}}var fO=fQ.externalMeasured;if(fO){if(fU<fO.lineN){fO.lineN+=fW}else{if(fT<fO.lineN+fO.size){fQ.externalMeasured=null}}}}function R(fP,fQ,fT){fP.curOp.viewChanged=true;var fU=fP.display,fS=fP.display.externalMeasured;if(fS&&fQ>=fS.lineN&&fQ<fS.lineN+fS.size){fU.externalMeasured=null}if(fQ<fU.viewFrom||fQ>=fU.viewTo){return}var fR=fU.view[c7(fP,fQ)];if(fR.node==null){return}var fO=fR.changes||(fR.changes=[]);if(c1(fO,fT)==-1){fO.push(fT)}}function d9(fO){fO.display.viewFrom=fO.display.viewTo=fO.doc.first;fO.display.view=[];fO.display.viewOffset=0}function c7(fO,fR){if(fR>=fO.display.viewTo){return null}fR-=fO.display.viewFrom;if(fR<0){return null}var fP=fO.display.view;for(var fQ=0;fQ<fP.length;fQ++){fR-=fP[fQ].size;if(fR<0){return fQ}}}function cX(fW,fQ,fS,fP){var fT=c7(fW,fQ),fV,fU=fW.display.view;if(!aX||fS==fW.doc.first+fW.doc.size){return{index:fT,lineN:fS}}for(var fR=0,fO=fW.display.viewFrom;fR<fT;fR++){fO+=fU[fR].size}if(fO!=fQ){if(fP>0){if(fT==fU.length-1){return null}fV=(fO+fU[fT].size)-fQ;fT++}else{fV=fO-fQ}fQ+=fV;fS+=fV}while(aM(fW.doc,fS)!=fS){if(fT==(fP<0?0:fU.length-1)){return null}fS+=fP*fU[fT-(fP<0?1:0)].size;fT+=fP}return{index:fT,lineN:fS}}function cD(fO,fS,fR){var fQ=fO.display,fP=fQ.view;if(fP.length==0||fS>=fQ.viewTo||fR<=fQ.viewFrom){fQ.view=ey(fO,fS,fR);fQ.viewFrom=fS}else{if(fQ.viewFrom>fS){fQ.view=ey(fO,fS,fQ.viewFrom).concat(fQ.view)}else{if(fQ.viewFrom<fS){fQ.view=fQ.view.slice(c7(fO,fS))}}fQ.viewFrom=fS;if(fQ.viewTo<fR){fQ.view=fQ.view.concat(ey(fO,fQ.viewTo,fR))}else{if(fQ.viewTo>fR){fQ.view=fQ.view.slice(0,c7(fO,fR))}}}fQ.viewTo=fR}function cU(fO){var fP=fO.display.view,fS=0;for(var fR=0;fR<fP.length;fR++){var fQ=fP[fR];if(!fQ.hidden&&(!fQ.node||fQ.changes)){++fS}}return fS}function bc(fO){if(fO.display.pollingFast){return}fO.display.poll.set(fO.options.pollInterval,function(){b7(fO);if(fO.state.focused){bc(fO)}})}function C(fO){var fP=false;fO.display.pollingFast=true;function fQ(){var fR=b7(fO);if(!fR&&!fP){fP=true;fO.display.poll.set(60,fQ)}else{fO.display.pollingFast=false;bc(fO)}}fO.display.poll.set(20,fQ)}function b7(fS){var fT=fS.display.input,fW=fS.display.prevInput,f7=fS.doc;if(!fS.state.focused||(bi(fT)&&!fW)||ah(fS)||fS.options.disableInput){return false}if(fS.state.pasteIncoming&&fS.state.fakedLastChar){fT.value=fT.value.substring(0,fT.value.length-1);fS.state.fakedLastChar=false}var fV=fT.value;if(fV==fW&&!fS.somethingSelected()){return false}if(dn&&!bY&&fS.display.inputHasSelection===fV){eZ(fS);return false}var f3=!fS.curOp;if(f3){cw(fS)}fS.display.shift=false;if(fV.charCodeAt(0)==8203&&f7.sel==fS.display.selForContextMenu&&!fW){fW="\u200b"}var f2=0,fZ=Math.min(fW.length,fV.length);while(f2<fZ&&fW.charCodeAt(f2)==fV.charCodeAt(f2)){++f2}var fP=fV.slice(f2),fX=aQ(fP);var f6=fS.state.pasteIncoming&&fX.length>1&&f7.sel.ranges.length==fX.length;for(var f4=f7.sel.ranges.length-1;f4>=0;f4--){var fY=f7.sel.ranges[f4];var f0=fY.from(),fO=fY.to();if(f2<fW.length){f0=W(f0.line,f0.ch-(fW.length-f2))}else{if(fS.state.overwrite&&fY.empty()&&!fS.state.pasteIncoming){fO=W(fO.line,Math.min(eP(f7,fO.line).text.length,fO.ch+fi(fX).length))}}var fR=fS.curOp.updateInput;var f5={from:f0,to:fO,text:f6?[fX[f4]]:fX,origin:fS.state.pasteIncoming?"paste":fS.state.cutIncoming?"cut":"+input"};a5(fS.doc,f5);ac(fS,"inputRead",fS,f5);if(fP&&!fS.state.pasteIncoming&&fS.options.electricChars&&fS.options.smartIndent&&fY.head.ch<100&&(!f4||f7.sel.ranges[f4-1].head.line!=fY.head.line)){var fU=fS.getModeAt(fY.head);if(fU.electricChars){for(var f1=0;f1<fU.electricChars.length;f1++){if(fP.indexOf(fU.electricChars.charAt(f1))>-1){ab(fS,fY.head.line,"smart");break}}}else{if(fU.electricInput){var fQ=cG(f5);if(fU.electricInput.test(eP(f7,fQ.line).text.slice(0,fQ.ch))){ab(fS,fY.head.line,"smart")}}}}}fh(fS);fS.curOp.updateInput=fR;fS.curOp.typing=true;if(fV.length>1000||fV.indexOf("\n")>-1){fT.value=fS.display.prevInput=""}else{fS.display.prevInput=fV}if(f3){aj(fS)}fS.state.pasteIncoming=fS.state.cutIncoming=false;return true}function eZ(fO,fS){var fP,fR,fU=fO.doc;if(fO.somethingSelected()){fO.display.prevInput="";var fQ=fU.sel.primary();fP=cT&&(fQ.to().line-fQ.from().line>100||(fR=fO.getSelection()).length>1000);var fT=fP?"-":fR||fO.getSelection();fO.display.input.value=fT;if(fO.state.focused){dq(fO.display.input)}if(dn&&!bY){fO.display.inputHasSelection=fT}}else{if(!fS){fO.display.prevInput=fO.display.input.value="";if(dn&&!bY){fO.display.inputHasSelection=null}}}fO.display.inaccurateSelection=fP}function ed(fO){if(fO.options.readOnly!="nocursor"&&(!dS||ds()!=fO.display.input)){fO.display.input.focus()}}function s(fO){if(!fO.state.focused){ed(fO);cq(fO)}}function ah(fO){return fO.options.readOnly||fO.doc.cantEdit}function fq(fO){var fQ=fO.display;bM(fQ.scroller,"mousedown",cL(fO,d5));if(eo){bM(fQ.scroller,"dblclick",cL(fO,function(fU){if(aI(fO,fU)){return}var fV=cd(fO,fU);if(!fV||m(fO,fU)||a0(fO.display,fU)){return}cu(fU);var fT=ar(fO,fV);fu(fO.doc,fT.anchor,fT.head)}))}else{bM(fQ.scroller,"dblclick",function(fT){aI(fO,fT)||cu(fT)})}bM(fQ.lineSpace,"selectstart",function(fT){if(!a0(fQ,fT)){cu(fT)}});if(!fF){bM(fQ.scroller,"contextmenu",function(fT){av(fO,fT)})}bM(fQ.scroller,"scroll",function(){if(fQ.scroller.clientHeight){N(fO,fQ.scroller.scrollTop);bt(fO,fQ.scroller.scrollLeft,true);az(fO,"scroll",fO)}});bM(fQ.scrollbarV,"scroll",function(){if(fQ.scroller.clientHeight){N(fO,fQ.scrollbarV.scrollTop)}});bM(fQ.scrollbarH,"scroll",function(){if(fQ.scroller.clientHeight){bt(fO,fQ.scrollbarH.scrollLeft)}});bM(fQ.scroller,"mousewheel",function(fT){c(fO,fT)});bM(fQ.scroller,"DOMMouseScroll",function(fT){c(fO,fT)});function fS(){if(fO.state.focused){setTimeout(cl(ed,fO),0)}}bM(fQ.scrollbarH,"mousedown",fS);bM(fQ.scrollbarV,"mousedown",fS);bM(fQ.wrapper,"scroll",function(){fQ.wrapper.scrollTop=fQ.wrapper.scrollLeft=0});bM(fQ.input,"keyup",cL(fO,a7));bM(fQ.input,"input",function(){if(dn&&!bY&&fO.display.inputHasSelection){fO.display.inputHasSelection=null}C(fO)});bM(fQ.input,"keydown",cL(fO,q));bM(fQ.input,"keypress",cL(fO,cn));bM(fQ.input,"focus",cl(cq,fO));bM(fQ.input,"blur",cl(aL,fO));function fP(fT){if(!aI(fO,fT)){d3(fT)}}if(fO.options.dragDrop){bM(fQ.scroller,"dragstart",function(fT){Q(fO,fT)});bM(fQ.scroller,"dragenter",fP);bM(fQ.scroller,"dragover",fP);bM(fQ.scroller,"drop",cL(fO,a9))}bM(fQ.scroller,"paste",function(fT){if(a0(fQ,fT)){return}fO.state.pasteIncoming=true;ed(fO);C(fO)});bM(fQ.input,"paste",function(){if(cJ&&!fO.state.fakedLastChar&&!(new Date-fO.state.lastMiddleDown<200)){var fU=fQ.input.selectionStart,fT=fQ.input.selectionEnd;fQ.input.value+="$";fQ.input.selectionStart=fU;fQ.input.selectionEnd=fT;fO.state.fakedLastChar=true}fO.state.pasteIncoming=true;C(fO)});function fR(fX){if(fO.somethingSelected()){if(fQ.inaccurateSelection){fQ.prevInput="";fQ.inaccurateSelection=false;fQ.input.value=fO.getSelection();dq(fQ.input)}}else{var fY="",fU=[];for(var fV=0;fV<fO.doc.sel.ranges.length;fV++){var fT=fO.doc.sel.ranges[fV].head.line;var fW={anchor:W(fT,0),head:W(fT+1,0)};fU.push(fW);fY+=fO.getRange(fW.anchor,fW.head)}if(fX.type=="cut"){fO.setSelections(fU,null,Y)}else{fQ.prevInput="";fQ.input.value=fY;dq(fQ.input)}}if(fX.type=="cut"){fO.state.cutIncoming=true}}bM(fQ.input,"cut",fR);bM(fQ.input,"copy",fR);if(a1){bM(fQ.sizer,"mouseup",function(){if(ds()==fQ.input){fQ.input.blur()}ed(fO)})}}function aK(fO){var fP=fO.display;fP.cachedCharWidth=fP.cachedTextHeight=fP.cachedPaddingH=null;fO.setSize()}function a0(fP,fO){for(var fQ=L(fO);fQ!=fP.wrapper;fQ=fQ.parentNode){if(!fQ||fQ.ignoreEvents||fQ.parentNode==fP.sizer&&fQ!=fP.mover){return true}}}function cd(fY,fS,fP,fQ){var fU=fY.display;if(!fP){var fT=L(fS);if(fT==fU.scrollbarH||fT==fU.scrollbarV||fT==fU.scrollbarFiller||fT==fU.gutterFiller){return null}}var fX,fV,fO=fU.lineSpace.getBoundingClientRect();try{fX=fS.clientX-fO.left;fV=fS.clientY-fO.top}catch(fS){return null}var fW=fp(fY,fX,fV),fZ;if(fQ&&fW.xRel==1&&(fZ=eP(fY.doc,fW.line).text).length==fW.ch){var fR=bI(fZ,fZ.length,fY.options.tabSize)-fZ.length;fW=W(fW.line,Math.max(0,Math.round((fX-eG(fY.display).left)/di(fY.display))-fR))}return fW}function d5(fQ){if(aI(this,fQ)){return}var fO=this,fP=fO.display;fP.shift=fQ.shiftKey;if(a0(fP,fQ)){if(!cJ){fP.scroller.draggable=false;setTimeout(function(){fP.scroller.draggable=true},100)}return}if(m(fO,fQ)){return}var fR=cd(fO,fQ);window.focus();switch(fo(fQ)){case 1:if(fR){au(fO,fQ,fR)}else{if(L(fQ)==fP.scroller){cu(fQ)}}break;case 2:if(cJ){fO.state.lastMiddleDown=+new Date}if(fR){fu(fO.doc,fR)}setTimeout(cl(ed,fO),20);cu(fQ);break;case 3:if(fF){av(fO,fQ)}break}}var c4,cW;function au(fP,fT,fU){setTimeout(cl(s,fP),0);var fQ=+new Date,fR;if(cW&&cW.time>fQ-400&&b5(cW.pos,fU)==0){fR="triple"}else{if(c4&&c4.time>fQ-400&&b5(c4.pos,fU)==0){fR="double";cW={time:fQ,pos:fU}}else{fR="single";c4={time:fQ,pos:fU}}}var fS=fP.doc.sel,fO=bU?fT.metaKey:fT.ctrlKey;if(fP.options.dragDrop&&ep&&!ah(fP)&&fR=="single"&&fS.contains(fU)>-1&&fS.somethingSelected()){aT(fP,fT,fU,fO)}else{n(fP,fT,fU,fR,fO)}}function aT(fQ,fS,fT,fP){var fR=fQ.display;var fO=cL(fQ,function(fU){if(cJ){fR.scroller.draggable=false}fQ.state.draggingText=false;dP(document,"mouseup",fO);dP(fR.scroller,"drop",fO);if(Math.abs(fS.clientX-fU.clientX)+Math.abs(fS.clientY-fU.clientY)<10){cu(fU);if(!fP){fu(fQ.doc,fT)}ed(fQ);if(eo&&!bY){setTimeout(function(){document.body.focus();ed(fQ)},20)}}});if(cJ){fR.scroller.draggable=true}fQ.state.draggingText=fO;if(fR.scroller.dragDrop){fR.scroller.dragDrop()}bM(document,"mouseup",fO);bM(fR.scroller,"drop",fO)}function n(fR,f5,fQ,fO,fT){var f2=fR.display,f7=fR.doc;cu(f5);var fP,f6,fS=f7.sel;if(fT&&!f5.shiftKey){f6=f7.sel.contains(fQ);if(f6>-1){fP=f7.sel.ranges[f6]}else{fP=new dB(fQ,fQ)}}else{fP=f7.sel.primary()}if(f5.altKey){fO="rect";if(!fT){fP=new dB(fQ,fQ)}fQ=cd(fR,f5,true,true);f6=-1}else{if(fO=="double"){var f3=ar(fR,fQ);if(fR.display.shift||f7.extend){fP=e6(f7,fP,f3.anchor,f3.head)}else{fP=f3}}else{if(fO=="triple"){var fW=new dB(W(fQ.line,0),fk(f7,W(fQ.line+1,0)));if(fR.display.shift||f7.extend){fP=e6(f7,fP,fW.anchor,fW.head)}else{fP=fW}}else{fP=e6(f7,fP,fQ)}}}if(!fT){f6=0;bJ(f7,new fy([fP],0),M);fS=f7.sel}else{if(f6>-1){f(f7,f6,fP,M)}else{f6=f7.sel.ranges.length;bJ(f7,cm(f7.sel.ranges.concat([fP]),f6),{scroll:false,origin:"*mouse"})}}var f1=fQ;function f0(gi){if(b5(f1,gi)==0){return}f1=gi;if(fO=="rect"){var f9=[],gf=fR.options.tabSize;var f8=bI(eP(f7,fQ.line).text,fQ.ch,gf);var gl=bI(eP(f7,gi.line).text,gi.ch,gf);var ga=Math.min(f8,gl),gj=Math.max(f8,gl);for(var gm=Math.min(fQ.line,gi.line),gc=Math.min(fR.lastLine(),Math.max(fQ.line,gi.line));gm<=gc;gm++){var gk=eP(f7,gm).text,gb=d2(gk,ga,gf);if(ga==gj){f9.push(new dB(W(gm,gb),W(gm,gb)))}else{if(gk.length>gb){f9.push(new dB(W(gm,gb),W(gm,d2(gk,gj,gf))))}}}if(!f9.length){f9.push(new dB(fQ,fQ))}bJ(f7,cm(fS.ranges.slice(0,f6).concat(f9),f6),{origin:"*mouse",scroll:false});fR.scrollIntoView(gi)}else{var gg=fP;var gd=gg.anchor,gh=gi;if(fO!="single"){if(fO=="double"){var ge=ar(fR,gi)}else{var ge=new dB(W(gi.line,0),fk(f7,W(gi.line+1,0)))}if(b5(ge.anchor,gd)>0){gh=ge.head;gd=am(gg.from(),ge.anchor)}else{gh=ge.anchor;gd=bn(gg.to(),ge.head)}}var f9=fS.ranges.slice(0);f9[f6]=new dB(fk(f7,gd),gh);bJ(f7,cm(f9,f6),M)}}var fY=f2.wrapper.getBoundingClientRect();var fU=0;function f4(ga){var f8=++fU;var gc=cd(fR,ga,true,fO=="rect");if(!gc){return}if(b5(gc,f1)!=0){s(fR);f0(gc);var gb=bT(f2,f7);if(gc.line>=gb.to||gc.line<gb.from){setTimeout(cL(fR,function(){if(fU==f8){f4(ga)}}),150)}}else{var f9=ga.clientY<fY.top?-20:ga.clientY>fY.bottom?20:0;if(f9){setTimeout(cL(fR,function(){if(fU!=f8){return}f2.scroller.scrollTop+=f9;f4(ga)}),50)}}}function fX(f8){fU=Infinity;cu(f8);ed(fR);dP(document,"mousemove",fZ);dP(document,"mouseup",fV);f7.history.lastSelOrigin=null}var fZ=cL(fR,function(f8){if((dn&&!bX)?!f8.buttons:!fo(f8)){fX(f8)}else{f4(f8)}});var fV=cL(fR,fX);bM(document,"mousemove",fZ);bM(document,"mouseup",fV)}function fM(fZ,fV,fX,fY,fR){try{var fP=fV.clientX,fO=fV.clientY}catch(fV){return false}if(fP>=Math.floor(fZ.display.gutters.getBoundingClientRect().right)){return false}if(fY){cu(fV)}var fW=fZ.display;var fU=fW.lineDiv.getBoundingClientRect();if(fO>fU.bottom||!eS(fZ,fX)){return bA(fV)}fO-=fU.top-fW.viewOffset;for(var fS=0;fS<fZ.options.gutters.length;++fS){var fT=fW.gutters.childNodes[fS];if(fT&&fT.getBoundingClientRect().right>=fP){var f0=bv(fZ.doc,fO);var fQ=fZ.options.gutters[fS];fR(fZ,fX,fZ,f0,fQ,fV);return bA(fV)}}}function m(fO,fP){return fM(fO,fP,"gutterClick",true,ac)}var ae=0;function a9(fU){var fW=this;if(aI(fW,fU)||a0(fW.display,fU)){return}cu(fU);if(dn){ae=+new Date}var fV=cd(fW,fU,true),fO=fU.dataTransfer.files;if(!fV||ah(fW)){return}if(fO&&fO.length&&window.FileReader&&window.File){var fQ=fO.length,fX=Array(fQ),fP=0;var fS=function(f0,fZ){var fY=new FileReader;fY.onload=cL(fW,function(){fX[fZ]=fY.result;if(++fP==fQ){fV=fk(fW.doc,fV);var f1={from:fV,to:fV,text:aQ(fX.join("\n")),origin:"paste"};a5(fW.doc,f1);eH(fW.doc,eu(fV,cG(f1)))}});fY.readAsText(f0)};for(var fT=0;fT<fQ;++fT){fS(fO[fT],fT)}}else{if(fW.state.draggingText&&fW.doc.sel.contains(fV)>-1){fW.state.draggingText(fU);setTimeout(cl(ed,fW),20);return}try{var fX=fU.dataTransfer.getData("Text");if(fX){if(fW.state.draggingText&&!(bU?fU.metaKey:fU.ctrlKey)){var fR=fW.listSelections()}d1(fW.doc,eu(fV,fV));if(fR){for(var fT=0;fT<fR.length;++fT){aR(fW.doc,"",fR[fT].anchor,fR[fT].head,"drag")}}fW.replaceSelection(fX,"around","paste");ed(fW)}}catch(fU){}}}function Q(fO,fQ){if(dn&&(!fO.state.draggingText||+new Date-ae<100)){d3(fQ);return}if(aI(fO,fQ)||a0(fO.display,fQ)){return}fQ.dataTransfer.setData("Text",fO.getSelection());if(fQ.dataTransfer.setDragImage&&!ay){var fP=fx("img",null,null,"position: fixed; left: 0; top: 0;");fP.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(dF){fP.width=fP.height=1;fO.display.wrapper.appendChild(fP);fP._top=fP.offsetTop}fQ.dataTransfer.setDragImage(fP,0,0);if(dF){fP.parentNode.removeChild(fP)}}}function N(fO,fP){if(Math.abs(fO.doc.scrollTop-fP)<2){return}fO.doc.scrollTop=fP;if(!ce){dp(fO,{top:fP})}if(fO.display.scroller.scrollTop!=fP){fO.display.scroller.scrollTop=fP}if(fO.display.scrollbarV.scrollTop!=fP){fO.display.scrollbarV.scrollTop=fP}if(ce){dp(fO)}dR(fO,100)}function bt(fO,fQ,fP){if(fP?fQ==fO.doc.scrollLeft:Math.abs(fO.doc.scrollLeft-fQ)<2){return}fQ=Math.min(fQ,fO.display.scroller.scrollWidth-fO.display.scroller.clientWidth);fO.doc.scrollLeft=fQ;ei(fO);if(fO.display.scroller.scrollLeft!=fQ){fO.display.scroller.scrollLeft=fQ}if(fO.display.scrollbarH.scrollLeft!=fQ){fO.display.scrollbarH.scrollLeft=fQ}}var eW=0,b6=null;if(dn){b6=-0.53}else{if(ce){b6=15}else{if(cV){b6=-0.7}else{if(ay){b6=-1/3}}}}function c(fW,fQ){var fZ=fQ.wheelDeltaX,fY=fQ.wheelDeltaY;if(fZ==null&&fQ.detail&&fQ.axis==fQ.HORIZONTAL_AXIS){fZ=fQ.detail}if(fY==null&&fQ.detail&&fQ.axis==fQ.VERTICAL_AXIS){fY=fQ.detail}else{if(fY==null){fY=fQ.wheelDelta}}var fS=fW.display,fV=fS.scroller;if(!(fZ&&fV.scrollWidth>fV.clientWidth||fY&&fV.scrollHeight>fV.clientHeight)){return}if(fY&&bU&&cJ){outer:for(var fX=fQ.target,fU=fS.view;fX!=fV;fX=fX.parentNode){for(var fP=0;fP<fU.length;fP++){if(fU[fP].node==fX){fW.display.currentWheelTarget=fX;break outer}}}}if(fZ&&!ce&&!dF&&b6!=null){if(fY){N(fW,Math.max(0,Math.min(fV.scrollTop+fY*b6,fV.scrollHeight-fV.clientHeight)))}bt(fW,Math.max(0,Math.min(fV.scrollLeft+fZ*b6,fV.scrollWidth-fV.clientWidth)));cu(fQ);fS.wheelStartX=null;return}if(fY&&b6!=null){var fO=fY*b6;var fT=fW.doc.scrollTop,fR=fT+fS.wrapper.clientHeight;if(fO<0){fT=Math.max(0,fT+fO-50)}else{fR=Math.min(fW.doc.height,fR+fO+50)}dp(fW,{top:fT,bottom:fR})}if(eW<20){if(fS.wheelStartX==null){fS.wheelStartX=fV.scrollLeft;fS.wheelStartY=fV.scrollTop;fS.wheelDX=fZ;fS.wheelDY=fY;setTimeout(function(){if(fS.wheelStartX==null){return}var f0=fV.scrollLeft-fS.wheelStartX;var f2=fV.scrollTop-fS.wheelStartY;var f1=(f2&&fS.wheelDY&&f2/fS.wheelDY)||(f0&&fS.wheelDX&&f0/fS.wheelDX);fS.wheelStartX=fS.wheelStartY=null;if(!f1){return}b6=(b6*eW+f1)/(eW+1);++eW},200)}else{fS.wheelDX+=fZ;fS.wheelDY+=fY}}}function fr(fP,fS,fO){if(typeof fS=="string"){fS=eh[fS];if(!fS){return false}}if(fP.display.pollingFast&&b7(fP)){fP.display.pollingFast=false}var fR=fP.display.shift,fQ=false;try{if(ah(fP)){fP.state.suppressEdits=true}if(fO){fP.display.shift=false}fQ=fS(fP)!=bZ}finally{fP.display.shift=fR;fP.state.suppressEdits=false}return fQ}function c9(fO){var fP=fO.state.keyMaps.slice(0);if(fO.options.extraKeys){fP.push(fO.options.extraKeys)}fP.push(fO.options.keyMap);return fP}var an;function eT(fO,fU){var fP=fv(fO.options.keyMap),fS=fP.auto;clearTimeout(an);if(fS&&!eg(fU)){an=setTimeout(function(){if(fv(fO.options.keyMap)==fP){fO.options.keyMap=(fS.call?fS.call(null,fO):fS);fL(fO)}},50)}var fR=e2(fU,true),fT=false;if(!fR){return false}var fQ=c9(fO);if(fU.shiftKey){fT=j("Shift-"+fR,fQ,function(fV){return fr(fO,fV,true)})||j(fR,fQ,function(fV){if(typeof fV=="string"?/^go[A-Z]/.test(fV):fV.motion){return fr(fO,fV)}})}else{fT=j(fR,fQ,function(fV){return fr(fO,fV)})}if(fT){cu(fU);p(fO);ac(fO,"keyHandled",fO,fR,fU)}return fT}function dV(fO,fR,fP){var fQ=j("'"+fP+"'",c9(fO),function(fS){return fr(fO,fS,true)});if(fQ){cu(fR);p(fO);ac(fO,"keyHandled",fO,"'"+fP+"'",fR)}return fQ}var c3=null;function q(fR){var fO=this;s(fO);if(aI(fO,fR)){return}if(eo&&fR.keyCode==27){fR.returnValue=false}var fP=fR.keyCode;fO.display.shift=fP==16||fR.shiftKey;var fQ=eT(fO,fR);if(dF){c3=fQ?fP:null;if(!fQ&&fP==88&&!cT&&(bU?fR.metaKey:fR.ctrlKey)){fO.replaceSelection("",null,"cut")}}if(fP==18&&!/\bCodeMirror-crosshair\b/.test(fO.display.lineDiv.className)){aq(fO)}}function aq(fP){var fQ=fP.display.lineDiv;fb(fQ,"CodeMirror-crosshair");function fO(fR){if(fR.keyCode==18||!fR.altKey){g(fQ,"CodeMirror-crosshair");dP(document,"keyup",fO);dP(document,"mouseover",fO)}}bM(document,"keyup",fO);bM(document,"mouseover",fO)}function a7(fO){if(aI(this,fO)){return}if(fO.keyCode==16){this.doc.sel.shift=false}}function cn(fS){var fO=this;if(aI(fO,fS)){return}var fR=fS.keyCode,fP=fS.charCode;if(dF&&fR==c3){c3=null;cu(fS);return}if(((dF&&(!fS.which||fS.which<10))||a1)&&eT(fO,fS)){return}var fQ=String.fromCharCode(fP==null?fR:fP);if(dV(fO,fS,fQ)){return}if(dn&&!bY){fO.display.inputHasSelection=null}C(fO)}function cq(fO){if(fO.options.readOnly=="nocursor"){return}if(!fO.state.focused){az(fO,"focus",fO);fO.state.focused=true;fb(fO.display.wrapper,"CodeMirror-focused");if(!fO.curOp&&fO.display.selForContextMenu!=fO.doc.sel){eZ(fO);if(cJ){setTimeout(cl(eZ,fO,true),0)}}}bc(fO);p(fO)}function aL(fO){if(fO.state.focused){az(fO,"blur",fO);fO.state.focused=false;g(fO.display.wrapper,"CodeMirror-focused")}clearInterval(fO.display.blinker);setTimeout(function(){if(!fO.state.focused){fO.display.shift=false}},150)}function av(fX,fS){if(aI(fX,fS,"contextmenu")){return}var fU=fX.display;if(a0(fU,fS)||c0(fX,fS)){return}var fW=cd(fX,fS),fO=fU.scroller.scrollTop;if(!fW||dF){return}var fQ=fX.options.resetSelectionOnContextMenu;if(fQ&&fX.doc.sel.contains(fW)==-1){cL(fX,bJ)(fX.doc,eu(fW),Y)}var fT=fU.input.style.cssText;fU.inputDiv.style.position="absolute";fU.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(fS.clientY-5)+"px; left: "+(fS.clientX-5)+"px; z-index: 1000; background: "+(dn?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";ed(fX);eZ(fX);if(!fX.somethingSelected()){fU.input.value=fU.prevInput=" "}fU.selForContextMenu=fX.doc.sel;clearTimeout(fU.detectingSelectAll);function fR(){if(fU.input.selectionStart!=null){var fY=fX.somethingSelected();var fZ=fU.input.value="\u200b"+(fY?fU.input.value:"");fU.prevInput=fY?"":"\u200b";fU.input.selectionStart=1;fU.input.selectionEnd=fZ.length;fU.selForContextMenu=fX.doc.sel}}function fV(){fU.inputDiv.style.position="relative";fU.input.style.cssText=fT;if(bY){fU.scrollbarV.scrollTop=fU.scroller.scrollTop=fO}bc(fX);if(fU.input.selectionStart!=null){if(!dn||bY){fR()}var fY=0,fZ=function(){if(fU.selForContextMenu==fX.doc.sel&&fU.input.selectionStart==0){cL(fX,eh.selectAll)(fX)}else{if(fY++<10){fU.detectingSelectAll=setTimeout(fZ,500)}else{eZ(fX)}}};fU.detectingSelectAll=setTimeout(fZ,200)}}if(dn&&!bY){fR()}if(fF){d3(fS);var fP=function(){dP(window,"mouseup",fP);setTimeout(fV,20)};bM(window,"mouseup",fP)}else{setTimeout(fV,50)}}function c0(fO,fP){if(!eS(fO,"gutterContextMenu")){return false}return fM(fO,fP,"gutterContextMenu",false,az)}var cG=I.changeEnd=function(fO){if(!fO.text){return fO.to}return W(fO.from.line+fO.text.length-1,fi(fO.text).length+(fO.text.length==1?fO.from.ch:0))};function bO(fR,fQ){if(b5(fR,fQ.from)<0){return fR}if(b5(fR,fQ.to)<=0){return cG(fQ)}var fO=fR.line+fQ.text.length-(fQ.to.line-fQ.from.line)-1,fP=fR.ch;if(fR.line==fQ.to.line){fP+=cG(fQ).ch-fQ.to.ch}return W(fO,fP)}function eU(fR,fS){var fP=[];for(var fQ=0;fQ<fR.sel.ranges.length;fQ++){var fO=fR.sel.ranges[fQ];fP.push(new dB(bO(fO.anchor,fS),bO(fO.head,fS)))}return cm(fP,fR.sel.primIndex)}function bk(fQ,fP,fO){if(fQ.line==fP.line){return W(fO.line,fQ.ch-fP.ch+fO.ch)}else{return W(fO.line+(fQ.line-fP.line),fQ.ch)}}function ad(fY,fV,fP){var fQ=[];var fO=W(fY.first,0),fZ=fO;for(var fS=0;fS<fV.length;fS++){var fU=fV[fS];var fX=bk(fU.from,fO,fZ);var fW=bk(cG(fU),fO,fZ);fO=fU.to;fZ=fW;if(fP=="around"){var fT=fY.sel.ranges[fS],fR=b5(fT.head,fT.anchor)<0;fQ[fS]=new dB(fR?fW:fX,fR?fX:fW)}else{fQ[fS]=new dB(fX,fX)}}return new fy(fQ,fY.sel.primIndex)}function dv(fP,fR,fQ){var fO={canceled:false,from:fR.from,to:fR.to,text:fR.text,origin:fR.origin,cancel:function(){this.canceled=true}};if(fQ){fO.update=function(fV,fU,fT,fS){if(fV){this.from=fk(fP,fV)}if(fU){this.to=fk(fP,fU)}if(fT){this.text=fT}if(fS!==undefined){this.origin=fS}}}az(fP,"beforeChange",fP,fO);if(fP.cm){az(fP.cm,"beforeChange",fP.cm,fO)}if(fO.canceled){return null}return{from:fO.from,to:fO.to,text:fO.text,origin:fO.origin}}function a5(fR,fS,fQ){if(fR.cm){if(!fR.cm.curOp){return cL(fR.cm,a5)(fR,fS,fQ)}if(fR.cm.state.suppressEdits){return}}if(eS(fR,"beforeChange")||fR.cm&&eS(fR.cm,"beforeChange")){fS=dv(fR,fS,true);if(!fS){return}}var fP=fI&&!fQ&&cv(fR,fS.from,fS.to);if(fP){for(var fO=fP.length-1;fO>=0;--fO){K(fR,{from:fP[fO].from,to:fP[fO].to,text:fO?[""]:fS.text})}}else{K(fR,fS)}}function K(fQ,fR){if(fR.text.length==1&&fR.text[0]==""&&b5(fR.from,fR.to)==0){return}var fP=eU(fQ,fR);fn(fQ,fR,fP,fQ.cm?fQ.cm.curOp.id:NaN);dQ(fQ,fR,fP,dW(fQ,fR));var fO=[];dK(fQ,function(fT,fS){if(!fS&&c1(fO,fT.history)==-1){dj(fT.history,fR);fO.push(fT.history)}dQ(fT,fR,null,dW(fT,fR))})}function bV(fZ,fX,f1){if(fZ.cm&&fZ.cm.state.suppressEdits){return}var fW=fZ.history,fQ,fS=fZ.sel;var fO=fX=="undo"?fW.done:fW.undone,f0=fX=="undo"?fW.undone:fW.done;for(var fT=0;fT<fO.length;fT++){fQ=fO[fT];if(f1?fQ.ranges&&!fQ.equals(fZ.sel):!fQ.ranges){break}}if(fT==fO.length){return}fW.lastOrigin=fW.lastSelOrigin=null;for(;;){fQ=fO.pop();if(fQ.ranges){cA(fQ,f0);if(f1&&!fQ.equals(fZ.sel)){bJ(fZ,fQ,{clearRedo:false});return}fS=fQ}else{break}}var fV=[];cA(fS,f0);f0.push({changes:fV,generation:fW.generation});fW.generation=fQ.generation||++fW.maxGeneration;var fR=eS(fZ,"beforeChange")||fZ.cm&&eS(fZ.cm,"beforeChange");for(var fT=fQ.changes.length-1;fT>=0;--fT){var fY=fQ.changes[fT];fY.origin=fX;if(fR&&!dv(fZ,fY,false)){fO.length=0;return}fV.push(da(fZ,fY));var fP=fT?eU(fZ,fY,null):fi(fO);dQ(fZ,fY,fP,dM(fZ,fY));if(!fT&&fZ.cm){fZ.cm.scrollIntoView(fY)}var fU=[];dK(fZ,function(f3,f2){if(!f2&&c1(fU,f3.history)==-1){dj(f3.history,fY);fU.push(f3.history)}dQ(f3,fY,null,dM(f3,fY))})}}function eX(fP,fR){if(fR==0){return}fP.first+=fR;fP.sel=new fy(bH(fP.sel.ranges,function(fS){return new dB(W(fS.anchor.line+fR,fS.anchor.ch),W(fS.head.line+fR,fS.head.ch))}),fP.sel.primIndex);if(fP.cm){af(fP.cm,fP.first,fP.first-fR,fR);for(var fQ=fP.cm.display,fO=fQ.viewFrom;fO<fQ.viewTo;fO++){R(fP.cm,fO,"gutter")}}}function dQ(fS,fT,fR,fP){if(fS.cm&&!fS.cm.curOp){return cL(fS.cm,dQ)(fS,fT,fR,fP)}if(fT.to.line<fS.first){eX(fS,fT.text.length-1-(fT.to.line-fT.from.line));return}if(fT.from.line>fS.lastLine()){return}if(fT.from.line<fS.first){var fO=fT.text.length-1-(fS.first-fT.from.line);eX(fS,fO);fT={from:W(fS.first,0),to:W(fT.to.line+fO,fT.to.ch),text:[fi(fT.text)],origin:fT.origin}}var fQ=fS.lastLine();if(fT.to.line>fQ){fT={from:fT.from,to:W(fQ,eP(fS,fQ).text.length),text:[fT.text[0]],origin:fT.origin}}fT.removed=fz(fS,fT.from,fT.to);if(!fR){fR=eU(fS,fT,null)}if(fS.cm){aD(fS.cm,fT,fP)}else{e9(fS,fT,fP)}d1(fS,fR,Y)}function aD(fZ,fV,fT){var fY=fZ.doc,fU=fZ.display,fW=fV.from,fX=fV.to;var fO=false,fS=fW.line;if(!fZ.options.lineWrapping){fS=bC(z(eP(fY,fW.line)));fY.iter(fS,fX.line+1,function(f1){if(f1==fU.maxLine){fO=true;return true}})}if(fY.sel.contains(fV.from,fV.to)>-1){V(fZ)}e9(fY,fV,fT,a3(fZ));if(!fZ.options.lineWrapping){fY.iter(fS,fW.line+fV.text.length,function(f2){var f1=dY(f2);if(f1>fU.maxLineLength){fU.maxLine=f2;fU.maxLineLength=f1;fU.maxLineChanged=true;fO=false}});if(fO){fZ.curOp.updateMaxLine=true}}fY.frontier=Math.min(fY.frontier,fW.line);dR(fZ,400);var f0=fV.text.length-(fX.line-fW.line)-1;if(fW.line==fX.line&&fV.text.length==1&&!dw(fZ.doc,fV)){R(fZ,fW.line,"text")}else{af(fZ,fW.line,fX.line+1,f0)}var fQ=eS(fZ,"changes"),fR=eS(fZ,"change");if(fR||fQ){var fP={from:fW,to:fX,text:fV.text,removed:fV.removed,origin:fV.origin};if(fR){ac(fZ,"change",fZ,fP)}if(fQ){(fZ.curOp.changeObjs||(fZ.curOp.changeObjs=[])).push(fP)}}fZ.display.selForContextMenu=null}function aR(fR,fQ,fT,fS,fO){if(!fS){fS=fT}if(b5(fS,fT)<0){var fP=fS;fS=fT;fT=fP}if(typeof fQ=="string"){fQ=aQ(fQ)}a5(fR,{from:fT,to:fS,text:fQ,origin:fO})}function dJ(fP,fS){var fT=fP.display,fQ=fT.sizer.getBoundingClientRect(),fO=null;if(fS.top+fQ.top<0){fO=true}else{if(fS.bottom+fQ.top>(window.innerHeight||document.documentElement.clientHeight)){fO=false}}if(fO!=null&&!e5){var fR=fx("div","\u200b",null,"position: absolute; top: "+(fS.top-fT.viewOffset-eI(fP.display))+"px; height: "+(fS.bottom-fS.top+ba)+"px; left: "+fS.left+"px; width: 2px;");fP.display.lineSpace.appendChild(fR);fR.scrollIntoView(fO);fP.display.lineSpace.removeChild(fR)}}function E(fX,fV,fS,fR){if(fR==null){fR=0}for(;;){var fT=false,fW=dx(fX,fV);var fO=!fS||fS==fV?fW:dx(fX,fS);var fQ=H(fX,Math.min(fW.left,fO.left),Math.min(fW.top,fO.top)-fR,Math.max(fW.left,fO.left),Math.max(fW.bottom,fO.bottom)+fR);var fU=fX.doc.scrollTop,fP=fX.doc.scrollLeft;if(fQ.scrollTop!=null){N(fX,fQ.scrollTop);if(Math.abs(fX.doc.scrollTop-fU)>1){fT=true}}if(fQ.scrollLeft!=null){bt(fX,fQ.scrollLeft);if(Math.abs(fX.doc.scrollLeft-fP)>1){fT=true}}if(!fT){return fW}}}function F(fO,fQ,fS,fP,fR){var fT=H(fO,fQ,fS,fP,fR);if(fT.scrollTop!=null){N(fO,fT.scrollTop)}if(fT.scrollLeft!=null){bt(fO,fT.scrollLeft)}}function H(fU,f2,fR,f1,fQ){var fZ=fU.display,fY=aN(fU.display);if(fR<0){fR=0}var fX=fU.curOp&&fU.curOp.scrollTop!=null?fU.curOp.scrollTop:fZ.scroller.scrollTop;var fP=fZ.scroller.clientHeight-ba,fW={};var f4=fU.doc.height+bx(fZ);var f5=fR<fY,f0=fQ>f4-fY;if(fR<fX){fW.scrollTop=f5?0:fR}else{if(fQ>fX+fP){var fV=Math.min(fR,(f0?f4:fQ)-fP);if(fV!=fX){fW.scrollTop=fV}}}var fO=fU.curOp&&fU.curOp.scrollLeft!=null?fU.curOp.scrollLeft:fZ.scroller.scrollLeft;var fT=fZ.scroller.clientWidth-ba;f2+=fZ.gutters.offsetWidth;f1+=fZ.gutters.offsetWidth;var fS=fZ.gutters.offsetWidth;var f3=f2<fS+10;if(f2<fO+fS||f3){if(f3){f2=0}fW.scrollLeft=Math.max(0,f2-10-fS)}else{if(f1>fT+fO-3){fW.scrollLeft=f1+10-fT}}return fW}function cy(fO,fQ,fP){if(fQ!=null||fP!=null){fd(fO)}if(fQ!=null){fO.curOp.scrollLeft=(fO.curOp.scrollLeft==null?fO.doc.scrollLeft:fO.curOp.scrollLeft)+fQ}if(fP!=null){fO.curOp.scrollTop=(fO.curOp.scrollTop==null?fO.doc.scrollTop:fO.curOp.scrollTop)+fP}}function fh(fO){fd(fO);var fP=fO.getCursor(),fR=fP,fQ=fP;if(!fO.options.lineWrapping){fR=fP.ch?W(fP.line,fP.ch-1):fP;fQ=W(fP.line,fP.ch+1)}fO.curOp.scrollToPos={from:fR,to:fQ,margin:fO.options.cursorScrollMargin,isCursor:true}}function fd(fO){var fQ=fO.curOp.scrollToPos;if(fQ){fO.curOp.scrollToPos=null;var fS=dm(fO,fQ.from),fR=dm(fO,fQ.to);var fP=H(fO,Math.min(fS.left,fR.left),Math.min(fS.top,fR.top)-fQ.margin,Math.max(fS.right,fR.right),Math.max(fS.bottom,fR.bottom)+fQ.margin);fO.scrollTo(fP.scrollLeft,fP.scrollTop)}}function ab(f1,fR,f0,fQ){var fZ=f1.doc,fP;if(f0==null){f0="add"}if(f0=="smart"){if(!f1.doc.mode.indent){f0="prev"}else{fP=dg(f1,fR)}}var fV=f1.options.tabSize;var f2=eP(fZ,fR),fU=bI(f2.text,null,fV);if(f2.stateAfter){f2.stateAfter=null}var fO=f2.text.match(/^\s*/)[0],fX;if(!fQ&&!/\S/.test(f2.text)){fX=0;f0="not"}else{if(f0=="smart"){fX=f1.doc.mode.indent(fP,f2.text.slice(fO.length),f2.text);if(fX==bZ){if(!fQ){return}f0="prev"}}}if(f0=="prev"){if(fR>fZ.first){fX=bI(eP(fZ,fR-1).text,null,fV)}else{fX=0}}else{if(f0=="add"){fX=fU+f1.options.indentUnit}else{if(f0=="subtract"){fX=fU-f1.options.indentUnit}else{if(typeof f0=="number"){fX=fU+f0}}}}fX=Math.max(0,fX);var fY="",fW=0;if(f1.options.indentWithTabs){for(var fS=Math.floor(fX/fV);fS;--fS){fW+=fV;fY+="\t"}}if(fW<fX){fY+=cf(fX-fW)}if(fY!=fO){aR(f1.doc,fY,W(fR,0),W(fR,fO.length),"+input")}else{for(var fS=0;fS<fZ.sel.ranges.length;fS++){var fT=fZ.sel.ranges[fS];if(fT.head.line==fR&&fT.head.ch<fO.length){var fW=W(fR,fO.length);f(fZ,fS,new dB(fW,fW));break}}}f2.stateAfter=null}function eb(fP,fR,fO,fU){var fT=fR,fQ=fR,fS=fP.doc;if(typeof fR=="number"){fQ=eP(fS,cO(fS,fR))}else{fT=bC(fR)}if(fT==null){return null}if(fU(fQ,fT)){R(fP,fT,fO)}return fQ}function eA(fO,fU){var fP=fO.doc.sel.ranges,fS=[];for(var fR=0;fR<fP.length;fR++){var fQ=fU(fP[fR]);while(fS.length&&b5(fQ.from,fi(fS).to)<=0){var fT=fS.pop();if(b5(fT.from,fQ.from)<0){fQ.from=fT.from;break}}fS.push(fQ)}cz(fO,function(){for(var fV=fS.length-1;fV>=0;fV--){aR(fO.doc,"",fS[fV].from,fS[fV].to,"+delete")}fh(fO)})}function bm(f6,fS,f0,fZ,fU){var fX=fS.line,fY=fS.ch,f5=f0;var fP=eP(f6,fX);var f3=true;function f4(){var f7=fX+f0;if(f7<f6.first||f7>=f6.first+f6.size){return(f3=false)}fX=f7;return fP=eP(f6,f7)}function f2(f8){var f7=(fU?v:ag)(fP,fY,f0,true);if(f7==null){if(!f8&&f4()){if(fU){fY=(f0<0?cE:ct)(fP)}else{fY=f0<0?fP.text.length:0}}else{return(f3=false)}}else{fY=f7}return true}if(fZ=="char"){f2()}else{if(fZ=="column"){f2(true)}else{if(fZ=="word"||fZ=="group"){var f1=null,fV=fZ=="group";var fO=f6.cm&&f6.cm.getHelper(fS,"wordChars");for(var fT=true;;fT=false){if(f0<0&&!f2(!fT)){break}var fQ=fP.text.charAt(fY)||"\n";var fR=cp(fQ,fO)?"w":fV&&fQ=="\n"?"n":!fV||/\s/.test(fQ)?null:"p";if(fV&&!fT&&!fR){fR="s"}if(f1&&f1!=fR){if(f0<0){f0=1;f2()}break}if(fR){f1=fR}if(f0>0&&!f2(!fT)){break}}}}}var fW=bK(f6,W(fX,fY),f5,true);if(!f3){fW.hitSide=true}return fW}function bg(fW,fR,fO,fV){var fU=fW.doc,fT=fR.left,fS;if(fV=="page"){var fQ=Math.min(fW.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);fS=fR.top+fO*(fQ-(fO<0?1.5:0.5)*aN(fW.display))}else{if(fV=="line"){fS=fO>0?fR.bottom+3:fR.top-3}}for(;;){var fP=fp(fW,fT,fS);if(!fP.outside){break}if(fO<0?fS<=0:fS>=fU.height){fP.hitSide=true;break}fS+=fO*5}return fP}function ar(fU,fS){var fT=fU.doc,fV=eP(fT,fS.line).text;var fP=fS.ch,fR=fS.ch;if(fV){var fQ=fU.getHelper(fS,"wordChars");if((fS.xRel<0||fR==fV.length)&&fP){--fP}else{++fR}var fW=fV.charAt(fP);var fO=cp(fW,fQ)?function(fX){return cp(fX,fQ)}:/\s/.test(fW)?function(fX){return/\s/.test(fX)}:function(fX){return !/\s/.test(fX)&&!cp(fX)};while(fP>0&&fO(fV.charAt(fP-1))){--fP}while(fR<fV.length&&fO(fV.charAt(fR))){++fR}}return new dB(W(fS.line,fP),W(fS.line,fR))}I.prototype={constructor:I,focus:function(){window.focus();ed(this);C(this)},setOption:function(fQ,fR){var fP=this.options,fO=fP[fQ];if(fP[fQ]==fR&&fQ!="mode"){return}fP[fQ]=fR;if(a4.hasOwnProperty(fQ)){cL(this,a4[fQ])(this,fR,fO)}},getOption:function(fO){return this.options[fO]},getDoc:function(){return this.doc},addKeyMap:function(fP,fO){this.state.keyMaps[fO?"push":"unshift"](fP)},removeKeyMap:function(fP){var fQ=this.state.keyMaps;for(var fO=0;fO<fQ.length;++fO){if(fQ[fO]==fP||(typeof fQ[fO]!="string"&&fQ[fO].name==fP)){fQ.splice(fO,1);return true}}},addOverlay:cR(function(fO,fP){var fQ=fO.token?fO:I.getMode(this.options,fO);if(fQ.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:fQ,modeSpec:fO,opaque:fP&&fP.opaque});this.state.modeGen++;af(this)}),removeOverlay:cR(function(fO){var fQ=this.state.overlays;for(var fP=0;fP<fQ.length;++fP){var fR=fQ[fP].modeSpec;if(fR==fO||typeof fO=="string"&&fR.name==fO){fQ.splice(fP,1);this.state.modeGen++;af(this);return}}}),indentLine:cR(function(fQ,fO,fP){if(typeof fO!="string"&&typeof fO!="number"){if(fO==null){fO=this.options.smartIndent?"smart":"prev"}else{fO=fO?"add":"subtract"}}if(bW(this.doc,fQ)){ab(this,fQ,fO,fP)}}),indentSelection:cR(function(fT){var fP=this.doc.sel.ranges,fO=-1;for(var fS=0;fS<fP.length;fS++){var fQ=fP[fS];if(!fQ.empty()){var fV=Math.max(fO,fQ.from().line);var fU=fQ.to();fO=Math.min(this.lastLine(),fU.line-(fU.ch?0:1))+1;for(var fR=fV;fR<fO;++fR){ab(this,fR,fT)}}else{if(fQ.head.line>fO){ab(this,fQ.head.line,fT,true);fO=fQ.head.line;if(fS==this.doc.sel.primIndex){fh(this)}}}}}),getTokenAt:function(fV,fP){var fS=this.doc;fV=fk(fS,fV);var fR=dg(this,fV.line,fP),fU=this.doc.mode;var fO=eP(fS,fV.line);var fT=new ew(fO.text,this.options.tabSize);while(fT.pos<fV.ch&&!fT.eol()){fT.start=fT.pos;var fQ=ef(fU,fT,fR)}return{start:fT.start,end:fT.pos,string:fT.current(),type:fQ||null,state:fR}},getTokenTypeAt:function(fV){fV=fk(this.doc,fV);var fR=cQ(this,eP(this.doc,fV.line));var fT=0,fU=(fR.length-1)/2,fQ=fV.ch;var fP;if(fQ==0){fP=fR[2]}else{for(;;){var fO=(fT+fU)>>1;if((fO?fR[fO*2-1]:0)>=fQ){fU=fO}else{if(fR[fO*2+1]<fQ){fT=fO+1}else{fP=fR[fO*2+2];break}}}}var fS=fP?fP.indexOf("cm-overlay "):-1;return fS<0?fP:fS==0?null:fP.slice(0,fS-1)},getModeAt:function(fP){var fO=this.doc.mode;if(!fO.innerMode){return fO}return I.innerMode(fO,this.getTokenAt(fP).state).mode},getHelper:function(fP,fO){return this.getHelpers(fP,fO)[0]},getHelpers:function(fV,fQ){var fR=[];if(!eY.hasOwnProperty(fQ)){return eY}var fO=eY[fQ],fU=this.getModeAt(fV);if(typeof fU[fQ]=="string"){if(fO[fU[fQ]]){fR.push(fO[fU[fQ]])}}else{if(fU[fQ]){for(var fP=0;fP<fU[fQ].length;fP++){var fT=fO[fU[fQ][fP]];if(fT){fR.push(fT)}}}else{if(fU.helperType&&fO[fU.helperType]){fR.push(fO[fU.helperType])}else{if(fO[fU.name]){fR.push(fO[fU.name])}}}}for(var fP=0;fP<fO._global.length;fP++){var fS=fO._global[fP];if(fS.pred(fU,this)&&c1(fR,fS.val)==-1){fR.push(fS.val)}}return fR},getStateAfter:function(fP,fO){var fQ=this.doc;fP=cO(fQ,fP==null?fQ.first+fQ.size-1:fP);return dg(this,fP+1,fO)},cursorCoords:function(fR,fP){var fQ,fO=this.doc.sel.primary();if(fR==null){fQ=fO.head}else{if(typeof fR=="object"){fQ=fk(this.doc,fR)}else{fQ=fR?fO.from():fO.to()}}return dx(this,fQ,fP||"page")},charCoords:function(fP,fO){return cx(this,fk(this.doc,fP),fO||"page")},coordsChar:function(fO,fP){fO=fK(this,fO,fP||"page");return fp(this,fO.left,fO.top)},lineAtHeight:function(fO,fP){fO=fK(this,{top:fO,left:0},fP||"page").top;return bv(this.doc,fO+this.display.viewOffset)},heightAtLine:function(fP,fS){var fO=false,fR=this.doc.first+this.doc.size-1;if(fP<this.doc.first){fP=this.doc.first}else{if(fP>fR){fP=fR;fO=true}}var fQ=eP(this.doc,fP);return et(this,fQ,{top:0,left:0},fS||"page").top+(fO?this.doc.height-bB(fQ):0)},defaultTextHeight:function(){return aN(this.display)},defaultCharWidth:function(){return di(this.display)},setGutterMarker:cR(function(fO,fP,fQ){return eb(this,fO,"gutter",function(fR){var fS=fR.gutterMarkers||(fR.gutterMarkers={});fS[fP]=fQ;if(!fQ&&ex(fS)){fR.gutterMarkers=null}return true})}),clearGutter:cR(function(fQ){var fO=this,fR=fO.doc,fP=fR.first;fR.iter(function(fS){if(fS.gutterMarkers&&fS.gutterMarkers[fQ]){fS.gutterMarkers[fQ]=null;R(fO,fP,"gutter");if(ex(fS.gutterMarkers)){fS.gutterMarkers=null}}++fP})}),addLineClass:cR(function(fQ,fP,fO){return eb(this,fQ,"class",function(fR){var fS=fP=="text"?"textClass":fP=="background"?"bgClass":"wrapClass";if(!fR[fS]){fR[fS]=fO}else{if(new RegExp("(?:^|\\s)"+fO+"(?:$|\\s)").test(fR[fS])){return false}else{fR[fS]+=" "+fO}}return true})}),removeLineClass:cR(function(fQ,fP,fO){return eb(this,fQ,"class",function(fS){var fV=fP=="text"?"textClass":fP=="background"?"bgClass":"wrapClass";var fU=fS[fV];if(!fU){return false}else{if(fO==null){fS[fV]=null}else{var fT=fU.match(new RegExp("(?:^|\\s+)"+fO+"(?:$|\\s+)"));if(!fT){return false}var fR=fT.index+fT[0].length;fS[fV]=fU.slice(0,fT.index)+(!fT.index||fR==fU.length?"":" ")+fU.slice(fR)||null}}return true})}),addLineWidget:cR(function(fQ,fP,fO){return bw(this,fQ,fP,fO)}),removeLineWidget:function(fO){fO.clear()},lineInfo:function(fO){if(typeof fO=="number"){if(!bW(this.doc,fO)){return null}var fP=fO;fO=eP(this.doc,fO);if(!fO){return null}}else{var fP=bC(fO);if(fP==null){return null}}return{line:fP,handle:fO,text:fO.text,gutterMarkers:fO.gutterMarkers,textClass:fO.textClass,bgClass:fO.bgClass,wrapClass:fO.wrapClass,widgets:fO.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(fT,fQ,fV,fR,fX){var fS=this.display;fT=dx(this,fk(this.doc,fT));var fU=fT.bottom,fP=fT.left;fQ.style.position="absolute";fS.sizer.appendChild(fQ);if(fR=="over"){fU=fT.top}else{if(fR=="above"||fR=="near"){var fO=Math.max(fS.wrapper.clientHeight,this.doc.height),fW=Math.max(fS.sizer.clientWidth,fS.lineSpace.clientWidth);if((fR=="above"||fT.bottom+fQ.offsetHeight>fO)&&fT.top>fQ.offsetHeight){fU=fT.top-fQ.offsetHeight}else{if(fT.bottom+fQ.offsetHeight<=fO){fU=fT.bottom}}if(fP+fQ.offsetWidth>fW){fP=fW-fQ.offsetWidth}}}fQ.style.top=fU+"px";fQ.style.left=fQ.style.right="";if(fX=="right"){fP=fS.sizer.clientWidth-fQ.offsetWidth;fQ.style.right="0px"}else{if(fX=="left"){fP=0}else{if(fX=="middle"){fP=(fS.sizer.clientWidth-fQ.offsetWidth)/2}}fQ.style.left=fP+"px"}if(fV){F(this,fP,fU,fP+fQ.offsetWidth,fU+fQ.offsetHeight)}},triggerOnKeyDown:cR(q),triggerOnKeyPress:cR(cn),triggerOnKeyUp:cR(a7),execCommand:function(fO){if(eh.hasOwnProperty(fO)){return eh[fO](this)}},findPosH:function(fU,fR,fS,fP){var fO=1;if(fR<0){fO=-1;fR=-fR}for(var fQ=0,fT=fk(this.doc,fU);fQ<fR;++fQ){fT=bm(this.doc,fT,fO,fS,fP);if(fT.hitSide){break}}return fT},moveH:cR(function(fP,fQ){var fO=this;fO.extendSelectionsBy(function(fR){if(fO.display.shift||fO.doc.extend||fR.empty()){return bm(fO.doc,fR.head,fP,fQ,fO.options.rtlMoveVisually)}else{return fP<0?fR.from():fR.to()}},cF)}),deleteH:cR(function(fO,fP){var fQ=this.doc.sel,fR=this.doc;if(fQ.somethingSelected()){fR.replaceSelection("",null,"+delete")}else{eA(this,function(fT){var fS=bm(fR,fT.head,fO,fP,false);return fO<0?{from:fS,to:fT.head}:{from:fT.head,to:fS}})}}),findPosV:function(fT,fQ,fU,fW){var fO=1,fS=fW;if(fQ<0){fO=-1;fQ=-fQ}for(var fP=0,fV=fk(this.doc,fT);fP<fQ;++fP){var fR=dx(this,fV,"div");if(fS==null){fS=fR.left}else{fR.left=fS}fV=bg(this,fR,fO,fU);if(fV.hitSide){break}}return fV},moveV:cR(function(fP,fR){var fO=this,fT=this.doc,fS=[];var fU=!fO.display.shift&&!fT.extend&&fT.sel.somethingSelected();fT.extendSelectionsBy(function(fV){if(fU){return fP<0?fV.from():fV.to()}var fX=dx(fO,fV.head,"div");if(fV.goalColumn!=null){fX.left=fV.goalColumn}fS.push(fX.left);var fW=bg(fO,fX,fP,fR);if(fR=="page"&&fV==fT.sel.primary()){cy(fO,null,cx(fO,fW,"div").top-fX.top)}return fW},cF);if(fS.length){for(var fQ=0;fQ<fT.sel.ranges.length;fQ++){fT.sel.ranges[fQ].goalColumn=fS[fQ]}}}),toggleOverwrite:function(fO){if(fO!=null&&fO==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){fb(this.display.cursorDiv,"CodeMirror-overwrite")}else{g(this.display.cursorDiv,"CodeMirror-overwrite")}az(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return ds()==this.display.input},scrollTo:cR(function(fO,fP){if(fO!=null||fP!=null){fd(this)}if(fO!=null){this.curOp.scrollLeft=fO}if(fP!=null){this.curOp.scrollTop=fP}}),getScrollInfo:function(){var fO=this.display.scroller,fP=ba;return{left:fO.scrollLeft,top:fO.scrollTop,height:fO.scrollHeight-fP,width:fO.scrollWidth-fP,clientHeight:fO.clientHeight-fP,clientWidth:fO.clientWidth-fP}},scrollIntoView:cR(function(fP,fQ){if(fP==null){fP={from:this.doc.sel.primary().head,to:null};if(fQ==null){fQ=this.options.cursorScrollMargin}}else{if(typeof fP=="number"){fP={from:W(fP,0),to:null}}else{if(fP.from==null){fP={from:fP,to:null}}}}if(!fP.to){fP.to=fP.from}fP.margin=fQ||0;if(fP.from.line!=null){fd(this);this.curOp.scrollToPos=fP}else{var fO=H(this,Math.min(fP.from.left,fP.to.left),Math.min(fP.from.top,fP.to.top)-fP.margin,Math.max(fP.from.right,fP.to.right),Math.max(fP.from.bottom,fP.to.bottom)+fP.margin);this.scrollTo(fO.scrollLeft,fO.scrollTop)}}),setSize:cR(function(fQ,fO){function fP(fR){return typeof fR=="number"||/^\d+$/.test(String(fR))?fR+"px":fR}if(fQ!=null){this.display.wrapper.style.width=fP(fQ)}if(fO!=null){this.display.wrapper.style.height=fP(fO)}if(this.options.lineWrapping){aF(this)}this.curOp.forceUpdate=true;az(this,"refresh",this)}),operation:function(fO){return cz(this,fO)},refresh:cR(function(){var fO=this.display.cachedTextHeight;af(this);this.curOp.forceUpdate=true;ai(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);cN(this);if(fO==null||Math.abs(fO-aN(this.display))>0.5){X(this)}az(this,"refresh",this)}),swapDoc:cR(function(fP){var fO=this.doc;fO.cm=null;dN(this,fP);ai(this);eZ(this);this.scrollTo(fP.scrollLeft,fP.scrollTop);ac(this,"swapDoc",this,fO);return fO}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bo(I);var eF=I.defaults={};var a4=I.optionHandlers={};function t(fO,fR,fQ,fP){I.defaults[fO]=fR;if(fQ){a4[fO]=fP?function(fS,fU,fT){if(fT!=b2){fQ(fS,fU,fT)}}:fQ}}var b2=I.Init={toString:function(){return"CodeMirror.Init"}};t("value","",function(fO,fP){fO.setValue(fP)},true);t("mode",null,function(fO,fP){fO.doc.modeOption=fP;bh(fO)},true);t("indentUnit",2,bh,true);t("indentWithTabs",false);t("smartIndent",true);t("tabSize",4,function(fO){dX(fO);ai(fO);af(fO)},true);t("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(fO,fP){fO.options.specialChars=new RegExp(fP.source+(fP.test("\t")?"":"|\t"),"g");fO.refresh()},true);t("specialCharPlaceholder",eN,function(fO){fO.refresh()},true);t("electricChars",true);t("rtlMoveVisually",!aG);t("wholeLineUpdateBefore",true);t("theme","default",function(fO){cB(fO);db(fO)},true);t("keyMap","default",fL);t("extraKeys",null);t("lineWrapping",false,ek,true);t("gutters",[],function(fO){b4(fO.options);db(fO)},true);t("fixedGutter",true,function(fO,fP){fO.display.gutters.style.left=fP?dA(fO.display)+"px":"0";fO.refresh()},true);t("coverGutterNextToScrollbar",false,eB,true);t("lineNumbers",false,function(fO){b4(fO.options);db(fO)},true);t("firstLineNumber",1,db,true);t("lineNumberFormatter",function(fO){return fO},db,true);t("showCursorWhenSelecting",false,br,true);t("resetSelectionOnContextMenu",true);t("readOnly",false,function(fO,fP){if(fP=="nocursor"){aL(fO);fO.display.input.blur();fO.display.disabled=true}else{fO.display.disabled=false;if(!fP){eZ(fO)}}});t("disableInput",false,function(fO,fP){if(!fP){eZ(fO)}},true);t("dragDrop",true);t("cursorBlinkRate",530);t("cursorScrollMargin",0);t("cursorHeight",1);t("workTime",100);t("workDelay",100);t("flattenSpans",true,dX,true);t("addModeClass",false,dX,true);t("pollInterval",100);t("undoDepth",200,function(fO,fP){fO.doc.history.undoDepth=fP});t("historyEventDelay",1250);t("viewportMargin",10,function(fO){fO.refresh()},true);t("maxHighlightLength",10000,dX,true);t("moveInputWithCursor",true,function(fO,fP){if(!fP){fO.display.inputDiv.style.top=fO.display.inputDiv.style.left=0}});t("tabindex",null,function(fO,fP){fO.display.input.tabIndex=fP||""});t("autofocus",null);var c8=I.modes={},aJ=I.mimeModes={};var c8=I.modes={},aJ=I.mimeModes={};I.defineMode=function(fO,fQ){if(!I.defaults.mode&&fO!="null"){I.defaults.mode=fO}if(arguments.length>2){fQ.dependencies=[];for(var fP=2;fP<arguments.length;++fP){fQ.dependencies.push(arguments[fP])}}c8[fO]=fQ};I.defineMIME=function(fP,fO){aJ[fP]=fO};I.resolveMode=function(fO){if(typeof fO=="string"&&aJ.hasOwnProperty(fO)){fO=aJ[fO]}else{if(fO&&typeof fO.name=="string"&&aJ.hasOwnProperty(fO.name)){var fP=aJ[fO.name];if(typeof fP=="string"){fP={name:fP}}fO=ca(fP,fO);fO.name=fP.name}else{if(typeof fO=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(fO)){return I.resolveMode("application/xml")}}}if(typeof fO=="string"){return{name:fO}}else{return fO||{name:"null"}}};I.getMode=function(fP,fO){var fO=I.resolveMode(fO);var fR=c8[fO.name];if(!fR){return I.getMode(fP,"text/plain")}var fS=fR(fP,fO);if(c5.hasOwnProperty(fO.name)){var fQ=c5[fO.name];for(var fT in fQ){if(!fQ.hasOwnProperty(fT)){continue}if(fS.hasOwnProperty(fT)){fS["_"+fT]=fS[fT]}fS[fT]=fQ[fT]}}fS.name=fO.name;if(fO.helperType){fS.helperType=fO.helperType}if(fO.modeProps){for(var fT in fO.modeProps){fS[fT]=fO.modeProps[fT]}}return fS};I.defineMode("null",function(){return{token:function(fO){fO.skipToEnd()}}});I.defineMIME("text/plain","null");var c5=I.modeExtensions={};I.extendMode=function(fQ,fP){var fO=c5.hasOwnProperty(fQ)?c5[fQ]:(c5[fQ]={});aE(fP,fO)};I.defineExtension=function(fO,fP){I.prototype[fO]=fP};I.defineDocExtension=function(fO,fP){ao.prototype[fO]=fP};I.defineOption=t;var aY=[];I.defineInitHook=function(fO){aY.push(fO)};var eY=I.helpers={};I.registerHelper=function(fP,fO,fQ){if(!eY.hasOwnProperty(fP)){eY[fP]=I[fP]={_global:[]}}eY[fP][fO]=fQ};I.registerGlobalHelper=function(fQ,fP,fO,fR){I.registerHelper(fQ,fP,fR);eY[fQ]._global.push({pred:fO,val:fR})};var bR=I.copyState=function(fR,fO){if(fO===true){return fO}if(fR.copyState){return fR.copyState(fO)}var fQ={};for(var fS in fO){var fP=fO[fS];if(fP instanceof Array){fP=fP.concat([])}fQ[fS]=fP}return fQ};var bP=I.startState=function(fQ,fP,fO){return fQ.startState?fQ.startState(fP,fO):true};I.innerMode=function(fQ,fO){while(fQ.innerMode){var fP=fQ.innerMode(fO);if(!fP||fP.mode==fQ){break}fO=fP.state;fQ=fP.mode}return fP||{mode:fQ,state:fO}};var eh=I.commands={selectAll:function(fO){fO.setSelection(W(fO.firstLine(),0),W(fO.lastLine()),Y)},singleSelection:function(fO){fO.setSelection(fO.getCursor("anchor"),fO.getCursor("head"),Y)},killLine:function(fO){eA(fO,function(fQ){if(fQ.empty()){var fP=eP(fO.doc,fQ.head.line).text.length;if(fQ.head.ch==fP&&fQ.head.line<fO.lastLine()){return{from:fQ.head,to:W(fQ.head.line+1,0)}}else{return{from:fQ.head,to:W(fQ.head.line,fP)}}}else{return{from:fQ.from(),to:fQ.to()}}})},deleteLine:function(fO){eA(fO,function(fP){return{from:W(fP.from().line,0),to:fk(fO.doc,W(fP.to().line+1,0))}})},delLineLeft:function(fO){eA(fO,function(fP){return{from:W(fP.from().line,0),to:fP.from()}})},undo:function(fO){fO.undo()},redo:function(fO){fO.redo()},undoSelection:function(fO){fO.undoSelection()},redoSelection:function(fO){fO.redoSelection()},goDocStart:function(fO){fO.extendSelection(W(fO.firstLine(),0))},goDocEnd:function(fO){fO.extendSelection(W(fO.lastLine()))},goLineStart:function(fO){fO.extendSelectionsBy(function(fP){return bj(fO,fP.head.line)},cF)},goLineStartSmart:function(fO){fO.extendSelectionsBy(function(fR){var fU=bj(fO,fR.head.line);var fQ=fO.getLineHandle(fU.line);var fP=a(fQ);if(!fP||fP[0].level==0){var fT=Math.max(0,fQ.text.search(/\S/));var fS=fR.head.line==fU.line&&fR.head.ch<=fT&&fR.head.ch;return W(fU.line,fS?0:fT)}return fU},cF)},goLineEnd:function(fO){fO.extendSelectionsBy(function(fP){return dt(fO,fP.head.line)},cF)},goLineRight:function(fO){fO.extendSelectionsBy(function(fP){var fQ=fO.charCoords(fP.head,"div").top+5;return fO.coordsChar({left:fO.display.lineDiv.offsetWidth+100,top:fQ},"div")},cF)},goLineLeft:function(fO){fO.extendSelectionsBy(function(fP){var fQ=fO.charCoords(fP.head,"div").top+5;return fO.coordsChar({left:0,top:fQ},"div")},cF)},goLineUp:function(fO){fO.moveV(-1,"line")},goLineDown:function(fO){fO.moveV(1,"line")},goPageUp:function(fO){fO.moveV(-1,"page")},goPageDown:function(fO){fO.moveV(1,"page")},goCharLeft:function(fO){fO.moveH(-1,"char")},goCharRight:function(fO){fO.moveH(1,"char")},goColumnLeft:function(fO){fO.moveH(-1,"column")},goColumnRight:function(fO){fO.moveH(1,"column")},goWordLeft:function(fO){fO.moveH(-1,"word")},goGroupRight:function(fO){fO.moveH(1,"group")},goGroupLeft:function(fO){fO.moveH(-1,"group")},goWordRight:function(fO){fO.moveH(1,"word")},delCharBefore:function(fO){fO.deleteH(-1,"char")},delCharAfter:function(fO){fO.deleteH(1,"char")},delWordBefore:function(fO){fO.deleteH(-1,"word")},delWordAfter:function(fO){fO.deleteH(1,"word")},delGroupBefore:function(fO){fO.deleteH(-1,"group")},delGroupAfter:function(fO){fO.deleteH(1,"group")},indentAuto:function(fO){fO.indentSelection("smart")},indentMore:function(fO){fO.indentSelection("add")},indentLess:function(fO){fO.indentSelection("subtract")},insertTab:function(fO){fO.replaceSelection("\t")},insertSoftTab:function(fO){var fQ=[],fP=fO.listSelections(),fT=fO.options.tabSize;for(var fS=0;fS<fP.length;fS++){var fU=fP[fS].from();var fR=bI(fO.getLine(fU.line),fU.ch,fT);fQ.push(new Array(fT-fR%fT+1).join(" "))}fO.replaceSelections(fQ)},defaultTab:function(fO){if(fO.somethingSelected()){fO.indentSelection("add")}else{fO.execCommand("insertTab")}},transposeChars:function(fO){cz(fO,function(){var fR=fO.listSelections(),fQ=[];for(var fS=0;fS<fR.length;fS++){var fU=fR[fS].head,fP=eP(fO.doc,fU.line).text;if(fP){if(fU.ch==fP.length){fU=new W(fU.line,fU.ch-1)}if(fU.ch>0){fU=new W(fU.line,fU.ch+1);fO.replaceRange(fP.charAt(fU.ch-1)+fP.charAt(fU.ch-2),W(fU.line,fU.ch-2),fU,"+transpose")}else{if(fU.line>fO.doc.first){var fT=eP(fO.doc,fU.line-1).text;if(fT){fO.replaceRange(fP.charAt(0)+"\n"+fT.charAt(fT.length-1),W(fU.line-1,fT.length-1),W(fU.line,1),"+transpose")}}}}fQ.push(new dB(fU,fU))}fO.setSelections(fQ)})},newlineAndIndent:function(fO){cz(fO,function(){var fP=fO.listSelections().length;for(var fR=0;fR<fP;fR++){var fQ=fO.listSelections()[fR];fO.replaceRange("\n",fQ.anchor,fQ.head,"+input");fO.indentLine(fQ.from().line+1,null,true);fh(fO)}})},toggleOverwrite:function(fO){fO.toggleOverwrite()}};var eK=I.keyMap={};eK.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};eK.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};eK.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection",fallthrough:["basic","emacsy"]};eK.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};eK["default"]=bU?eK.macDefault:eK.pcDefault;function fv(fO){if(typeof fO=="string"){return eK[fO]}else{return fO}}var j=I.lookupKey=function(fP,fT,fR){function fS(fY){fY=fv(fY);var fX=fY[fP];if(fX===false){return"stop"}if(fX!=null&&fR(fX)){return true}if(fY.nofallthrough){return"stop"}var fW=fY.fallthrough;if(fW==null){return false}if(Object.prototype.toString.call(fW)!="[object Array]"){return fS(fW)}for(var fV=0;fV<fW.length;++fV){var fU=fS(fW[fV]);if(fU){return fU}}return false}for(var fQ=0;fQ<fT.length;++fQ){var fO=fS(fT[fQ]);if(fO){return fO!="stop"}}};var eg=I.isModifierKey=function(fP){var fO=eQ[fP.keyCode];return fO=="Ctrl"||fO=="Alt"||fO=="Shift"||fO=="Mod"};var e2=I.keyName=function(fP,fQ){if(dF&&fP.keyCode==34&&fP["char"]){return false}var fO=eQ[fP.keyCode];if(fO==null||fP.altGraphKey){return false}if(fP.altKey){fO="Alt-"+fO}if(bF?fP.metaKey:fP.ctrlKey){fO="Ctrl-"+fO}if(bF?fP.ctrlKey:fP.metaKey){fO="Cmd-"+fO}if(!fQ&&fP.shiftKey){fO="Shift-"+fO}return fO};I.fromTextArea=function(fV,fW){if(!fW){fW={}}fW.value=fV.value;if(!fW.tabindex&&fV.tabindex){fW.tabindex=fV.tabindex}if(!fW.placeholder&&fV.placeholder){fW.placeholder=fV.placeholder}if(fW.autofocus==null){var fO=ds();fW.autofocus=fO==fV||fV.getAttribute("autofocus")!=null&&fO==document.body}function fS(){fV.value=fU.getValue()}if(fV.form){bM(fV.form,"submit",fS);if(!fW.leaveSubmitMethodAlone){var fP=fV.form,fT=fP.submit;try{var fR=fP.submit=function(){fS();fP.submit=fT;fP.submit();fP.submit=fR}}catch(fQ){}}}fV.style.display="none";var fU=I(function(fX){fV.parentNode.insertBefore(fX,fV.nextSibling)},fW);fU.save=fS;fU.getTextArea=function(){return fV};fU.toTextArea=function(){fS();fV.parentNode.removeChild(fU.getWrapperElement());fV.style.display="";if(fV.form){dP(fV.form,"submit",fS);if(typeof fV.form.submit=="function"){fV.form.submit=fT}}};return fU};var ew=I.StringStream=function(fO,fP){this.pos=this.start=0;this.string=fO;this.tabSize=fP||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};ew.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(fO){var fQ=this.string.charAt(this.pos);if(typeof fO=="string"){var fP=fQ==fO}else{var fP=fQ&&(fO.test?fO.test(fQ):fO(fQ))}if(fP){++this.pos;return fQ}},eatWhile:function(fO){var fP=this.pos;while(this.eat(fO)){}return this.pos>fP},eatSpace:function(){var fO=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>fO},skipToEnd:function(){this.pos=this.string.length},skipTo:function(fO){var fP=this.string.indexOf(fO,this.pos);if(fP>-1){this.pos=fP;return true}},backUp:function(fO){this.pos-=fO},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bI(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bI(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bI(this.string,null,this.tabSize)-(this.lineStart?bI(this.string,this.lineStart,this.tabSize):0)},match:function(fS,fP,fO){if(typeof fS=="string"){var fT=function(fU){return fO?fU.toLowerCase():fU};var fR=this.string.substr(this.pos,fS.length);if(fT(fR)==fT(fS)){if(fP!==false){this.pos+=fS.length}return true}}else{var fQ=this.string.slice(this.pos).match(fS);if(fQ&&fQ.index>0){return null}if(fQ&&fP!==false){this.pos+=fQ[0].length}return fQ}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(fP,fO){this.lineStart+=fP;try{return fO()}finally{this.lineStart-=fP}}};var P=I.TextMarker=function(fP,fO){this.lines=[];this.type=fO;this.doc=fP};bo(P);P.prototype.clear=function(){if(this.explicitlyCleared){return}var fV=this.doc.cm,fP=fV&&!fV.curOp;if(fP){cw(fV)}if(eS(this,"clear")){var fW=this.find();if(fW){ac(this,"clear",fW.from,fW.to)}}var fQ=null,fT=null;for(var fR=0;fR<this.lines.length;++fR){var fX=this.lines[fR];var fU=eJ(fX.markedSpans,this);if(fV&&!this.collapsed){R(fV,bC(fX),"text")}else{if(fV){if(fU.to!=null){fT=bC(fX)}if(fU.from!=null){fQ=bC(fX)}}}fX.markedSpans=el(fX.markedSpans,fU);if(fU.from==null&&this.collapsed&&!e7(this.doc,fX)&&fV){fB(fX,aN(fV.display))}}if(fV&&this.collapsed&&!fV.options.lineWrapping){for(var fR=0;fR<this.lines.length;++fR){var fO=z(this.lines[fR]),fS=dY(fO);if(fS>fV.display.maxLineLength){fV.display.maxLine=fO;fV.display.maxLineLength=fS;fV.display.maxLineChanged=true}}}if(fQ!=null&&fV&&this.collapsed){af(fV,fQ,fT+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(fV){ea(fV.doc)}}if(fV){ac(fV,"markerCleared",fV,this)}if(fP){aj(fV)}if(this.parent){this.parent.clear()}};P.prototype.find=function(fR,fP){if(fR==null&&this.type=="bookmark"){fR=1}var fU,fT;for(var fQ=0;fQ<this.lines.length;++fQ){var fO=this.lines[fQ];var fS=eJ(fO.markedSpans,this);if(fS.from!=null){fU=W(fP?fO:bC(fO),fS.from);if(fR==-1){return fU}}if(fS.to!=null){fT=W(fP?fO:bC(fO),fS.to);if(fR==1){return fT}}}return fU&&{from:fU,to:fT}};P.prototype.changed=function(){var fQ=this.find(-1,true),fP=this,fO=this.doc.cm;if(!fQ||!fO){return}cz(fO,function(){var fS=fQ.line,fT=bC(fQ.line);var fR=eL(fO,fT);if(fR){ap(fR);fO.curOp.selectionChanged=fO.curOp.forceUpdate=true}fO.curOp.updateMaxLine=true;if(!e7(fP.doc,fS)&&fP.height!=null){var fV=fP.height;fP.height=null;var fU=cH(fP)-fV;if(fU){fB(fS,fS.height+fU)}}})};P.prototype.attachLine=function(fO){if(!this.lines.length&&this.doc.cm){var fP=this.doc.cm.curOp;if(!fP.maybeHiddenMarkers||c1(fP.maybeHiddenMarkers,this)==-1){(fP.maybeUnhiddenMarkers||(fP.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(fO)};P.prototype.detachLine=function(fO){this.lines.splice(c1(this.lines,fO),1);if(!this.lines.length&&this.doc.cm){var fP=this.doc.cm.curOp;(fP.maybeHiddenMarkers||(fP.maybeHiddenMarkers=[])).push(this)}};var aV=0;function ej(fW,fU,fV,fY,fS){if(fY&&fY.shared){return O(fW,fU,fV,fY,fS)}if(fW.cm&&!fW.cm.curOp){return cL(fW.cm,ej)(fW,fU,fV,fY,fS)}var fR=new P(fW,fS),fX=b5(fU,fV);if(fY){aE(fY,fR,false)}if(fX>0||fX==0&&fR.clearWhenEmpty!==false){return fR}if(fR.replacedWith){fR.collapsed=true;fR.widgetNode=fx("span",[fR.replacedWith],"CodeMirror-widget");if(!fY.handleMouseEvents){fR.widgetNode.ignoreEvents=true}if(fY.insertLeft){fR.widgetNode.insertLeft=true}}if(fR.collapsed){if(A(fW,fU.line,fU,fV,fR)||fU.line!=fV.line&&A(fW,fV.line,fU,fV,fR)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}aX=true}if(fR.addToHistory){fn(fW,{from:fU,to:fV,origin:"markText"},fW.sel,NaN)}var fP=fU.line,fT=fW.cm,fO;fW.iter(fP,fV.line+1,function(fZ){if(fT&&fR.collapsed&&!fT.options.lineWrapping&&z(fZ)==fT.display.maxLine){fO=true}if(fR.collapsed&&fP!=fU.line){fB(fZ,0)}b3(fZ,new dU(fR,fP==fU.line?fU.ch:null,fP==fV.line?fV.ch:null));++fP});if(fR.collapsed){fW.iter(fU.line,fV.line+1,function(fZ){if(e7(fW,fZ)){fB(fZ,0)}})}if(fR.clearOnEnter){bM(fR,"beforeCursorEnter",function(){fR.clear()})}if(fR.readOnly){fI=true;if(fW.history.done.length||fW.history.undone.length){fW.clearHistory()}}if(fR.collapsed){fR.id=++aV;fR.atomic=true}if(fT){if(fO){fT.curOp.updateMaxLine=true}if(fR.collapsed){af(fT,fU.line,fV.line+1)}else{if(fR.className||fR.title||fR.startStyle||fR.endStyle){for(var fQ=fU.line;fQ<=fV.line;fQ++){R(fT,fQ,"text")}}}if(fR.atomic){ea(fT.doc)}ac(fT,"markerAdded",fT,fR)}return fR}var y=I.SharedTextMarker=function(fQ,fP){this.markers=fQ;this.primary=fP;for(var fO=0;fO<fQ.length;++fO){fQ[fO].parent=this}};bo(y);y.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var fO=0;fO<this.markers.length;++fO){this.markers[fO].clear()}ac(this,"clear")};y.prototype.find=function(fP,fO){return this.primary.find(fP,fO)};function O(fS,fV,fU,fO,fQ){fO=aE(fO);fO.shared=false;var fT=[ej(fS,fV,fU,fO,fQ)],fP=fT[0];var fR=fO.widgetNode;dK(fS,function(fX){if(fR){fO.widgetNode=fR.cloneNode(true)}fT.push(ej(fX,fk(fX,fV),fk(fX,fU),fO,fQ));for(var fW=0;fW<fX.linked.length;++fW){if(fX.linked[fW].isParent){return}}fP=fi(fT)});return new y(fT,fP)}function es(fO){return fO.findMarks(W(fO.first,0),fO.clipPos(W(fO.lastLine())),function(fP){return fP.parent})}function dk(fT,fU){for(var fR=0;fR<fU.length;fR++){var fP=fU[fR],fV=fP.find();var fO=fT.clipPos(fV.from),fS=fT.clipPos(fV.to);if(b5(fO,fS)){var fQ=ej(fT,fO,fS,fP.primary,fP.primary.type);fP.markers.push(fQ);fQ.parent=fP}}}function d0(fR){for(var fQ=0;fQ<fR.length;fQ++){var fO=fR[fQ],fT=[fO.primary.doc];dK(fO.primary.doc,function(fU){fT.push(fU)});for(var fP=0;fP<fO.markers.length;fP++){var fS=fO.markers[fP];if(c1(fT,fS.doc)==-1){fS.parent=null;fO.markers.splice(fP--,1)}}}}function dU(fO,fQ,fP){this.marker=fO;this.from=fQ;this.to=fP}function eJ(fQ,fO){if(fQ){for(var fP=0;fP<fQ.length;++fP){var fR=fQ[fP];if(fR.marker==fO){return fR}}}}function el(fP,fQ){for(var fR,fO=0;fO<fP.length;++fO){if(fP[fO]!=fQ){(fR||(fR=[])).push(fP[fO])}}return fR}function b3(fO,fP){fO.markedSpans=fO.markedSpans?fO.markedSpans.concat([fP]):[fP];fP.marker.attachLine(fO)}function aH(fP,fQ,fU){if(fP){for(var fS=0,fV;fS<fP.length;++fS){var fW=fP[fS],fT=fW.marker;var fO=fW.from==null||(fT.inclusiveLeft?fW.from<=fQ:fW.from<fQ);if(fO||fW.from==fQ&&fT.type=="bookmark"&&(!fU||!fW.marker.insertLeft)){var fR=fW.to==null||(fT.inclusiveRight?fW.to>=fQ:fW.to>fQ);(fV||(fV=[])).push(new dU(fT,fW.from,fR?null:fW.to))}}}return fV}function ax(fP,fR,fU){if(fP){for(var fS=0,fV;fS<fP.length;++fS){var fW=fP[fS],fT=fW.marker;var fQ=fW.to==null||(fT.inclusiveRight?fW.to>=fR:fW.to>fR);if(fQ||fW.from==fR&&fT.type=="bookmark"&&(!fU||fW.marker.insertLeft)){var fO=fW.from==null||(fT.inclusiveLeft?fW.from<=fR:fW.from<fR);(fV||(fV=[])).push(new dU(fT,fO?null:fW.from-fR,fW.to==null?null:fW.to-fR))}}}return fV}function dW(f0,fX){var fW=bW(f0,fX.from.line)&&eP(f0,fX.from.line).markedSpans;var f3=bW(f0,fX.to.line)&&eP(f0,fX.to.line).markedSpans;if(!fW&&!f3){return null}var fP=fX.from.ch,fS=fX.to.ch,fV=b5(fX.from,fX.to)==0;var fU=aH(fW,fP,fV);var f2=ax(f3,fS,fV);var f1=fX.text.length==1,fQ=fi(fX.text).length+(f1?fP:0);if(fU){for(var fR=0;fR<fU.length;++fR){var fZ=fU[fR];if(fZ.to==null){var f4=eJ(f2,fZ.marker);if(!f4){fZ.to=fP}else{if(f1){fZ.to=f4.to==null?null:f4.to+fQ}}}}}if(f2){for(var fR=0;fR<f2.length;++fR){var fZ=f2[fR];if(fZ.to!=null){fZ.to+=fQ}if(fZ.from==null){var f4=eJ(fU,fZ.marker);if(!f4){fZ.from=fQ;if(f1){(fU||(fU=[])).push(fZ)}}}else{fZ.from+=fQ;if(f1){(fU||(fU=[])).push(fZ)}}}}if(fU){fU=r(fU)}if(f2&&f2!=fU){f2=r(f2)}var fT=[fU];if(!f1){var fY=fX.text.length-2,fO;if(fY>0&&fU){for(var fR=0;fR<fU.length;++fR){if(fU[fR].to==null){(fO||(fO=[])).push(new dU(fU[fR].marker,null,null))}}}for(var fR=0;fR<fY;++fR){fT.push(fO)}fT.push(f2)}return fT}function r(fP){for(var fO=0;fO<fP.length;++fO){var fQ=fP[fO];if(fQ.from!=null&&fQ.from==fQ.to&&fQ.marker.clearWhenEmpty!==false){fP.splice(fO--,1)}}if(!fP.length){return null}return fP}function dM(fW,fU){var fO=bS(fW,fU);var fX=dW(fW,fU);if(!fO){return fX}if(!fX){return fO}for(var fR=0;fR<fO.length;++fR){var fS=fO[fR],fT=fX[fR];if(fS&&fT){spans:for(var fQ=0;fQ<fT.length;++fQ){var fV=fT[fQ];for(var fP=0;fP<fS.length;++fP){if(fS[fP].marker==fV.marker){continue spans}}fS.push(fV)}}else{if(fT){fO[fR]=fT}}}return fO}function cv(f0,fY,fZ){var fS=null;f0.iter(fY.line,fZ.line+1,function(f1){if(f1.markedSpans){for(var f2=0;f2<f1.markedSpans.length;++f2){var f3=f1.markedSpans[f2].marker;if(f3.readOnly&&(!fS||c1(fS,f3)==-1)){(fS||(fS=[])).push(f3)}}}});if(!fS){return null}var fT=[{from:fY,to:fZ}];for(var fU=0;fU<fS.length;++fU){var fV=fS[fU],fQ=fV.find(0);for(var fR=0;fR<fT.length;++fR){var fP=fT[fR];if(b5(fP.to,fQ.from)<0||b5(fP.from,fQ.to)>0){continue}var fX=[fR,1],fO=b5(fP.from,fQ.from),fW=b5(fP.to,fQ.to);if(fO<0||!fV.inclusiveLeft&&!fO){fX.push({from:fP.from,to:fQ.from})}if(fW>0||!fV.inclusiveRight&&!fW){fX.push({from:fQ.to,to:fP.to})}fT.splice.apply(fT,fX);fR+=fX.length-1}}return fT}function fE(fO){var fQ=fO.markedSpans;if(!fQ){return}for(var fP=0;fP<fQ.length;++fP){fQ[fP].marker.detachLine(fO)}fO.markedSpans=null}function cM(fO,fQ){if(!fQ){return}for(var fP=0;fP<fQ.length;++fP){fQ[fP].marker.attachLine(fO)}fO.markedSpans=fQ}function w(fO){return fO.inclusiveLeft?-1:0}function bL(fO){return fO.inclusiveRight?1:0}function du(fR,fP){var fT=fR.lines.length-fP.lines.length;if(fT!=0){return fT}var fQ=fR.find(),fU=fP.find();var fO=b5(fQ.from,fU.from)||w(fR)-w(fP);if(fO){return -fO}var fS=b5(fQ.to,fU.to)||bL(fR)-bL(fP);if(fS){return fS}return fP.id-fR.id}function aW(fP,fT){var fO=aX&&fP.markedSpans,fS;if(fO){for(var fR,fQ=0;fQ<fO.length;++fQ){fR=fO[fQ];if(fR.marker.collapsed&&(fT?fR.from:fR.to)==null&&(!fS||du(fS,fR.marker)<0)){fS=fR.marker}}}return fS}function er(fO){return aW(fO,true)}function d7(fO){return aW(fO,false)}function A(fW,fQ,fU,fV,fS){var fZ=eP(fW,fQ);var fO=aX&&fZ.markedSpans;if(fO){for(var fR=0;fR<fO.length;++fR){var fP=fO[fR];if(!fP.marker.collapsed){continue}var fY=fP.marker.find(0);var fX=b5(fY.from,fU)||w(fP.marker)-w(fS);var fT=b5(fY.to,fV)||bL(fP.marker)-bL(fS);if(fX>=0&&fT<=0||fX<=0&&fT>=0){continue}if(fX<=0&&(b5(fY.to,fU)||bL(fP.marker)-w(fS))>0||fX>=0&&(b5(fY.from,fV)||w(fP.marker)-bL(fS))<0){return true}}}}function z(fP){var fO;while(fO=er(fP)){fP=fO.find(-1,true).line}return fP}function i(fQ){var fO,fP;while(fO=d7(fQ)){fQ=fO.find(1,true).line;(fP||(fP=[])).push(fQ)}return fP}function aM(fR,fP){var fO=eP(fR,fP),fQ=z(fO);if(fO==fQ){return fP}return bC(fQ)}function dG(fR,fQ){if(fQ>fR.lastLine()){return fQ}var fP=eP(fR,fQ),fO;if(!e7(fR,fP)){return fQ}while(fO=d7(fP)){fP=fO.find(1,true).line}return bC(fP)+1}function e7(fS,fP){var fO=aX&&fP.markedSpans;if(fO){for(var fR,fQ=0;fQ<fO.length;++fQ){fR=fO[fQ];if(!fR.marker.collapsed){continue}if(fR.from==null){return true}if(fR.marker.widgetNode){continue}if(fR.from==0&&fR.marker.inclusiveLeft&&T(fS,fP,fR)){return true}}}}function T(fT,fP,fR){if(fR.to==null){var fO=fR.marker.find(1,true);return T(fT,fO.line,eJ(fO.line.markedSpans,fR.marker))}if(fR.marker.inclusiveRight&&fR.to==fP.text.length){return true}for(var fS,fQ=0;fQ<fP.markedSpans.length;++fQ){fS=fP.markedSpans[fQ];if(fS.marker.collapsed&&!fS.marker.widgetNode&&fS.from==fR.to&&(fS.to==null||fS.to!=fR.from)&&(fS.marker.inclusiveLeft||fR.marker.inclusiveRight)&&T(fT,fP,fS)){return true}}}var dh=I.LineWidget=function(fO,fR,fP){if(fP){for(var fQ in fP){if(fP.hasOwnProperty(fQ)){this[fQ]=fP[fQ]}}}this.cm=fO;this.node=fR};bo(dh);function dD(fO,fP,fQ){if(bB(fP)<((fO.curOp&&fO.curOp.scrollTop)||fO.doc.scrollTop)){cy(fO,null,fQ)}}dh.prototype.clear=function(){var fP=this.cm,fR=this.line.widgets,fQ=this.line,fT=bC(fQ);if(fT==null||!fR){return}for(var fS=0;fS<fR.length;++fS){if(fR[fS]==this){fR.splice(fS--,1)}}if(!fR.length){fQ.widgets=null}var fO=cH(this);cz(fP,function(){dD(fP,fQ,-fO);R(fP,fT,"widget");fB(fQ,Math.max(0,fQ.height-fO))})};dh.prototype.changed=function(){var fP=this.height,fO=this.cm,fQ=this.line;this.height=null;var fR=cH(this)-fP;if(!fR){return}cz(fO,function(){fO.curOp.forceUpdate=true;dD(fO,fQ,fR);fB(fQ,fQ.height+fR)})};function cH(fO){if(fO.height!=null){return fO.height}if(!fG(document.body,fO.node)){bG(fO.cm.display.measure,fx("div",[fO.node],null,"position: relative"))}return fO.height=fO.node.offsetHeight}function bw(fO,fS,fQ,fP){var fR=new dh(fO,fQ,fP);if(fR.noHScroll){fO.display.alignWidgets=true}eb(fO,fS,"widget",function(fU){var fV=fU.widgets||(fU.widgets=[]);if(fR.insertAt==null){fV.push(fR)}else{fV.splice(Math.min(fV.length-1,Math.max(0,fR.insertAt)),0,fR)}fR.line=fU;if(!e7(fO.doc,fU)){var fT=bB(fU)<fO.doc.scrollTop;fB(fU,fU.height+cH(fR));if(fT){cy(fO,null,fR.height)}fO.curOp.forceUpdate=true}return true});return fR}var fD=I.Line=function(fQ,fP,fO){this.text=fQ;cM(this,fP);this.height=fO?fO(this):1};bo(fD);fD.prototype.lineNo=function(){return bC(this)};function dZ(fP,fS,fQ,fO){fP.text=fS;if(fP.stateAfter){fP.stateAfter=null}if(fP.styles){fP.styles=null}if(fP.order!=null){fP.order=null}fE(fP);cM(fP,fQ);var fR=fO?fO(fP):1;if(fR!=fP.height){fB(fP,fR)}}function bq(fO){fO.parent=null;fE(fO)}function c2(fQ,fP){if(fQ){for(;;){var fO=fQ.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!fO){break}fQ=fQ.slice(0,fO.index)+fQ.slice(fO.index+fO[0].length);var fR=fO[1]?"bgClass":"textClass";if(fP[fR]==null){fP[fR]=fO[2]}else{if(!(new RegExp("(?:^|s)"+fO[2]+"(?:$|s)")).test(fP[fR])){fP[fR]+=" "+fO[2]}}}}return fQ}function e1(fQ,fP){if(fQ.blankLine){return fQ.blankLine(fP)}if(!fQ.innerMode){return}var fO=I.innerMode(fQ,fP);if(fO.mode.blankLine){return fO.mode.blankLine(fO.state)}}function ef(fS,fR,fQ){for(var fO=0;fO<10;fO++){var fP=fS.token(fR,fQ);if(fR.pos>fR.start){return fP}}throw new Error("Mode "+fS.name+" failed to advance stream.")}function x(fY,f0,fT,fP,fU,fR,fS){var fQ=fT.flattenSpans;if(fQ==null){fQ=fY.options.flattenSpans}var fW=0,fV=null;var fZ=new ew(f0,fY.options.tabSize),fO;if(f0==""){c2(e1(fT,fP),fR)}while(!fZ.eol()){if(fZ.pos>fY.options.maxHighlightLength){fQ=false;if(fS){dc(fY,f0,fP,fZ.pos)}fZ.pos=f0.length;fO=null}else{fO=c2(ef(fT,fZ,fP),fR)}if(fY.options.addModeClass){var f1=I.innerMode(fT,fP).mode.name;if(f1){fO="m-"+(fO?f1+" "+fO:f1)}}if(!fQ||fV!=fO){if(fW<fZ.start){fU(fZ.start,fV)}fW=fZ.start;fV=fO}fZ.start=fZ.pos}while(fW<fZ.pos){var fX=Math.min(fZ.pos,fW+50000);fU(fX,fV);fW=fX}}function fa(fV,fX,fO,fS){var fW=[fV.state.modeGen],fR={};x(fV,fX.text,fV.doc.mode,fO,function(fY,fZ){fW.push(fY,fZ)},fR,fS);for(var fP=0;fP<fV.state.overlays.length;++fP){var fT=fV.state.overlays[fP],fU=1,fQ=0;x(fV,fX.text,fT.mode,true,function(fY,f0){var f2=fU;while(fQ<fY){var fZ=fW[fU];if(fZ>fY){fW.splice(fU,1,fY,fW[fU+1],fZ)}fU+=2;fQ=Math.min(fY,fZ)}if(!f0){return}if(fT.opaque){fW.splice(f2,fU-f2,fY,"cm-overlay "+f0);fU=f2+2}else{for(;f2<fU;f2+=2){var f1=fW[f2+1];fW[f2+1]=(f1?f1+" ":"")+"cm-overlay "+f0}}},fR)}return{styles:fW,classes:fR.bgClass||fR.textClass?fR:null}}function cQ(fP,fQ){if(!fQ.styles||fQ.styles[0]!=fP.state.modeGen){var fO=fa(fP,fQ,fQ.stateAfter=dg(fP,bC(fQ)));fQ.styles=fO.styles;if(fO.classes){fQ.styleClasses=fO.classes}else{if(fQ.styleClasses){fQ.styleClasses=null}}}return fQ.styles}function dc(fO,fT,fQ,fP){var fS=fO.doc.mode;var fR=new ew(fT,fO.options.tabSize);fR.start=fR.pos=fP||0;if(fT==""){e1(fS,fQ)}while(!fR.eol()&&fR.pos<=fO.options.maxHighlightLength){ef(fS,fR,fQ);fR.start=fR.pos}}var dz={},bQ={};function ez(fQ,fP){if(!fQ||/^\s*$/.test(fQ)){return null}var fO=fP.addModeClass?bQ:dz;return fO[fQ]||(fO[fQ]=fQ.replace(/\S+/g,"cm-$&"))}function ev(fP,fT){var fU=fx("span",null,null,cJ?"padding-right: .1px":null);var fR={pre:fx("pre",[fU]),content:fU,col:0,pos:0,cm:fP};fT.measure={};for(var fS=0;fS<=(fT.rest?fT.rest.length:0);fS++){var fQ=fS?fT.rest[fS-1]:fT.line,fO;fR.pos=0;fR.addToken=u;if((dn||cJ)&&fP.getOption("lineWrapping")){fR.addToken=fg(fR.addToken)}if(bD(fP.display.measure)&&(fO=a(fQ))){fR.addToken=U(fR.addToken,fO)}fR.map=[];bf(fQ,fR,cQ(fP,fQ));if(fQ.styleClasses){if(fQ.styleClasses.bgClass){fR.bgClass=fs(fQ.styleClasses.bgClass,fR.bgClass||"")}if(fQ.styleClasses.textClass){fR.textClass=fs(fQ.styleClasses.textClass,fR.textClass||"")}}if(fR.map.length==0){fR.map.push(0,0,fR.content.appendChild(bd(fP.display.measure)))}if(fS==0){fT.measure.map=fR.map;fT.measure.cache={}}else{(fT.measure.maps||(fT.measure.maps=[])).push(fR.map);(fT.measure.caches||(fT.measure.caches=[])).push({})}}az(fP,"renderLine",fP,fT.line,fR.pre);if(fR.pre.className){fR.textClass=fs(fR.pre.className,fR.textClass||"")}return fR}function eN(fP){var fO=fx("span","\u2022","cm-invalidchar");fO.title="\\u"+fP.charCodeAt(0).toString(16);return fO}function u(fT,f3,fO,fR,f4,f2){if(!f3){return}var fY=fT.cm.options.specialChars,fX=false;if(!fY.test(f3)){fT.col+=f3.length;var fW=document.createTextNode(f3);fT.map.push(fT.pos,fT.pos+f3.length,fW);if(bY){fX=true}fT.pos+=f3.length}else{var fW=document.createDocumentFragment(),f0=0;while(true){fY.lastIndex=f0;var fP=fY.exec(f3);var fV=fP?fP.index-f0:f3.length-f0;if(fV){var fS=document.createTextNode(f3.slice(f0,f0+fV));if(bY){fW.appendChild(fx("span",[fS]))}else{fW.appendChild(fS)}fT.map.push(fT.pos,fT.pos+fV,fS);fT.col+=fV;fT.pos+=fV}if(!fP){break}f0+=fV+1;if(fP[0]=="\t"){var fU=fT.cm.options.tabSize,fZ=fU-fT.col%fU;var fS=fW.appendChild(fx("span",cf(fZ),"cm-tab"));fT.col+=fZ}else{var fS=fT.cm.options.specialCharPlaceholder(fP[0]);if(bY){fW.appendChild(fx("span",[fS]))}else{fW.appendChild(fS)}fT.col+=1}fT.map.push(fT.pos,fT.pos+1,fS);fT.pos++}}if(fO||fR||f4||fX){var f1=fO||"";if(fR){f1+=fR}if(f4){f1+=f4}var fQ=fx("span",[fW],f1);if(f2){fQ.title=f2}return fT.content.appendChild(fQ)}fT.content.appendChild(fW)}function fg(fO){function fP(fQ){var fR=" ";for(var fS=0;fS<fQ.length-2;++fS){fR+=fS%2?" ":"\u00a0"}fR+=" ";return fR}return function(fR,fV,fS,fQ,fU,fT){fO(fR,fV.replace(/ {3,}/g,fP),fS,fQ,fU,fT)}}function U(fP,fO){return function(fW,fY,fQ,fU,fZ,fX){fQ=fQ?fQ+" cm-force-border":"cm-force-border";var fR=fW.pos,fT=fR+fY.length;for(;;){for(var fV=0;fV<fO.length;fV++){var fS=fO[fV];if(fS.to>fR&&fS.from<=fR){break}}if(fS.to>=fT){return fP(fW,fY,fQ,fU,fZ,fX)}fP(fW,fY.slice(0,fS.to-fR),fQ,fU,null,fX);fU=null;fY=fY.slice(fS.to-fR);fR=fS.to}}}function aa(fP,fR,fO,fQ){var fS=!fQ&&fO.widgetNode;if(fS){fP.map.push(fP.pos,fP.pos+fR,fS);fP.content.appendChild(fS)}fP.pos+=fR}function bf(fX,f3,fW){var fT=fX.markedSpans,fV=fX.text,f1=0;if(!fT){for(var f6=1;f6<fW.length;f6+=2){f3.addToken(f3,fV.slice(f1,f1=fW[f6]),ez(fW[f6+1],f3.cm.options))}return}var f7=fV.length,fS=0,f6=1,fZ="",f8;var ga=0,fO,f9,f0,gb,fQ;for(;;){if(ga==fS){fO=f9=f0=gb="";fQ=null;ga=Infinity;var fU=[];for(var f4=0;f4<fT.length;++f4){var f5=fT[f4],f2=f5.marker;if(f5.from<=fS&&(f5.to==null||f5.to>fS)){if(f5.to!=null&&ga>f5.to){ga=f5.to;f9=""}if(f2.className){fO+=" "+f2.className}if(f2.startStyle&&f5.from==fS){f0+=" "+f2.startStyle}if(f2.endStyle&&f5.to==ga){f9+=" "+f2.endStyle}if(f2.title&&!gb){gb=f2.title}if(f2.collapsed&&(!fQ||du(fQ.marker,f2)<0)){fQ=f5}}else{if(f5.from>fS&&ga>f5.from){ga=f5.from}}if(f2.type=="bookmark"&&f5.from==fS&&f2.widgetNode){fU.push(f2)}}if(fQ&&(fQ.from||0)==fS){aa(f3,(fQ.to==null?f7+1:fQ.to)-fS,fQ.marker,fQ.from==null);if(fQ.to==null){return}}if(!fQ&&fU.length){for(var f4=0;f4<fU.length;++f4){aa(f3,0,fU[f4])}}}if(fS>=f7){break}var fY=Math.min(f7,ga);while(true){if(fZ){var fP=fS+fZ.length;if(!fQ){var fR=fP>fY?fZ.slice(0,fY-fS):fZ;f3.addToken(f3,fR,f8?f8+fO:fO,f0,fS+fR.length==ga?f9:"",gb)}if(fP>=fY){fZ=fZ.slice(fY-fS);fS=fY;break}fS=fP;f0=""}fZ=fV.slice(f1,f1=fW[f6++]);f8=ez(fW[f6++],f3.cm.options)}}}function dw(fO,fP){return fP.from.ch==0&&fP.to.ch==0&&fi(fP.text)==""&&(!fO.cm||fO.cm.options.wholeLineUpdateBefore)}function e9(f1,fW,fO,fS){function f2(f4){return fO?fO[f4]:null}function fP(f4,f6,f5){dZ(f4,f6,f5,fS);ac(f4,"change",f4,fW)}var fZ=fW.from,f0=fW.to,f3=fW.text;var fX=eP(f1,fZ.line),fY=eP(f1,f0.line);var fV=fi(f3),fR=f2(f3.length-1),fU=f0.line-fZ.line;if(dw(f1,fW)){for(var fQ=0,fT=[];fQ<f3.length-1;++fQ){fT.push(new fD(f3[fQ],f2(fQ),fS))}fP(fY,fY.text,fR);if(fU){f1.remove(fZ.line,fU)}if(fT.length){f1.insert(fZ.line,fT)}}else{if(fX==fY){if(f3.length==1){fP(fX,fX.text.slice(0,fZ.ch)+fV+fX.text.slice(f0.ch),fR)}else{for(var fT=[],fQ=1;fQ<f3.length-1;++fQ){fT.push(new fD(f3[fQ],f2(fQ),fS))}fT.push(new fD(fV+fX.text.slice(f0.ch),fR,fS));fP(fX,fX.text.slice(0,fZ.ch)+f3[0],f2(0));f1.insert(fZ.line+1,fT)}}else{if(f3.length==1){fP(fX,fX.text.slice(0,fZ.ch)+f3[0]+fY.text.slice(f0.ch),f2(0));f1.remove(fZ.line+1,fU)}else{fP(fX,fX.text.slice(0,fZ.ch)+f3[0],f2(0));fP(fY,fV+fY.text.slice(f0.ch),fR);for(var fQ=1,fT=[];fQ<f3.length-1;++fQ){fT.push(new fD(f3[fQ],f2(fQ),fS))}if(fU>1){f1.remove(fZ.line+1,fU-1)}f1.insert(fZ.line+1,fT)}}}ac(f1,"change",f1,fW)}function eC(fP){this.lines=fP;this.parent=null;for(var fQ=0,fO=0;fQ<fP.length;++fQ){fP[fQ].parent=this;fO+=fP[fQ].height}this.height=fO}eC.prototype={chunkSize:function(){return this.lines.length},removeInner:function(fO,fS){for(var fQ=fO,fR=fO+fS;fQ<fR;++fQ){var fP=this.lines[fQ];this.height-=fP.height;bq(fP);ac(fP,"delete")}this.lines.splice(fO,fS)},collapse:function(fO){fO.push.apply(fO,this.lines)},insertInner:function(fP,fQ,fO){this.height+=fO;this.lines=this.lines.slice(0,fP).concat(fQ).concat(this.lines.slice(fP));for(var fR=0;fR<fQ.length;++fR){fQ[fR].parent=this}},iterN:function(fO,fR,fQ){for(var fP=fO+fR;fO<fP;++fO){if(fQ(this.lines[fO])){return true}}}};function e8(fR){this.children=fR;var fQ=0,fO=0;for(var fP=0;fP<fR.length;++fP){var fS=fR[fP];fQ+=fS.chunkSize();fO+=fS.height;fS.parent=this}this.size=fQ;this.height=fO;this.parent=null}e8.prototype={chunkSize:function(){return this.size},removeInner:function(fO,fV){this.size-=fV;for(var fQ=0;fQ<this.children.length;++fQ){var fU=this.children[fQ],fS=fU.chunkSize();if(fO<fS){var fR=Math.min(fV,fS-fO),fT=fU.height;fU.removeInner(fO,fR);this.height-=fT-fU.height;if(fS==fR){this.children.splice(fQ--,1);fU.parent=null}if((fV-=fR)==0){break}fO=0}else{fO-=fS}}if(this.size-fV<25&&(this.children.length>1||!(this.children[0] instanceof eC))){var fP=[];this.collapse(fP);this.children=[new eC(fP)];this.children[0].parent=this}},collapse:function(fO){for(var fP=0;fP<this.children.length;++fP){this.children[fP].collapse(fO)}},insertInner:function(fP,fQ,fO){this.size+=fQ.length;this.height+=fO;for(var fT=0;fT<this.children.length;++fT){var fV=this.children[fT],fU=fV.chunkSize();if(fP<=fU){fV.insertInner(fP,fQ,fO);if(fV.lines&&fV.lines.length>50){while(fV.lines.length>50){var fS=fV.lines.splice(fV.lines.length-25,25);var fR=new eC(fS);fV.height-=fR.height;this.children.splice(fT+1,0,fR);fR.parent=this}this.maybeSpill()}break}fP-=fU}},maybeSpill:function(){if(this.children.length<=10){return}var fR=this;do{var fP=fR.children.splice(fR.children.length-5,5);var fQ=new e8(fP);if(!fR.parent){var fS=new e8(fR.children);fS.parent=fR;fR.children=[fS,fQ];fR=fS}else{fR.size-=fQ.size;fR.height-=fQ.height;var fO=c1(fR.parent.children,fR);fR.parent.children.splice(fO+1,0,fQ)}fQ.parent=fR.parent}while(fR.children.length>10);fR.parent.maybeSpill()},iterN:function(fO,fU,fT){for(var fP=0;fP<this.children.length;++fP){var fS=this.children[fP],fR=fS.chunkSize();if(fO<fR){var fQ=Math.min(fU,fR-fO);if(fS.iterN(fO,fQ,fT)){return true}if((fU-=fQ)==0){break}fO=0}else{fO-=fR}}}};var cg=0;var ao=I.Doc=function(fQ,fP,fO){if(!(this instanceof ao)){return new ao(fQ,fP,fO)}if(fO==null){fO=0}e8.call(this,[new eC([new fD("",null)])]);this.first=fO;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=fO;var fR=W(fO,0);this.sel=eu(fR);this.history=new ft(null);this.id=++cg;this.modeOption=fP;if(typeof fQ=="string"){fQ=aQ(fQ)}e9(this,{from:fR,to:fR,text:fQ});bJ(this,eu(fR),Y)};ao.prototype=ca(e8.prototype,{constructor:ao,iter:function(fQ,fP,fO){if(fO){this.iterN(fQ-this.first,fP-fQ,fO)}else{this.iterN(this.first,this.first+this.size,fQ)}},insert:function(fP,fQ){var fO=0;for(var fR=0;fR<fQ.length;++fR){fO+=fQ[fR].height}this.insertInner(fP-this.first,fQ,fO)},remove:function(fO,fP){this.removeInner(fO-this.first,fP)},getValue:function(fP){var fO=aS(this,this.first,this.first+this.size);if(fP===false){return fO}return fO.join(fP||"\n")},setValue:cs(function(fP){var fQ=W(this.first,0),fO=this.first+this.size-1;a5(this,{from:fQ,to:W(fO,eP(this,fO).text.length),text:aQ(fP),origin:"setValue"},true);bJ(this,eu(fQ))}),replaceRange:function(fP,fR,fQ,fO){fR=fk(this,fR);fQ=fQ?fk(this,fQ):fR;aR(this,fP,fR,fQ,fO)},getRange:function(fR,fQ,fP){var fO=fz(this,fk(this,fR),fk(this,fQ));if(fP===false){return fO}return fO.join(fP||"\n")},getLine:function(fP){var fO=this.getLineHandle(fP);return fO&&fO.text},getLineHandle:function(fO){if(bW(this,fO)){return eP(this,fO)}},getLineNumber:function(fO){return bC(fO)},getLineHandleVisualStart:function(fO){if(typeof fO=="number"){fO=eP(this,fO)}return z(fO)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(fO){return fk(this,fO)},getCursor:function(fQ){var fO=this.sel.primary(),fP;if(fQ==null||fQ=="head"){fP=fO.head}else{if(fQ=="anchor"){fP=fO.anchor}else{if(fQ=="end"||fQ=="to"||fQ===false){fP=fO.to()}else{fP=fO.from()}}}return fP},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:cs(function(fO,fQ,fP){G(this,fk(this,typeof fO=="number"?W(fO,fQ||0):fO),null,fP)}),setSelection:cs(function(fP,fQ,fO){G(this,fk(this,fP),fk(this,fQ||fP),fO)}),extendSelection:cs(function(fQ,fO,fP){fu(this,fk(this,fQ),fO&&fk(this,fO),fP)}),extendSelections:cs(function(fP,fO){at(this,dC(this,fP,fO))}),extendSelectionsBy:cs(function(fP,fO){at(this,bH(this.sel.ranges,fP),fO)}),setSelections:cs(function(fO,fS,fQ){if(!fO.length){return}for(var fR=0,fP=[];fR<fO.length;fR++){fP[fR]=new dB(fk(this,fO[fR].anchor),fk(this,fO[fR].head))}if(fS==null){fS=Math.min(fO.length-1,this.sel.primIndex)}bJ(this,cm(fP,fS),fQ)}),addSelection:cs(function(fQ,fR,fP){var fO=this.sel.ranges.slice(0);fO.push(new dB(fk(this,fQ),fk(this,fR||fQ)));bJ(this,cm(fO,fO.length-1),fP)}),getSelection:function(fS){var fP=this.sel.ranges,fO;for(var fQ=0;fQ<fP.length;fQ++){var fR=fz(this,fP[fQ].from(),fP[fQ].to());fO=fO?fO.concat(fR):fR}if(fS===false){return fO}else{return fO.join(fS||"\n")}},getSelections:function(fS){var fR=[],fO=this.sel.ranges;for(var fP=0;fP<fO.length;fP++){var fQ=fz(this,fO[fP].from(),fO[fP].to());if(fS!==false){fQ=fQ.join(fS||"\n")}fR[fP]=fQ}return fR},replaceSelection:function(fQ,fS,fO){var fR=[];for(var fP=0;fP<this.sel.ranges.length;fP++){fR[fP]=fQ}this.replaceSelections(fR,fS,fO||"+input")},replaceSelections:cs(function(fT,fV,fQ){var fS=[],fU=this.sel;for(var fR=0;fR<fU.ranges.length;fR++){var fP=fU.ranges[fR];fS[fR]={from:fP.from(),to:fP.to(),text:aQ(fT[fR]),origin:fQ}}var fO=fV&&fV!="end"&&ad(this,fS,fV);for(var fR=fS.length-1;fR>=0;fR--){a5(this,fS[fR])}if(fO){eH(this,fO)}else{if(this.cm){fh(this.cm)}}}),undo:cs(function(){bV(this,"undo")}),redo:cs(function(){bV(this,"redo")}),undoSelection:cs(function(){bV(this,"undo",true)}),redoSelection:cs(function(){bV(this,"redo",true)}),setExtending:function(fO){this.extend=fO},getExtending:function(){return this.extend},historySize:function(){var fR=this.history,fO=0,fQ=0;for(var fP=0;fP<fR.done.length;fP++){if(!fR.done[fP].ranges){++fO}}for(var fP=0;fP<fR.undone.length;fP++){if(!fR.undone[fP].ranges){++fQ}}return{undo:fO,redo:fQ}},clearHistory:function(){this.history=new ft(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(fO){if(fO){this.history.lastOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(fO){return this.history.generation==(fO||this.cleanGeneration)},getHistory:function(){return{done:bE(this.history.done),undone:bE(this.history.undone)}},setHistory:function(fP){var fO=this.history=new ft(this.history.maxGeneration);fO.done=bE(fP.done.slice(0),null,true);fO.undone=bE(fP.undone.slice(0),null,true)},markText:function(fQ,fP,fO){return ej(this,fk(this,fQ),fk(this,fP),fO,"range")},setBookmark:function(fQ,fO){var fP={replacedWith:fO&&(fO.nodeType==null?fO.widget:fO),insertLeft:fO&&fO.insertLeft,clearWhenEmpty:false,shared:fO&&fO.shared};fQ=fk(this,fQ);return ej(this,fQ,fQ,fP,"bookmark")},findMarksAt:function(fS){fS=fk(this,fS);var fR=[],fP=eP(this,fS.line).markedSpans;if(fP){for(var fO=0;fO<fP.length;++fO){var fQ=fP[fO];if((fQ.from==null||fQ.from<=fS.ch)&&(fQ.to==null||fQ.to>=fS.ch)){fR.push(fQ.marker.parent||fQ.marker)}}}return fR},findMarks:function(fS,fR,fO){fS=fk(this,fS);fR=fk(this,fR);var fP=[],fQ=fS.line;this.iter(fS.line,fR.line+1,function(fT){var fV=fT.markedSpans;if(fV){for(var fU=0;fU<fV.length;fU++){var fW=fV[fU];if(!(fQ==fS.line&&fS.ch>fW.to||fW.from==null&&fQ!=fS.line||fQ==fR.line&&fW.from>fR.ch)&&(!fO||fO(fW.marker))){fP.push(fW.marker.parent||fW.marker)}}}++fQ});return fP},getAllMarks:function(){var fO=[];this.iter(function(fQ){var fP=fQ.markedSpans;if(fP){for(var fR=0;fR<fP.length;++fR){if(fP[fR].from!=null){fO.push(fP[fR].marker)}}}});return fO},posFromIndex:function(fP){var fO,fQ=this.first;this.iter(function(fR){var fS=fR.text.length+1;if(fS>fP){fO=fP;return true}fP-=fS;++fQ});return fk(this,W(fQ,fO))},indexFromPos:function(fP){fP=fk(this,fP);var fO=fP.ch;if(fP.line<this.first||fP.ch<0){return 0}this.iter(this.first,fP.line,function(fQ){fO+=fQ.text.length+1});return fO},copy:function(fO){var fP=new ao(aS(this,this.first,this.first+this.size),this.modeOption,this.first);fP.scrollTop=this.scrollTop;fP.scrollLeft=this.scrollLeft;fP.sel=this.sel;fP.extend=false;if(fO){fP.history.undoDepth=this.history.undoDepth;fP.setHistory(this.getHistory())}return fP},linkedDoc:function(fO){if(!fO){fO={}}var fR=this.first,fQ=this.first+this.size;if(fO.from!=null&&fO.from>fR){fR=fO.from}if(fO.to!=null&&fO.to<fQ){fQ=fO.to}var fP=new ao(aS(this,fR,fQ),fO.mode||this.modeOption,fR);if(fO.sharedHist){fP.history=this.history}(this.linked||(this.linked=[])).push({doc:fP,sharedHist:fO.sharedHist});fP.linked=[{doc:this,isParent:true,sharedHist:fO.sharedHist}];dk(fP,es(this));return fP},unlinkDoc:function(fP){if(fP instanceof I){fP=fP.doc}if(this.linked){for(var fQ=0;fQ<this.linked.length;++fQ){var fR=this.linked[fQ];if(fR.doc!=fP){continue}this.linked.splice(fQ,1);fP.unlinkDoc(this);d0(es(this));break}}if(fP.history==this.history){var fO=[fP.id];dK(fP,function(fS){fO.push(fS.id)},true);fP.history=new ft(null);fP.history.done=bE(this.history.done,fO);fP.history.undone=bE(this.history.undone,fO)}},iterLinkedDocs:function(fO){dK(this,fO)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});ao.prototype.eachLine=ao.prototype.iter;var e="iter insert remove copy getEditor".split(" ");for(var bz in ao.prototype){if(ao.prototype.hasOwnProperty(bz)&&c1(e,bz)<0){I.prototype[bz]=(function(fO){return function(){return fO.apply(this.doc,arguments)}})(ao.prototype[bz])}}bo(ao);function dK(fR,fQ,fP){function fO(fX,fV,fT){if(fX.linked){for(var fU=0;fU<fX.linked.length;++fU){var fS=fX.linked[fU];if(fS.doc==fV){continue}var fW=fT&&fS.sharedHist;if(fP&&!fW){continue}fQ(fS.doc,fW);fO(fS.doc,fX,fW)}}}fO(fR,null,true)}function dN(fO,fP){if(fP.cm){throw new Error("This document is already in use.")}fO.doc=fP;fP.cm=fO;X(fO);bh(fO);if(!fO.options.lineWrapping){h(fO)}fO.options.mode=fP.modeOption;af(fO)}function eP(fR,fT){fT-=fR.first;if(fT<0||fT>=fR.size){throw new Error("There is no line "+(fT+fR.first)+" in the document.")}for(var fO=fR;!fO.lines;){for(var fP=0;;++fP){var fS=fO.children[fP],fQ=fS.chunkSize();if(fT<fQ){fO=fS;break}fT-=fQ}}return fO.lines[fT]}function fz(fQ,fS,fO){var fP=[],fR=fS.line;fQ.iter(fS.line,fO.line+1,function(fT){var fU=fT.text;if(fR==fO.line){fU=fU.slice(0,fO.ch)}if(fR==fS.line){fU=fU.slice(fS.ch)}fP.push(fU);++fR});return fP}function aS(fP,fR,fQ){var fO=[];fP.iter(fR,fQ,function(fS){fO.push(fS.text)});return fO}function fB(fP,fO){var fQ=fO-fP.height;if(fQ){for(var fR=fP;fR;fR=fR.parent){fR.height+=fQ}}}function bC(fO){if(fO.parent==null){return null}var fS=fO.parent,fR=c1(fS.lines,fO);for(var fP=fS.parent;fP;fS=fP,fP=fP.parent){for(var fQ=0;;++fQ){if(fP.children[fQ]==fS){break}fR+=fP.children[fQ].chunkSize()}}return fR+fS.first}function bv(fQ,fT){var fV=fQ.first;outer:do{for(var fR=0;fR<fQ.children.length;++fR){var fU=fQ.children[fR],fS=fU.height;if(fT<fS){fQ=fU;continue outer}fT-=fS;fV+=fU.chunkSize()}return fV}while(!fQ.lines);for(var fR=0;fR<fQ.lines.length;++fR){var fP=fQ.lines[fR],fO=fP.height;if(fT<fO){break}fT-=fO}return fV+fR}function bB(fQ){fQ=z(fQ);var fS=0,fP=fQ.parent;for(var fR=0;fR<fP.lines.length;++fR){var fO=fP.lines[fR];if(fO==fQ){break}else{fS+=fO.height}}for(var fT=fP.parent;fT;fP=fT,fT=fP.parent){for(var fR=0;fR<fT.children.length;++fR){var fU=fT.children[fR];if(fU==fP){break}else{fS+=fU.height}}}return fS}function a(fP){var fO=fP.order;if(fO==null){fO=fP.order=a6(fP.text)}return fO}function ft(fO){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=fO||1}function da(fO,fQ){var fP={from:b9(fQ.from),to:cG(fQ),text:fz(fO,fQ.from,fQ.to)};bN(fO,fP,fQ.from.line,fQ.to.line+1);dK(fO,function(fR){bN(fR,fP,fQ.from.line,fQ.to.line+1)},true);return fP}function fc(fP){while(fP.length){var fO=fi(fP);if(fO.ranges){fP.pop()}else{break}}}function eq(fP,fO){if(fO){fc(fP.done);return fi(fP.done)}else{if(fP.done.length&&!fi(fP.done).ranges){return fi(fP.done)}else{if(fP.done.length>1&&!fP.done[fP.done.length-2].ranges){fP.done.pop();return fi(fP.done)}}}}function fn(fU,fS,fO,fR){var fQ=fU.history;fQ.undone.length=0;var fP=+new Date,fV;if((fQ.lastOp==fR||fQ.lastOrigin==fS.origin&&fS.origin&&((fS.origin.charAt(0)=="+"&&fU.cm&&fQ.lastModTime>fP-fU.cm.options.historyEventDelay)||fS.origin.charAt(0)=="*"))&&(fV=eq(fQ,fQ.lastOp==fR))){var fW=fi(fV.changes);if(b5(fS.from,fS.to)==0&&b5(fS.from,fW.to)==0){fW.to=cG(fS)}else{fV.changes.push(da(fU,fS))}}else{var fT=fi(fQ.done);if(!fT||!fT.ranges){cA(fU.sel,fQ.done)}fV={changes:[da(fU,fS)],generation:fQ.generation};fQ.done.push(fV);while(fQ.done.length>fQ.undoDepth){fQ.done.shift();if(!fQ.done[0].ranges){fQ.done.shift()}}}fQ.done.push(fO);fQ.generation=++fQ.maxGeneration;fQ.lastModTime=fQ.lastSelTime=fP;fQ.lastOp=fR;fQ.lastOrigin=fQ.lastSelOrigin=fS.origin;if(!fW){az(fU,"historyAdded")}}function bp(fS,fO,fQ,fR){var fP=fO.charAt(0);return fP=="*"||fP=="+"&&fQ.ranges.length==fR.ranges.length&&fQ.somethingSelected()==fR.somethingSelected()&&new Date-fS.history.lastSelTime<=(fS.cm?fS.cm.options.historyEventDelay:500)}function fH(fT,fR,fO,fQ){var fS=fT.history,fP=fQ&&fQ.origin;if(fO==fS.lastOp||(fP&&fS.lastSelOrigin==fP&&(fS.lastModTime==fS.lastSelTime&&fS.lastOrigin==fP||bp(fT,fP,fi(fS.done),fR)))){fS.done[fS.done.length-1]=fR}else{cA(fR,fS.done)}fS.lastSelTime=+new Date;fS.lastSelOrigin=fP;fS.lastOp=fO;if(fQ&&fQ.clearRedo!==false){fc(fS.undone)}}function cA(fP,fO){var fQ=fi(fO);if(!(fQ&&fQ.ranges&&fQ.equals(fP))){fO.push(fP)}}function bN(fP,fT,fS,fR){var fO=fT["spans_"+fP.id],fQ=0;fP.iter(Math.max(fP.first,fS),Math.min(fP.first+fP.size,fR),function(fU){if(fU.markedSpans){(fO||(fO=fT["spans_"+fP.id]={}))[fQ]=fU.markedSpans}++fQ})}function bb(fQ){if(!fQ){return null}for(var fP=0,fO;fP<fQ.length;++fP){if(fQ[fP].marker.explicitlyCleared){if(!fO){fO=fQ.slice(0,fP)}}else{if(fO){fO.push(fQ[fP])}}}return !fO?fQ:fO.length?fO:null}function bS(fR,fS){var fQ=fS["spans_"+fR.id];if(!fQ){return null}for(var fP=0,fO=[];fP<fS.text.length;++fP){fO.push(bb(fQ[fP]))}return fO}function bE(fZ,fR,fY){for(var fU=0,fP=[];fU<fZ.length;++fU){var fQ=fZ[fU];if(fQ.ranges){fP.push(fY?fy.prototype.deepCopy.call(fQ):fQ);continue}var fW=fQ.changes,fX=[];fP.push({changes:fX});for(var fT=0;fT<fW.length;++fT){var fV=fW[fT],fS;fX.push({from:fV.from,to:fV.to,text:fV.text});if(fR){for(var fO in fV){if(fS=fO.match(/^spans_(\d+)$/)){if(c1(fR,Number(fS[1]))>-1){fi(fX)[fO]=fV[fO];delete fV[fO]}}}}}}return fP}function J(fR,fQ,fP,fO){if(fP<fR.line){fR.line+=fO}else{if(fQ<fR.line){fR.line=fQ;fR.ch=0}}}function eR(fR,fT,fU,fV){for(var fQ=0;fQ<fR.length;++fQ){var fO=fR[fQ],fS=true;if(fO.ranges){if(!fO.copied){fO=fR[fQ]=fO.deepCopy();fO.copied=true}for(var fP=0;fP<fO.ranges.length;fP++){J(fO.ranges[fP].anchor,fT,fU,fV);J(fO.ranges[fP].head,fT,fU,fV)}continue}for(var fP=0;fP<fO.changes.length;++fP){var fW=fO.changes[fP];if(fU<fW.from.line){fW.from=W(fW.from.line+fV,fW.from.ch);fW.to=W(fW.to.line+fV,fW.to.ch)}else{if(fT<=fW.to.line){fS=false;break}}}if(!fS){fR.splice(0,fQ+1);fQ=0}}}function dj(fP,fS){var fR=fS.from.line,fQ=fS.to.line,fO=fS.text.length-(fQ-fR)-1;eR(fP.done,fR,fQ,fO);eR(fP.undone,fR,fQ,fO)}var cu=I.e_preventDefault=function(fO){if(fO.preventDefault){fO.preventDefault()}else{fO.returnValue=false}};var c6=I.e_stopPropagation=function(fO){if(fO.stopPropagation){fO.stopPropagation()}else{fO.cancelBubble=true}};function bA(fO){return fO.defaultPrevented!=null?fO.defaultPrevented:fO.returnValue==false}var d3=I.e_stop=function(fO){cu(fO);c6(fO)};function L(fO){return fO.target||fO.srcElement}function fo(fP){var fO=fP.which;if(fO==null){if(fP.button&1){fO=1}else{if(fP.button&2){fO=3}else{if(fP.button&4){fO=2}}}}if(bU&&fP.ctrlKey&&fO==1){fO=3}return fO}var bM=I.on=function(fR,fP,fQ){if(fR.addEventListener){fR.addEventListener(fP,fQ,false)}else{if(fR.attachEvent){fR.attachEvent("on"+fP,fQ)}else{var fS=fR._handlers||(fR._handlers={});var fO=fS[fP]||(fS[fP]=[]);fO.push(fQ)}}};var dP=I.off=function(fS,fQ,fR){if(fS.removeEventListener){fS.removeEventListener(fQ,fR,false)}else{if(fS.detachEvent){fS.detachEvent("on"+fQ,fR)}else{var fO=fS._handlers&&fS._handlers[fQ];if(!fO){return}for(var fP=0;fP<fO.length;++fP){if(fO[fP]==fR){fO.splice(fP,1);break}}}}};var az=I.signal=function(fS,fR){var fO=fS._handlers&&fS._handlers[fR];if(!fO){return}var fP=Array.prototype.slice.call(arguments,2);for(var fQ=0;fQ<fO.length;++fQ){fO[fQ].apply(null,fP)}};var be,ch=0;function ac(fT,fS){var fO=fT._handlers&&fT._handlers[fS];if(!fO){return}var fQ=Array.prototype.slice.call(arguments,2);if(!be){++ch;be=[];setTimeout(ec,0)}function fP(fU){return function(){fU.apply(null,fQ)}}for(var fR=0;fR<fO.length;++fR){be.push(fP(fO[fR]))}}function ec(){--ch;var fO=be;be=null;for(var fP=0;fP<fO.length;++fP){fO[fP]()}}function aI(fO,fQ,fP){az(fO,fP||fQ.type,fO,fQ);return bA(fQ)||fQ.codemirrorIgnore}function V(fP){var fO=fP._handlers&&fP._handlers.cursorActivity;if(!fO){return}var fR=fP.curOp.cursorActivityHandlers||(fP.curOp.cursorActivityHandlers=[]);for(var fQ=0;fQ<fO.length;++fQ){if(c1(fR,fO[fQ])==-1){fR.push(fO[fQ])}}}function eS(fQ,fP){var fO=fQ._handlers&&fQ._handlers[fP];return fO&&fO.length>0}function bo(fO){fO.prototype.on=function(fP,fQ){bM(this,fP,fQ)};fO.prototype.off=function(fP,fQ){dP(this,fP,fQ)}}var ba=30;var bZ=I.Pass={toString:function(){return"CodeMirror.Pass"}};var Y={scroll:false},M={origin:"*mouse"},cF={origin:"+move"};function fN(){this.id=null}fN.prototype.set=function(fO,fP){clearTimeout(this.id);this.id=setTimeout(fP,fO)};var bI=I.countColumn=function(fR,fP,fT,fU,fQ){if(fP==null){fP=fR.search(/[^\s\u00a0]/);if(fP==-1){fP=fR.length}}for(var fS=fU||0,fV=fQ||0;;){var fO=fR.indexOf("\t",fS);if(fO<0||fO>=fP){return fV+(fP-fS)}fV+=fO-fS;fV+=fT-(fV%fT);fS=fO+1}};function d2(fS,fR,fT){for(var fU=0,fQ=0;;){var fP=fS.indexOf("\t",fU);if(fP==-1){fP=fS.length}var fO=fP-fU;if(fP==fS.length||fQ+fO>=fR){return fU+Math.min(fO,fR-fQ)}fQ+=fP-fU;fQ+=fT-(fQ%fT);fU=fP+1;if(fQ>=fR){return fU}}}var aP=[""];function cf(fO){while(aP.length<=fO){aP.push(fi(aP)+" ")}return aP[fO]}function fi(fO){return fO[fO.length-1]}var dq=function(fO){fO.select()};if(eD){dq=function(fO){fO.selectionStart=0;fO.selectionEnd=fO.value.length}}else{if(dn){dq=function(fP){try{fP.select()}catch(fO){}}}}function c1(fQ,fO){for(var fP=0;fP<fQ.length;++fP){if(fQ[fP]==fO){return fP}}return -1}if([].indexOf){c1=function(fP,fO){return fP.indexOf(fO)}}function bH(fR,fQ){var fO=[];for(var fP=0;fP<fR.length;fP++){fO[fP]=fQ(fR[fP],fP)}return fO}if([].map){bH=function(fP,fO){return fP.map(fO)}}function ca(fR,fO){var fQ;if(Object.create){fQ=Object.create(fR)}else{var fP=function(){};fP.prototype=fR;fQ=new fP()}if(fO){aE(fO,fQ)}return fQ}function aE(fQ,fP,fO){if(!fP){fP={}}for(var fR in fQ){if(fQ.hasOwnProperty(fR)&&(fO!==false||!fP.hasOwnProperty(fR))){fP[fR]=fQ[fR]}}return fP}function cl(fP){var fO=Array.prototype.slice.call(arguments,1);return function(){return fP.apply(null,fO)}}var a2=/[\u00df\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var fe=I.isWordChar=function(fO){return/\w/.test(fO)||fO>"\x80"&&(fO.toUpperCase()!=fO.toLowerCase()||a2.test(fO))};function cp(fO,fP){if(!fP){return fe(fO)}if(fP.source.indexOf("\\w")>-1&&fe(fO)){return true}return fP.test(fO)}function ex(fO){for(var fP in fO){if(fO.hasOwnProperty(fP)&&fO[fP]){return false}}return true}var en=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function e0(fO){return fO.charCodeAt(0)>=768&&en.test(fO)}function fx(fO,fS,fR,fQ){var fT=document.createElement(fO);if(fR){fT.className=fR}if(fQ){fT.style.cssText=fQ}if(typeof fS=="string"){fT.appendChild(document.createTextNode(fS))}else{if(fS){for(var fP=0;fP<fS.length;++fP){fT.appendChild(fS[fP])}}}return fT}var cb;if(document.createRange){cb=function(fQ,fR,fO){var fP=document.createRange();fP.setEnd(fQ,fO);fP.setStart(fQ,fR);return fP}}else{cb=function(fQ,fR,fO){var fP=document.body.createTextRange();fP.moveToElementText(fQ.parentNode);fP.collapse(true);fP.moveEnd("character",fO);fP.moveStart("character",fR);return fP}}function dE(fP){for(var fO=fP.childNodes.length;fO>0;--fO){fP.removeChild(fP.firstChild)}return fP}function bG(fO,fP){return dE(fO).appendChild(fP)}function fG(fO,fP){if(fO.contains){return fO.contains(fP)}while(fP=fP.parentNode){if(fP==fO){return true}}}function ds(){return document.activeElement}if(eo){ds=function(){try{return document.activeElement}catch(fO){return document.body}}}function S(fO){return new RegExp("\\b"+fO+"\\b\\s*")}function g(fP,fO){var fQ=S(fO);if(fQ.test(fP.className)){fP.className=fP.className.replace(fQ,"")}}function fb(fP,fO){if(!S(fO).test(fP.className)){fP.className+=" "+fO}}function fs(fQ,fO){var fP=fQ.split(" ");for(var fR=0;fR<fP.length;fR++){if(fP[fR]&&!S(fP[fR]).test(fO)){fO+=" "+fP[fR]}}return fO}function aw(fR){if(!document.body.getElementsByClassName){return}var fQ=document.body.getElementsByClassName("CodeMirror");for(var fP=0;fP<fQ.length;fP++){var fO=fQ[fP].CodeMirror;if(fO){fR(fO)}}}var cr=false;function a8(){if(cr){return}ff();cr=true}function ff(){var fO;bM(window,"resize",function(){if(fO==null){fO=setTimeout(function(){fO=null;d8=null;aw(aK)},100)}});bM(window,"blur",function(){aw(aL)})}var ep=function(){if(bY){return false}var fO=fx("div");return"draggable" in fO||"dragDrop" in fO}();var d8;function l(fO){if(d8!=null){return d8}var fP=fx("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");bG(fO,fP);if(fP.offsetWidth){d8=fP.offsetHeight-fP.clientHeight}return d8||0}var fm;function bd(fO){if(fm==null){var fP=fx("span","\u200b");bG(fO,fx("span",[fP,document.createTextNode("x")]));if(fO.firstChild.offsetHeight!=0){fm=fP.offsetWidth<=1&&fP.offsetHeight>2&&!b1}}if(fm){return fx("span","\u200b")}else{return fx("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px")}}var fl;function bD(fR){if(fl!=null){return fl}var fO=bG(fR,document.createTextNode("A\u062eA"));var fQ=cb(fO,0,1).getBoundingClientRect();if(fQ.left==fQ.right){return false}var fP=cb(fO,1,2).getBoundingClientRect();return fl=(fP.right-fQ.right<3)}var aQ=I.splitLines="\n\nb".split(/\n/).length!=3?function(fT){var fU=0,fO=[],fS=fT.length;while(fU<=fS){var fR=fT.indexOf("\n",fU);if(fR==-1){fR=fT.length}var fQ=fT.slice(fU,fT.charAt(fR-1)=="\r"?fR-1:fR);var fP=fQ.indexOf("\r");if(fP!=-1){fO.push(fQ.slice(0,fP));fU+=fP+1}else{fO.push(fQ);fU=fR+1}}return fO}:function(fO){return fO.split(/\r\n?|\n/)};var bi=window.getSelection?function(fP){try{return fP.selectionStart!=fP.selectionEnd}catch(fO){return false}}:function(fQ){try{var fO=fQ.ownerDocument.selection.createRange()}catch(fP){}if(!fO||fO.parentElement()!=fQ){return false}return fO.compareEndPoints("StartToEnd",fO)!=0};var cT=(function(){var fO=fx("div");if("oncopy" in fO){return true}fO.setAttribute("oncopy","return;");return typeof fO.oncopy=="function"})();var eQ={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};I.keyNames=eQ;(function(){for(var fO=0;fO<10;fO++){eQ[fO+48]=eQ[fO+96]=String(fO)}for(var fO=65;fO<=90;fO++){eQ[fO]=String.fromCharCode(fO)}for(var fO=1;fO<=12;fO++){eQ[fO+111]=eQ[fO+63235]="F"+fO}})();function dH(fO,fU,fT,fS){if(!fO){return fS(fU,fT,"ltr")}var fR=false;for(var fQ=0;fQ<fO.length;++fQ){var fP=fO[fQ];if(fP.from<fT&&fP.to>fU||fU==fT&&fP.to==fU){fS(Math.max(fP.from,fU),Math.min(fP.to,fT),fP.level==1?"rtl":"ltr");fR=true}}if(!fR){fS(fU,fT,"ltr")}}function dd(fO){return fO.level%2?fO.to:fO.from}function fJ(fO){return fO.level%2?fO.from:fO.to}function ct(fP){var fO=a(fP);return fO?dd(fO[0]):0}function cE(fP){var fO=a(fP);if(!fO){return fP.text.length}return fJ(fi(fO))}function bj(fP,fS){var fQ=eP(fP.doc,fS);var fT=z(fQ);if(fT!=fQ){fS=bC(fT)}var fO=a(fT);var fR=!fO?0:fO[0].level%2?cE(fT):ct(fT);return W(fS,fR)}function dt(fQ,fT){var fP,fR=eP(fQ.doc,fT);while(fP=d7(fR)){fR=fP.find(1,true).line;fT=null}var fO=a(fR);var fS=!fO?fR.text.length:fO[0].level%2?ct(fR):cE(fR);return W(fT==null?bC(fR):fT,fS)}function ak(fP,fQ,fO){var fR=fP[0].level;if(fQ==fR){return true}if(fO==fR){return false}return fQ<fO}var eE;function aB(fO,fS){eE=null;for(var fP=0,fQ;fP<fO.length;++fP){var fR=fO[fP];if(fR.from<fS&&fR.to>fS){return fP}if((fR.from==fS||fR.to==fS)){if(fQ==null){fQ=fP}else{if(ak(fO,fR.level,fO[fQ].level)){if(fR.from!=fR.to){eE=fQ}return fP}else{if(fR.from!=fR.to){eE=fP}return fQ}}}}return fQ}function eO(fO,fR,fP,fQ){if(!fQ){return fR+fP}do{fR+=fP}while(fR>0&&e0(fO.text.charAt(fR)));return fR}function v(fO,fV,fQ,fR){var fS=a(fO);if(!fS){return ag(fO,fV,fQ,fR)}var fU=aB(fS,fV),fP=fS[fU];var fT=eO(fO,fV,fP.level%2?-fQ:fQ,fR);for(;;){if(fT>fP.from&&fT<fP.to){return fT}if(fT==fP.from||fT==fP.to){if(aB(fS,fT)==fU){return fT}fP=fS[fU+=fQ];return(fQ>0)==fP.level%2?fP.to:fP.from}else{fP=fS[fU+=fQ];if(!fP){return null}if((fQ>0)==fP.level%2){fT=eO(fO,fP.to,-1,fR)}else{fT=eO(fO,fP.from,1,fR)}}}}function ag(fO,fS,fP,fQ){var fR=fS+fP;if(fQ){while(fR>0&&e0(fO.text.charAt(fR))){fR+=fP}}return fR<0||fR>fO.text.length?null:fR}var a6=(function(){var fU="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var fS="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function fR(fY){if(fY<=247){return fU.charAt(fY)}else{if(1424<=fY&&fY<=1524){return"R"}else{if(1536<=fY&&fY<=1773){return fS.charAt(fY-1536)}else{if(1774<=fY&&fY<=2220){return"r"}else{if(8192<=fY&&fY<=8203){return"w"}else{if(fY==8204){return"b"}else{return"L"}}}}}}}var fO=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var fX=/[stwN]/,fQ=/[LRr]/,fP=/[Lb1n]/,fT=/[1n]/;var fW="L";function fV(f0,fZ,fY){this.level=f0;this.from=fZ;this.to=fY}return function(f8){if(!fO.test(f8)){return false}var ge=f8.length,f4=[];for(var gd=0,f0;gd<ge;++gd){f4.push(f0=fR(f8.charCodeAt(gd)))}for(var gd=0,f7=fW;gd<ge;++gd){var f0=f4[gd];if(f0=="m"){f4[gd]=f7}else{f7=f0}}for(var gd=0,fY=fW;gd<ge;++gd){var f0=f4[gd];if(f0=="1"&&fY=="r"){f4[gd]="n"}else{if(fQ.test(f0)){fY=f0;if(f0=="r"){f4[gd]="R"}}}}for(var gd=1,f7=f4[0];gd<ge-1;++gd){var f0=f4[gd];if(f0=="+"&&f7=="1"&&f4[gd+1]=="1"){f4[gd]="1"}else{if(f0==","&&f7==f4[gd+1]&&(f7=="1"||f7=="n")){f4[gd]=f7}}f7=f0}for(var gd=0;gd<ge;++gd){var f0=f4[gd];if(f0==","){f4[gd]="N"}else{if(f0=="%"){for(var f1=gd+1;f1<ge&&f4[f1]=="%";++f1){}var gf=(gd&&f4[gd-1]=="!")||(f1<ge&&f4[f1]=="1")?"1":"N";for(var gb=gd;gb<f1;++gb){f4[gb]=gf}gd=f1-1}}}for(var gd=0,fY=fW;gd<ge;++gd){var f0=f4[gd];if(fY=="L"&&f0=="1"){f4[gd]="L"}else{if(fQ.test(f0)){fY=f0}}}for(var gd=0;gd<ge;++gd){if(fX.test(f4[gd])){for(var f1=gd+1;f1<ge&&fX.test(f4[f1]);++f1){}var f5=(gd?f4[gd-1]:fW)=="L";var fZ=(f1<ge?f4[f1]:fW)=="L";var gf=f5||fZ?"L":"R";for(var gb=gd;gb<f1;++gb){f4[gb]=gf}gd=f1-1}}var gc=[],f9;for(var gd=0;gd<ge;){if(fP.test(f4[gd])){var f2=gd;for(++gd;gd<ge&&fP.test(f4[gd]);++gd){}gc.push(new fV(0,f2,gd))}else{var f3=gd,f6=gc.length;for(++gd;gd<ge&&f4[gd]!="L";++gd){}for(var gb=f3;gb<gd;){if(fT.test(f4[gb])){if(f3<gb){gc.splice(f6,0,new fV(1,f3,gb))}var ga=gb;for(++gb;gb<gd&&fT.test(f4[gb]);++gb){}gc.splice(f6,0,new fV(2,ga,gb));f3=gb}else{++gb}}if(f3<gd){gc.splice(f6,0,new fV(1,f3,gd))}}}if(gc[0].level==1&&(f9=f8.match(/^\s+/))){gc[0].from=f9[0].length;gc.unshift(new fV(0,0,f9[0].length))}if(fi(gc).level==1&&(f9=f8.match(/\s+$/))){fi(gc).to-=f9[0].length;gc.push(new fV(0,ge-f9[0].length,ge))}if(gc[0].level!=fi(gc).level){gc.push(new fV(gc[0].level,ge,ge))}return gc}})();I.version="4.2.0";return I});